(()=>{var e={725:()=>{},439:()=>{},699:()=>{}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}(()=>{"use strict";var e,t,i,s,n;(s=e||(e={})).loading="loading",s.loaded="loaded",s.initialised="initialised",s.computing="computing";class o{starLines(e,t,r,i,s){let n=[];const o=2*Math.PI/r;for(let i=0;i<r;i++){const r=i*o,a=s||0,c=[t*Math.cos(r),a,t*Math.sin(r)],h=[e*Math.cos(r+o/2),0,e*Math.sin(r+o/2)],d=[t*Math.cos(r+o),a,t*Math.sin(r+o)];n.push({start:c,end:h}),n.push({start:h,end:d})}return i&&(n=n.slice(0,n.length/2)),n}parallelogram(e,t,r,i){const s=r*Math.PI/180;let n,o,a,c,h,d,l,u;i?(n=-e/2,o=-t/2,a=e/2,c=-t/2,h=e/2,d=t/2,l=-e/2,u=t/2):(n=0,o=0,a=e,c=0,h=e,d=t,l=0,u=t);const p=t*Math.tan(s)/2;n+=p,a+=p,h-=p,l-=p;const f=[n,0,o],v=[a,0,c],g=[h,0,d],m=[l,0,u];return[{start:f,end:v},{start:v,end:g},{start:g,end:m},{start:m,end:f}]}ngon(e,t,r){const i=2*Math.PI/e,s=[];for(let n=0;n<e;n++){const e=[r[0]+t*Math.cos(n*i),0,r[1]+t*Math.sin(n*i)],o=[r[0]+t*Math.cos((n+1)*i),0,r[1]+t*Math.sin((n+1)*i)];s.push({start:e,end:o})}return s}polygonL(e,t,r,i){return[[0,0,0],[t,0,0],[t,0,-e],[-r,0,-e],[-r,0,i],[0,0,i]]}polygonLInverted(e,t,r,i){return e>=i&&(e=i-1e-6,console.warn("width first is bigger than length second, to make it work, width second is set to length first - 1e-6")),r>=t&&(r=t-1e-6,console.warn("width second is bigger than length first, to make it work, width second is set to length first - 1e-6")),[[0,0,0],[t,0,0],[t,0,e],[r,0,e],[r,0,i],[0,0,i]]}polygonLMiddle(e,t,r,i){return e>=i&&(e=i-1e-6,console.warn("width first is bigger than length second, to make it work, width second is set to length first - 1e-6")),r>=t&&(r=t-1e-6,console.warn("width second is bigger than length first, to make it work, width second is set to length first - 1e-6")),[[r/2,0,e/2],[r/2,0,i],[-r/2,0,i],[-r/2,0,-e/2],[t,0,-e/2],[t,0,e/2]]}}class a{constructor(){this.tolerance=1e-5}degToRad(e){return e*(Math.PI/180)}remap(e,t,r,i,s){return(e-t)/(r-t)*(s-i)+i}removeAllDuplicateVectors(e,t=1e-7){const r=[];return e.forEach((e=>{r.some((r=>this.vectorsTheSame(e,r,t)))||r.push(e)})),r}removeConsecutiveDuplicates(e,t=!0){const r=[];if(e.length>1){for(let t=1;t<e.length;t++){const i=e[t],s=e[t-1];this.vectorsTheSame(i,s,this.tolerance)||r.push(s),t===e.length-1&&r.push(i)}if(t){const e=r[0],t=r[r.length-1];this.vectorsTheSame(e,t,this.tolerance)&&r.pop()}}else 1===e.length&&r.push(...e);return r}vectorsTheSame(e,t,r){let i=!1;if(e.length!==t.length)return i;i=!0;for(let s=0;s<e.length;s++)if(!this.approxEq(e[s],t[s],r)){i=!1;break}return i}approxEq(e,t,r){return Math.abs(e-t)<r}averageVector(e){return e.reduce(((e,t)=>e.map(((e,r)=>e+t[r]))),[0,0,0]).map((t=>t/e.length))}magnitude(e){return Math.sqrt(e.reduce(((e,t)=>e+t*t),0))}normalize(e){const t=this.magnitude(e);return e.map((e=>e/t))}translatePoint(e,t,r){return[e[0]+t[0]*r,e[1]+t[1]*r,e[2]+t[2]*r]}distanceBetweenPoints(e,t){const r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}}!function(e){let t,r,i,s,n,o,a,c,h,d,l,u,p,f,v,g;!function(e){e.arc="arc",e.intersection="intersection",e.tangent="tangent"}(t=e.joinTypeEnum||(e.joinTypeEnum={})),function(e){e.skin="skin",e.pipe="pipe",e.rectoVerso="rectoVerso"}(r=e.bRepOffsetModeEnum||(e.bRepOffsetModeEnum={})),function(e){e.approxChordLength="approxChordLength",e.approxCentripetal="approxCentripetal",e.approxIsoParametric="approxIsoParametric"}(i=e.approxParametrizationTypeEnum||(e.approxParametrizationTypeEnum={})),function(e){e.outside="outside",e.inside="inside",e.middle="middle"}(s=e.directionEnum||(e.directionEnum={})),function(e){e.iges="iges",e.step="step"}(n=e.fileTypeEnum||(e.fileTypeEnum={})),function(e){e.forward="forward",e.reversed="reversed",e.internal="internal",e.external="external"}(o=e.topAbsOrientationEnum||(e.topAbsOrientationEnum={})),function(e){e.in="in",e.out="out",e.on="on",e.unknown="unknown"}(a=e.topAbsStateEnum||(e.topAbsStateEnum={})),function(e){e.unknown="unknown",e.vertex="vertex",e.edge="edge",e.wire="wire",e.face="face",e.shell="shell",e.solid="solid",e.compSolid="compSolid",e.compound="compound",e.shape="shape"}(c=e.shapeTypeEnum||(e.shapeTypeEnum={})),function(e){e.unqualified="unqualified",e.enclosing="enclosing",e.enclosed="enclosed",e.outside="outside",e.noqualifier="noqualifier"}(h=e.gccEntPositionEnum||(e.gccEntPositionEnum={})),function(e){e.keepSide1="keepSide1",e.keepSide2="keepSide2",e.all="all"}(d=e.positionResultEnum||(e.positionResultEnum={})),function(e){e.none="none",e.keepSide1="keepSide1",e.keepSide2="keepSide2"}(l=e.circleInclusionEnum||(e.circleInclusionEnum={})),function(e){e.none="none",e.outside="outside",e.inside="inside",e.outsideInside="outsideInside",e.insideOutside="insideOutside"}(u=e.twoCircleInclusionEnum||(e.twoCircleInclusionEnum={})),function(e){e.outside="outside",e.inside="inside",e.outsideInside="outsideInside",e.insideOutside="insideOutside"}(p=e.fourSidesStrictEnum||(e.fourSidesStrictEnum={})),function(e){e.outside="outside",e.inside="inside"}(f=e.twoSidesStrictEnum||(e.twoSidesStrictEnum={})),function(e){e.allWithAll="allWithAll",e.inOrder="inOrder",e.inOrderClosed="inOrderClosed"}(v=e.combinationCirclesForFaceEnum||(e.combinationCirclesForFaceEnum={})),function(e){e[e.curve=0]="curve",e[e.edge=1]="edge",e[e.wire=2]="wire",e[e.face=3]="face"}(g=e.typeSpecificityEnum||(e.typeSpecificityEnum={})),e.DecomposedMeshDto=class{constructor(e,t){void 0!==e&&(this.faceList=e),void 0!==t&&(this.edgeList=t)}},e.DecomposedFaceDto=class{},e.DecomposedEdgeDto=class{},e.ShapesDto=class{constructor(e){void 0!==e&&(this.shapes=e)}},e.PointDto=class{constructor(e){this.point=[0,0,0],void 0!==e&&(this.point=e)}},e.PointsDto=class{constructor(e){void 0!==e&&(this.points=e)}},e.ConstraintTanLinesFromPtToCircleDto=class{constructor(e,t,r,i,s){this.tolerance=1e-7,this.positionResult=d.all,this.circleRemainder=l.none,void 0!==e&&(this.circle=e),void 0!==t&&(this.point=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.positionResult=i),void 0!==s&&(this.circleRemainder=s)}},e.ConstraintTanLinesFromTwoPtsToCircleDto=class{constructor(e,t,r,i,s,n){this.tolerance=1e-7,this.positionResult=d.all,this.circleRemainder=l.none,void 0!==e&&(this.circle=e),void 0!==t&&(this.point1=t),void 0!==r&&(this.point1=r),void 0!==i&&(this.tolerance=i),void 0!==s&&(this.positionResult=s),void 0!==n&&(this.circleRemainder=n)}},e.ConstraintTanLinesOnTwoCirclesDto=class{constructor(e,t,r,i,s){this.tolerance=1e-7,this.positionResult=d.all,this.circleRemainders=u.none,void 0!==e&&(this.circle1=e),void 0!==t&&(this.circle2=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.positionResult=i),void 0!==s&&(this.circleRemainders=s)}},e.ConstraintTanCirclesOnTwoCirclesDto=class{constructor(e,t,r,i){this.tolerance=1e-7,this.radius=.3,void 0!==e&&(this.circle1=e),void 0!==t&&(this.circle2=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.radius=i)}},e.ConstraintTanCirclesOnCircleAndPntDto=class{constructor(e,t,r,i){this.tolerance=1e-7,this.radius=.3,void 0!==e&&(this.circle=e),void 0!==t&&(this.point=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.radius=i)}},e.CurveAndSurfaceDto=class{constructor(e,t){void 0!==e&&(this.curve=e),void 0!==t&&(this.surface=t)}},e.FilletTwoEdgesInPlaneDto=class{constructor(e,t,r,i,s,n){this.planeOrigin=[0,0,0],this.planeDirection=[0,1,0],this.radius=.3,this.solution=-1,void 0!==e&&(this.edge1=e),void 0!==t&&(this.edge2=t),void 0!==r&&(this.planeOrigin=r),void 0!==i&&(this.planeDirection=i),void 0!==s&&(this.radius=s),void 0!==n&&(this.solution=n)}},e.ClosestPointsOnShapeFromPointsDto=class{constructor(e,t){void 0!==e&&(this.shape=e),void 0!==t&&(this.points=t)}},e.SplitWireOnPointsDto=class{constructor(e,t){void 0!==e&&(this.shape=e),void 0!==t&&(this.points=t)}},e.ClosestPointsOnShapesFromPointsDto=class{constructor(e,t){void 0!==e&&(this.shapes=e),void 0!==t&&(this.points=t)}},e.ClosestPointsBetweenTwoShapesDto=class{constructor(e,t){void 0!==e&&(this.shape1=e),void 0!==t&&(this.shape2=t)}},e.FaceFromSurfaceAndWireDto=class{constructor(e,t,r){this.inside=!0,void 0!==e&&(this.surface=e),void 0!==t&&(this.wire=t),void 0!==r&&(this.inside=r)}},e.WireOnFaceDto=class{constructor(e,t){void 0!==e&&(this.wire=e),void 0!==t&&(this.face=t)}},e.DrawShapeDto=class{constructor(e,t,r,i,s,n,o,a,c,h,d,l,u,p,f,v,g,m,S){this.faceOpacity=1,this.edgeOpacity=1,this.edgeColour="#ffffff",this.faceColour="#ff0000",this.edgeWidth=2,this.drawEdges=!0,this.drawFaces=!0,this.drawVertices=!1,this.vertexColour="#ffaaff",this.vertexSize=.03,this.precision=.01,this.drawEdgeIndexes=!1,this.edgeIndexHeight=.06,this.edgeIndexColour="#ff00ff",this.drawFaceIndexes=!1,this.faceIndexHeight=.06,this.faceIndexColour="#0000ff",void 0!==e&&(this.shape=e),void 0!==t&&(this.faceOpacity=t),void 0!==r&&(this.edgeOpacity=r),void 0!==i&&(this.edgeColour=i),void 0!==s&&(this.faceMaterial=s),void 0!==n&&(this.faceColour=n),void 0!==d&&(this.vertexColour=d),void 0!==l&&(this.vertexSize=l),void 0!==o&&(this.edgeWidth=o),void 0!==a&&(this.drawEdges=a),void 0!==c&&(this.drawFaces=c),void 0!==h&&(this.drawVertices=h),void 0!==u&&(this.precision=u),void 0!==p&&(this.drawEdgeIndexes=p),void 0!==f&&(this.edgeIndexHeight=f),void 0!==v&&(this.edgeIndexColour=v),void 0!==g&&(this.drawFaceIndexes=g),void 0!==m&&(this.faceIndexHeight=m),void 0!==S&&(this.faceIndexColour=S)}},e.DrawShapesDto=class{constructor(e,t,r,i,s,n,o,a,c,h,d,l,u,p,f,v,g,m,S){this.faceOpacity=1,this.edgeOpacity=1,this.edgeColour="#ffffff",this.faceColour="#ff0000",this.edgeWidth=2,this.drawEdges=!0,this.drawFaces=!0,this.drawVertices=!1,this.vertexColour="#ffaaff",this.vertexSize=.03,this.precision=.01,this.drawEdgeIndexes=!1,this.edgeIndexHeight=.06,this.edgeIndexColour="#ff00ff",this.drawFaceIndexes=!1,this.faceIndexHeight=.06,this.faceIndexColour="#0000ff",void 0!==e&&(this.shapes=e),void 0!==t&&(this.faceOpacity=t),void 0!==r&&(this.edgeOpacity=r),void 0!==i&&(this.edgeColour=i),void 0!==s&&(this.faceMaterial=s),void 0!==n&&(this.faceColour=n),void 0!==d&&(this.vertexColour=d),void 0!==l&&(this.vertexSize=l),void 0!==o&&(this.edgeWidth=o),void 0!==a&&(this.drawEdges=a),void 0!==c&&(this.drawFaces=c),void 0!==h&&(this.drawVertices=h),void 0!==u&&(this.precision=u),void 0!==p&&(this.drawEdgeIndexes=p),void 0!==f&&(this.edgeIndexHeight=f),void 0!==v&&(this.edgeIndexColour=v),void 0!==g&&(this.drawFaceIndexes=g),void 0!==m&&(this.faceIndexHeight=m),void 0!==S&&(this.faceIndexColour=S)}},e.FaceSubdivisionDto=class{constructor(e,t,r,i,s,n,o,a,c){this.nrDivisionsU=10,this.nrDivisionsV=10,this.shiftHalfStepU=!1,this.removeStartEdgeU=!1,this.removeEndEdgeU=!1,this.shiftHalfStepV=!1,this.removeStartEdgeV=!1,this.removeEndEdgeV=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.nrDivisionsU=t),void 0!==r&&(this.nrDivisionsV=r),void 0!==i&&(this.shiftHalfStepU=i),void 0!==s&&(this.removeStartEdgeU=s),void 0!==n&&(this.removeEndEdgeU=n),void 0!==o&&(this.shiftHalfStepV=o),void 0!==a&&(this.removeStartEdgeV=a),void 0!==c&&(this.removeEndEdgeV=c)}},e.FaceSubdivisionControlledDto=class{constructor(e,t,r,i,s,n,o,a,c,h,d,l,u,p,f){this.nrDivisionsU=10,this.nrDivisionsV=10,this.shiftHalfStepNthU=0,this.shiftHalfStepUOffsetN=0,this.removeStartEdgeNthU=0,this.removeStartEdgeUOffsetN=0,this.removeEndEdgeNthU=0,this.removeEndEdgeUOffsetN=0,this.shiftHalfStepNthV=0,this.shiftHalfStepVOffsetN=0,this.removeStartEdgeNthV=0,this.removeStartEdgeVOffsetN=0,this.removeEndEdgeNthV=0,this.removeEndEdgeVOffsetN=0,void 0!==e&&(this.shape=e),void 0!==t&&(this.nrDivisionsU=t),void 0!==r&&(this.nrDivisionsV=r),void 0!==i&&(this.shiftHalfStepNthU=i),void 0!==s&&(this.shiftHalfStepUOffsetN=s),void 0!==n&&(this.removeStartEdgeNthU=n),void 0!==o&&(this.removeStartEdgeUOffsetN=o),void 0!==a&&(this.removeEndEdgeNthU=a),void 0!==c&&(this.removeEndEdgeUOffsetN=c),void 0!==h&&(this.shiftHalfStepNthV=h),void 0!==d&&(this.shiftHalfStepVOffsetN=d),void 0!==l&&(this.removeStartEdgeNthV=l),void 0!==u&&(this.removeStartEdgeVOffsetN=u),void 0!==p&&(this.removeEndEdgeNthV=p),void 0!==f&&(this.removeEndEdgeVOffsetN=f)}},e.FaceLinearSubdivisionDto=class{constructor(e,t,r,i,s,n,o){this.isU=!0,this.param=.5,this.nrPoints=10,this.shiftHalfStep=!1,this.removeStartPoint=!1,this.removeEndPoint=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.isU=t),void 0!==r&&(this.param=r),void 0!==i&&(this.nrPoints=i),void 0!==s&&(this.shiftHalfStep=s),void 0!==n&&(this.removeStartPoint=n),void 0!==o&&(this.removeEndPoint=o)}},e.DataOnUVDto=class{constructor(e,t,r){this.paramU=.5,this.paramV=.5,void 0!==e&&(this.shape=e),void 0!==t&&(this.paramU=t),void 0!==r&&(this.paramV=r)}},e.DataOnUVsDto=class{constructor(e,t){this.paramsUV=[[.5,.5]],void 0!==e&&(this.shape=e),void 0!==t&&(this.paramsUV=t)}},e.PolygonDto=class{constructor(e){void 0!==e&&(this.points=e)}},e.PolygonsDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.polygons=e),void 0!==t&&(this.returnCompound=t)}},e.PolylineDto=class{constructor(e){void 0!==e&&(this.points=e)}},e.PolylinesDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.polylines=e),void 0!==t&&(this.returnCompound=t)}},e.SquareDto=class{constructor(e,t,r){this.size=1,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.size=e),void 0!==t&&(this.center=t),void 0!==r&&(this.direction=r)}},e.RectangleDto=class{constructor(e,t,r,i){this.width=1,this.length=2,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.width=e),void 0!==t&&(this.length=t),void 0!==r&&(this.center=r),void 0!==i&&(this.direction=i)}},e.LPolygonDto=class{constructor(e,t,r,i,n,o,a,c){this.widthFirst=1,this.lengthFirst=2,this.widthSecond=.5,this.lengthSecond=2,this.align=s.outside,this.rotation=0,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.widthFirst=e),void 0!==t&&(this.lengthFirst=t),void 0!==r&&(this.widthSecond=r),void 0!==i&&(this.lengthSecond=i),void 0!==n&&(this.align=n),void 0!==o&&(this.rotation=o),void 0!==a&&(this.center=a),void 0!==c&&(this.direction=c)}},e.BoxDto=class{constructor(e,t,r,i){this.width=1,this.length=2,this.height=3,this.center=[0,0,0],void 0!==e&&(this.width=e),void 0!==t&&(this.length=t),void 0!==r&&(this.height=r),void 0!==i&&(this.center=i)}},e.CubeDto=class{constructor(e,t){this.size=1,this.center=[0,0,0],void 0!==e&&(this.size=e),void 0!==t&&(this.center=t)}},e.BoxFromCornerDto=class{constructor(e,t,r,i){this.width=1,this.length=2,this.height=3,this.corner=[0,0,0],void 0!==e&&(this.width=e),void 0!==t&&(this.length=t),void 0!==r&&(this.height=r),void 0!==i&&(this.corner=i)}},e.SphereDto=class{constructor(e,t){this.radius=1,this.center=[0,0,0],void 0!==e&&(this.radius=e),void 0!==t&&(this.center=t)}},e.ConeDto=class{constructor(e,t,r,i,s,n){this.radius1=2,this.radius2=1,this.height=2,this.angle=360,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.radius1=e),void 0!==t&&(this.radius2=t),void 0!==r&&(this.height=r),void 0!==i&&(this.angle=i),void 0!==s&&(this.center=s),void 0!==n&&(this.direction=n)}},e.LineDto=class{constructor(e,t){this.start=[0,0,0],this.end=[0,1,0],void 0!==e&&(this.start=e),void 0!==t&&(this.end=t)}},e.LinesDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.lines=e),void 0!==t&&(this.returnCompound=t)}},e.ArcEdgeTwoPointsTangentDto=class{constructor(e,t,r){this.start=[0,0,0],this.tangentVec=[0,1,0],this.end=[0,0,1],void 0!==e&&(this.start=e),void 0!==t&&(this.tangentVec=t),void 0!==r&&(this.end=r)}},e.ArcEdgeCircleTwoPointsDto=class{constructor(e,t,r,i){this.start=[0,0,0],this.end=[0,0,1],this.sense=!0,void 0!==e&&(this.circle=e),void 0!==t&&(this.start=t),void 0!==r&&(this.end=r),void 0!==i&&(this.sense=i)}},e.ArcEdgeCircleTwoAnglesDto=class{constructor(e,t,r,i){this.alphaAngle1=0,this.alphaAngle2=90,this.sense=!0,void 0!==e&&(this.circle=e),void 0!==t&&(this.alphaAngle1=t),void 0!==r&&(this.alphaAngle2=r),void 0!==i&&(this.sense=i)}},e.ArcEdgeCirclePointAngleDto=class{constructor(e,t,r,i){this.alphaAngle=90,this.sense=!0,void 0!==e&&(this.circle=e),void 0!==t&&(this.alphaAngle=t),void 0!==i&&(this.sense=i)}},e.ArcEdgeThreePointsDto=class{constructor(e,t,r){this.start=[0,0,0],this.middle=[0,1,0],this.end=[0,0,1],void 0!==e&&(this.start=e),void 0!==t&&(this.middle=t),void 0!==r&&(this.end=r)}},e.CylinderDto=class{constructor(e,t,r,i){this.radius=1,this.height=2,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.radius=e),void 0!==t&&(this.height=t),void 0!==r&&(this.center=r),void 0!==i&&(this.direction=i)}},e.CylindersOnLinesDto=class{constructor(e,t){void 0!==e&&(this.radius=e),void 0!==t&&(this.lines=t)}},e.FilletDto=class{constructor(e,t,r,i){this.radius=.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.radius=t),void 0!==r&&(this.radiusList=r),void 0!==i&&(this.indexes=i)}},e.FilletEdgesListDto=class{constructor(e,t,r){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.radiusList=r)}},e.FilletEdgesListOneRadiusDto=class{constructor(e,t,r){this.radius=.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.radius=r)}},e.FilletEdgeVariableRadiusDto=class{constructor(e,t,r,i){void 0!==e&&(this.shape=e),void 0!==t&&(this.edge=t),void 0!==r&&(this.radiusList=r),void 0!==i&&(this.paramsU=i)}},e.FilletEdgesVariableRadiusDto=class{constructor(e,t,r,i){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.radiusLists=r),void 0!==i&&(this.paramsULists=i)}},e.FilletEdgesSameVariableRadiusDto=class{constructor(e,t,r,i){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.radiusList=r),void 0!==i&&(this.paramsU=i)}},e.Fillet3DWireDto=class{constructor(e,t,r,i,s){this.radius=.1,this.direction=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.radius=t),void 0!==r&&(this.direction=r),void 0!==i&&(this.radiusList=i),void 0!==s&&(this.indexes=s)}},e.ChamferDto=class{constructor(e,t,r,i){this.distance=.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.distance=t),void 0!==r&&(this.distanceList=r),void 0!==i&&(this.indexes=i)}},e.ChamferEdgesListDto=class{constructor(e,t,r){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.distanceList=r)}},e.ChamferEdgeDistAngleDto=class{constructor(e,t,r,i,s){this.distance=.1,this.angle=45,void 0!==e&&(this.shape=e),void 0!==t&&(this.edge=t),void 0!==r&&(this.face=r),void 0!==i&&(this.distance=i),void 0!==s&&(this.angle=s)}},e.ChamferEdgeTwoDistancesDto=class{constructor(e,t,r,i,s){this.distance1=.1,this.distance2=.2,void 0!==e&&(this.shape=e),void 0!==t&&(this.edge=t),void 0!==r&&(this.face=r),void 0!==i&&(this.distance1=i),void 0!==s&&(this.distance2=s)}},e.ChamferEdgesTwoDistancesListsDto=class{constructor(e,t,r,i,s){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.faces=r),void 0!==i&&(this.distances1=i),void 0!==s&&(this.distances2=s)}},e.ChamferEdgesTwoDistancesDto=class{constructor(e,t,r,i,s){this.distance1=.1,this.distance2=.2,void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.faces=r),void 0!==i&&(this.distance1=i),void 0!==s&&(this.distance2=s)}},e.ChamferEdgesDistsAnglesDto=class{constructor(e,t,r,i,s){void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.faces=r),void 0!==i&&(this.distances=i),void 0!==s&&(this.angles=s)}},e.ChamferEdgesDistAngleDto=class{constructor(e,t,r,i,s){this.distance=.1,this.angle=45,void 0!==e&&(this.shape=e),void 0!==t&&(this.edges=t),void 0!==r&&(this.faces=r),void 0!==i&&(this.distance=i),void 0!==s&&(this.angle=s)}},e.BSplineDto=class{constructor(e,t){this.closed=!1,void 0!==e&&(this.points=e),void 0!==t&&(this.closed=t)}},e.BSplinesDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.bSplines=e),void 0!==t&&(this.returnCompound=t)}},e.WireFromTwoCirclesTanDto=class{constructor(e,t,r,i,s){this.keepLines=f.outside,this.circleRemainders=p.outside,this.tolerance=1e-7,void 0!==e&&(this.circle1=e),void 0!==t&&(this.circle2=t),void 0!==r&&(this.keepLines=r),void 0!==i&&(this.circleRemainders=i),void 0!==s&&(this.tolerance=s)}},e.FaceFromMultipleCircleTanWiresDto=class{constructor(e,t,r,i){this.combination=v.allWithAll,this.unify=!0,this.tolerance=1e-7,void 0!==e&&(this.circles=e),void 0!==t&&(this.combination=t),void 0!==r&&(this.unify=r),void 0!==i&&(this.tolerance=i)}},e.FaceFromMultipleCircleTanWireCollectionsDto=class{constructor(e,t,r,i){this.combination=v.allWithAll,this.unify=!0,this.tolerance=1e-7,void 0!==e&&(this.listsOfCircles=e),void 0!==t&&(this.combination=t),void 0!==r&&(this.unify=r),void 0!==i&&(this.tolerance=i)}},e.ZigZagBetweenTwoWiresDto=class{constructor(e,t,r,i){this.nrZigZags=20,void 0!==e&&(this.wire1=e),void 0!==t&&(this.wire2=t),void 0!==r&&(this.nrZigZags=r),void 0!==i&&(this.inverse=i)}},e.InterpolationDto=class{constructor(e,t,r){this.periodic=!1,this.tolerance=1e-7,void 0!==e&&(this.points=e),void 0!==t&&(this.periodic=t),void 0!==r&&(this.tolerance=r)}},e.InterpolateWiresDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.interpolations=e),void 0!==t&&(this.returnCompound=t)}},e.BezierDto=class{constructor(e,t){this.closed=!1,void 0!==e&&(this.points=e),void 0!==t&&(this.closed=t)}},e.BezierWiresDto=class{constructor(e,t){this.returnCompound=!1,void 0!==e&&(this.bezierWires=e),void 0!==t&&(this.returnCompound=t)}},e.DivideDto=class{constructor(e,t,r,i){this.nrOfDivisions=10,this.removeStartPoint=!1,this.removeEndPoint=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.nrOfDivisions=t),void 0!==r&&(this.removeStartPoint=r),void 0!==i&&(this.removeEndPoint=i)}},e.ProjectWireDto=class{constructor(e,t,r){this.direction=[0,1,0],void 0!==e&&(this.wire=e),void 0!==t&&(this.shape=t),void 0!==r&&(this.direction=r)}},e.WiresToPointsDto=class{constructor(e,t,r,i,s,n){this.angularDeflection=.1,this.curvatureDeflection=.1,this.minimumOfPoints=2,this.uTolerance=1e-9,this.minimumLength=1e-7,void 0!==e&&(this.shape=e),void 0!==t&&(this.angularDeflection=t),void 0!==r&&(this.curvatureDeflection=r),void 0!==i&&(this.minimumOfPoints=i),void 0!==s&&(this.uTolerance=s),void 0!==n&&(this.minimumLength=n)}},e.EdgesToPointsDto=class{constructor(e,t,r,i,s,n){this.angularDeflection=.1,this.curvatureDeflection=.1,this.minimumOfPoints=2,this.uTolerance=1e-9,this.minimumLength=1e-7,void 0!==e&&(this.shape=e),void 0!==t&&(this.angularDeflection=t),void 0!==r&&(this.curvatureDeflection=r),void 0!==i&&(this.minimumOfPoints=i),void 0!==s&&(this.uTolerance=s),void 0!==n&&(this.minimumLength=n)}},e.ProjectWiresDto=class{constructor(e,t,r){this.direction=[0,1,0],void 0!==e&&(this.wires=e),void 0!==t&&(this.shape=t),void 0!==r&&(this.direction=r)}},e.DivideShapesDto=class{constructor(e,t,r,i){this.nrOfDivisions=10,this.removeStartPoint=!1,this.removeEndPoint=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.nrOfDivisions=t),void 0!==r&&(this.removeStartPoint=r),void 0!==i&&(this.removeEndPoint=i)}},e.DataOnGeometryAtParamDto=class{constructor(e,t){this.param=.5,void 0!==e&&(this.shape=e),void 0!==t&&(this.param=t)}},e.PointInFaceDto=class{constructor(e,t,r,i){this.tEdgeParam=.5,this.distance2DParam=.5,void 0!==e&&(this.face=e),void 0!==t&&(this.edge=t),void 0!==r&&(this.tEdgeParam=r),void 0!==i&&(this.distance2DParam=i)}},e.DataOnGeometryAtLengthDto=class{constructor(e,t){this.length=.5,void 0!==e&&(this.shape=e),void 0!==t&&(this.length=t)}},e.CircleDto=class{constructor(e,t,r){this.radius=1,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.radius=e),void 0!==t&&(this.center=t),void 0!==r&&(this.direction=r)}},e.LoftDto=class{constructor(e,t){this.makeSolid=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.makeSolid=t)}},e.LoftAdvancedDto=class{constructor(e,t,r,s,n,o,a,c,h,d,l,u){this.makeSolid=!1,this.closed=!1,this.periodic=!1,this.straight=!1,this.nrPeriodicSections=10,this.useSmoothing=!1,this.maxUDegree=3,this.tolerance=1e-7,this.parType=i.approxCentripetal,void 0!==e&&(this.shapes=e),void 0!==t&&(this.makeSolid=t),void 0!==r&&(this.closed=r),void 0!==s&&(this.periodic=s),void 0!==n&&(this.straight=n),void 0!==o&&(this.nrPeriodicSections=o),void 0!==a&&(this.useSmoothing=a),void 0!==c&&(this.maxUDegree=c),void 0!==h&&(this.tolerance=h),void 0!==d&&(this.parType=d),void 0!==l&&(this.startVertex=l),void 0!==u&&(this.endVertex=u)}},e.OffsetDto=class{constructor(e,t,r,i){this.distance=.2,this.tolerance=.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.face=t),void 0!==r&&(this.distance=r),void 0!==i&&(this.tolerance=i)}},e.OffsetAdvancedDto=class{constructor(e,r,i,s,n,o){this.distance=.2,this.tolerance=.1,this.joinType=t.arc,this.removeIntEdges=!1,void 0!==e&&(this.shape=e),void 0!==r&&(this.face=r),void 0!==i&&(this.distance=i),void 0!==s&&(this.tolerance=s),void 0!==n&&(this.joinType=n),void 0!==o&&(this.removeIntEdges=o)}},e.RevolveDto=class{constructor(e,t,r,i){this.angle=360,this.direction=[0,1,0],this.copy=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.angle=t),void 0!==r&&(this.direction=r),void 0!==i&&(this.copy=i)}},e.ShapeShapesDto=class{constructor(e,t){void 0!==e&&(this.shape=e),void 0!==t&&(this.shapes=t)}},e.WiresOnFaceDto=class{constructor(e,t){void 0!==e&&(this.wires=e),void 0!==t&&(this.face=t)}},e.PipeWiresCylindricalDto=class{constructor(e,t){this.radius=.1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.radius=t)}},e.PipeWireCylindricalDto=class{constructor(e,t){this.radius=.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.radius=t)}},e.PipePolygonWireNGonDto=class{constructor(e,t,r){this.radius=.1,this.nrCorners=6,void 0!==e&&(this.shape=e),void 0!==t&&(this.radius=t),void 0!==r&&(this.nrCorners=r)}},e.ExtrudeDto=class{constructor(e,t){this.direction=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.direction=t)}},e.ExtrudeShapesDto=class{constructor(e,t){this.direction=[0,1,0],void 0!==e&&(this.shapes=e),void 0!==t&&(this.direction=t)}},e.SplitDto=class{constructor(e,t){void 0!==e&&(this.shape=e),void 0!==t&&(this.shapes=t)}},e.UnionDto=class{constructor(e,t){this.keepEdges=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.keepEdges=t)}},e.DifferenceDto=class{constructor(e,t,r){this.keepEdges=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.shapes=t),void 0!==r&&(this.keepEdges=r)}},e.IntersectionDto=class{constructor(e,t){this.keepEdges=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.keepEdges=t)}},e.ShapeDto=class{constructor(e){void 0!==e&&(this.shape=e)}},e.CompareShapesDto=class{constructor(e,t){void 0!==e&&(this.shape=e),void 0!==t&&(this.otherShape=t)}},e.FixSmallEdgesInWireDto=class{constructor(e,t,r){this.lockvtx=!1,this.precsmall=0,void 0!==e&&(this.shape=e),void 0!==t&&(this.lockvtx=t),void 0!==r&&(this.precsmall=r)}},e.BasicShapeRepairDto=class{constructor(e,t,r,i){this.precision=.001,this.maxTolerance=.01,this.minTolerance=1e-4,void 0!==e&&(this.shape=e),void 0!==t&&(this.precision=t),void 0!==r&&(this.maxTolerance=r),void 0!==i&&(this.minTolerance=i)}},e.FixClosedDto=class{constructor(e,t){this.precision=-.1,void 0!==e&&(this.shape=e),void 0!==t&&(this.precision=t)}},e.ShapesWithToleranceDto=class{constructor(e,t){this.tolerance=1e-7,void 0!==e&&(this.shapes=e),void 0!==t&&(this.tolerance=t)}},e.ShapeWithToleranceDto=class{constructor(e,t){this.tolerance=1e-7,void 0!==e&&(this.shape=e),void 0!==t&&(this.tolerance=t)}},e.ShapeIndexDto=class{constructor(e,t){this.index=0,void 0!==e&&(this.shape=e),void 0!==t&&(this.index=t)}},e.EdgeIndexDto=class{constructor(e,t){this.index=1,void 0!==e&&(this.shape=e),void 0!==t&&(this.index=t)}},e.RotationExtrudeDto=class{constructor(e,t,r){this.height=1,this.angle=360,void 0!==e&&(this.shape=e),void 0!==t&&(this.height=t),void 0!==r&&(this.angle=r)}},e.ThickSolidByJoinDto=class{constructor(e,r,i,s,n,o,a,c){this.offset=1,this.tolerance=.001,this.intersection=!1,this.selfIntersection=!1,this.joinType=t.arc,this.removeIntEdges=!1,void 0!==e&&(this.shape=e),void 0!==r&&(this.shapes=r),void 0!==i&&(this.offset=i),void 0!==s&&(this.tolerance=s),void 0!==n&&(this.intersection=n),void 0!==o&&(this.selfIntersection=o),void 0!==a&&(this.joinType=a),void 0!==c&&(this.removeIntEdges=c)}},e.TransformDto=class{constructor(e,t,r,i,s){this.translation=[0,0,0],this.rotationAxis=[0,1,0],this.rotationAngle=0,this.scaleFactor=1,void 0!==e&&(this.shape=e),void 0!==t&&(this.translation=t),void 0!==r&&(this.rotationAxis=r),void 0!==i&&(this.rotationAngle=i),void 0!==s&&(this.scaleFactor=s)}},e.TransformShapesDto=class{constructor(e,t,r,i,s){this.translations=[[0,0,0]],this.rotationAxes=[[0,1,0]],this.rotationAngles=[0],this.scaleFactors=[1],void 0!==e&&(this.shapes=e),void 0!==t&&(this.translations=t),void 0!==r&&(this.rotationAxes=r),void 0!==i&&(this.rotationAngles=i),void 0!==s&&(this.scaleFactors=s)}},e.TranslateDto=class{constructor(e,t){this.translation=[0,0,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.translation=t)}},e.TranslateShapesDto=class{constructor(e,t){this.translations=[[0,0,0]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.translations=t)}},e.AlignDto=class{constructor(e,t,r,i,s){this.fromOrigin=[0,0,0],this.fromDirection=[0,0,1],this.toOrigin=[0,1,0],this.toDirection=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.fromOrigin=t),void 0!==r&&(this.fromDirection=r),void 0!==i&&(this.toOrigin=i),void 0!==s&&(this.toDirection=s)}},e.AlignShapesDto=class{constructor(e,t,r,i,s){this.fromOrigins=[[0,0,0]],this.fromDirections=[[0,0,1]],this.toOrigins=[[0,1,0]],this.toDirections=[[0,1,0]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.fromOrigins=t),void 0!==r&&(this.fromDirections=r),void 0!==i&&(this.toOrigins=i),void 0!==s&&(this.toDirections=s)}},e.MirrorDto=class{constructor(e,t,r){this.origin=[0,0,0],this.direction=[0,0,1],void 0!==e&&(this.shape=e),void 0!==t&&(this.origin=t),void 0!==r&&(this.direction=r)}},e.MirrorShapesDto=class{constructor(e,t,r){this.origins=[[0,0,0]],this.directions=[[0,0,1]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.origins=t),void 0!==r&&(this.directions=r)}},e.MirrorAlongNormalDto=class{constructor(e,t,r){this.origin=[0,0,0],this.normal=[0,0,1],void 0!==e&&(this.shape=e),void 0!==t&&(this.origin=t),void 0!==r&&(this.normal=r)}},e.MirrorAlongNormalShapesDto=class{constructor(e,t,r){this.origins=[[0,0,0]],this.normals=[[0,0,1]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.origins=t),void 0!==r&&(this.normals=r)}},e.AlignAndTranslateDto=class{constructor(e,t,r){this.direction=[0,1,0],this.center=[0,0,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.center=r)}},e.UnifySameDomainDto=class{constructor(e,t,r,i){this.unifyEdges=!0,this.unifyFaces=!0,this.concatBSplines=!0,void 0!==e&&(this.shape=e),void 0!==t&&(this.unifyEdges=t),void 0!==r&&(this.unifyFaces=r),void 0!==i&&(this.concatBSplines=i)}},e.FilterFacePointsDto=class{constructor(e,t,r,i,s,n,o,a,c){this.tolerance=1e-4,this.useBndBox=!1,this.gapTolerance=.1,this.keepIn=!0,this.keepOn=!0,this.keepOut=!1,this.keepUnknown=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.points=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.useBndBox=i),void 0!==s&&(this.gapTolerance=s),void 0!==n&&(this.keepIn=n),void 0!==o&&(this.keepOn=o),void 0!==a&&(this.keepOut=a),void 0!==c&&(this.keepUnknown=c)}},e.FilterSolidPointsDto=class{constructor(e,t,r,i,s,n,o){this.tolerance=1e-4,this.keepIn=!0,this.keepOn=!0,this.keepOut=!1,this.keepUnknown=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.points=t),void 0!==r&&(this.tolerance=r),void 0!==i&&(this.keepIn=i),void 0!==s&&(this.keepOn=s),void 0!==n&&(this.keepOut=n),void 0!==o&&(this.keepUnknown=o)}},e.AlignAndTranslateShapesDto=class{constructor(e,t,r){this.directions=[[0,1,0]],this.centers=[[0,0,0]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.directions=t),void 0!==r&&(this.centers=r)}},e.RotateDto=class{constructor(e,t,r){this.axis=[0,0,1],this.angle=0,void 0!==e&&(this.shape=e),void 0!==t&&(this.axis=t),void 0!==r&&(this.angle=r)}},e.RotateAroundCenterDto=class{constructor(e,t,r,i){this.angle=0,this.center=[0,0,0],this.axis=[0,0,1],void 0!==e&&(this.shape=e),void 0!==t&&(this.angle=t),void 0!==r&&(this.center=r),void 0!==i&&(this.axis=i)}},e.RotateShapesDto=class{constructor(e,t,r){this.angles=[0],void 0!==e&&(this.shapes=e),void 0!==t&&(this.axes=t),void 0!==r&&(this.angles=r)}},e.RotateAroundCenterShapesDto=class{constructor(e,t,r,i){this.angles=[0],this.centers=[[0,0,0]],this.axes=[[0,0,1]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.angles=t),void 0!==r&&(this.centers=r),void 0!==i&&(this.axes=i)}},e.ScaleDto=class{constructor(e,t){this.factor=1,void 0!==e&&(this.shape=e),void 0!==t&&(this.factor=t)}},e.ScaleShapesDto=class{constructor(e,t){this.factors=[1],void 0!==e&&(this.shapes=e),void 0!==t&&(this.factors=t)}},e.Scale3DDto=class{constructor(e,t,r){this.scale=[1,1,1],this.center=[0,0,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.scale=t),void 0!==r&&(this.center=r)}},e.Scale3DShapesDto=class{constructor(e,t,r){this.scales=[[1,1,1]],this.centers=[[0,0,0]],void 0!==e&&(this.shapes=e),void 0!==t&&(this.scales=t),void 0!==r&&(this.centers=r)}},e.ShapeToMeshDto=class{constructor(e,t,r){this.precision=.01,this.adjustYtoZ=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.precision=t),void 0!==r&&(this.adjustYtoZ=r)}},e.ShapesToMeshesDto=class{constructor(e,t,r){this.precision=.01,this.adjustYtoZ=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.precision=t),void 0!==r&&(this.adjustYtoZ=r)}},e.SaveStepDto=class{constructor(e,t,r,i){this.fileName="shape.step",this.adjustYtoZ=!1,this.tryDownload=!0,void 0!==e&&(this.shape=e),void 0!==t&&(this.fileName=t),void 0!==r&&(this.adjustYtoZ=r),void 0!==i&&(this.tryDownload=i)}},e.SaveStlDto=class{constructor(e,t,r,i,s,n){this.fileName="shape.stl",this.precision=.01,this.adjustYtoZ=!1,this.tryDownload=!0,this.binary=!0,void 0!==e&&(this.shape=e),void 0!==t&&(this.fileName=t),void 0!==r&&(this.precision=r),void 0!==i&&(this.adjustYtoZ=i),void 0!==s&&(this.tryDownload=s),void 0!==n&&(this.binary=n)}},e.ImportStepIgesFromTextDto=class{constructor(e,t,r){this.fileType=n.step,this.adjustZtoY=!0,void 0!==e&&(this.text=e),void 0!==t&&(this.fileType=t),void 0!==r&&(this.adjustZtoY=r)}},e.ImportStepIgesDto=class{constructor(e,t){this.adjustZtoY=!0,void 0!==e&&(this.assetFile=e),void 0!==t&&(this.adjustZtoY=t)}},e.LoadStepOrIgesDto=class{constructor(e,t,r){this.fileName="shape.igs",this.adjustZtoY=!0,void 0!==e&&(this.filetext=e),void 0!==t&&(this.fileName=t),void 0!==r&&(this.adjustZtoY=r)}},e.CompoundShapesDto=class{constructor(e){void 0!==e&&(this.shapes=e)}},e.ThisckSolidSimpleDto=class{constructor(e,t){this.offset=1,void 0!==e&&(this.shape=e),void 0!==t&&(this.offset=t)}},e.Offset3DWireDto=class{constructor(e,t,r){this.offset=1,this.direction=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.offset=t),void 0!==r&&(this.direction=r)}},e.FaceFromWireDto=class{constructor(e,t){this.planar=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.planar=t)}},e.FaceFromWiresDto=class{constructor(e,t){this.planar=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.planar=t)}},e.FacesFromWiresDto=class{constructor(e,t){this.planar=!1,void 0!==e&&(this.shapes=e),void 0!==t&&(this.planar=t)}},e.SewDto=class{constructor(e,t){this.tolerance=1e-7,void 0!==e&&(this.shapes=e),void 0!==t&&(this.tolerance=t)}},e.FaceIsoCurveAtParamDto=class{constructor(e,t,r){this.dir="u",void 0!==e&&(this.shape=e),void 0!==t&&(this.param=t),void 0!==r&&(this.dir=r)}},e.DivideFaceToUVPointsDto=class{constructor(e,t,r,i){this.nrOfPointsU=10,this.nrOfPointsV=10,this.flat=!1,void 0!==e&&(this.shape=e),void 0!==t&&(this.nrOfPointsU=t),void 0!==r&&(this.nrOfPointsV=r),void 0!==i&&(this.flat=i)}},e.Geom2dEllipseDto=class{constructor(e,t,r,i,s){this.center=[0,0],this.direction=[1,0],this.radiusMinor=1,this.radiusMajor=2,this.sense=!1,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.radiusMinor=r),void 0!==i&&(this.radiusMajor=i),void 0!==s&&(this.sense=s)}},e.Geom2dCircleDto=class{constructor(e,t,r,i){this.center=[0,0],this.direction=[1,0],this.radius=1,this.sense=!1,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.radius=r),void 0!==i&&(this.sense=i)}},e.ChristmasTreeDto=class{constructor(e,t,r,i,s,n,o,a,c,h){this.height=6,this.innerDist=1.5,this.outerDist=3,this.nrSkirts=5,this.trunkHeight=1,this.trunkWidth=1,this.half=!1,this.rotation=0,this.origin=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.height=e),void 0!==t&&(this.innerDist=t),void 0!==r&&(this.outerDist=r),void 0!==i&&(this.nrSkirts=i),void 0!==s&&(this.trunkHeight=s),void 0!==n&&(this.trunkWidth=n),void 0!==o&&(this.half=o),void 0!==a&&(this.rotation=a),void 0!==c&&(this.origin=c),void 0!==h&&(this.direction=h)}},e.StarDto=class{constructor(e,t,r,i,s,n,o){this.center=[0,0,0],this.direction=[0,1,0],this.numRays=7,this.half=!1,void 0!==e&&(this.outerRadius=e),void 0!==t&&(this.innerRadius=t),void 0!==r&&(this.numRays=r),void 0!==i&&(this.center=i),void 0!==s&&(this.direction=s),void 0!==n&&(this.offsetOuterEdges=n),void 0!==o&&(this.half=o)}},e.ParallelogramDto=class{constructor(e,t,r,i,s,n){this.center=[0,0,0],this.direction=[0,1,0],this.aroundCenter=!0,this.width=2,this.height=1,this.angle=15,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.aroundCenter=r),void 0!==i&&(this.width=i),void 0!==s&&(this.height=s),void 0!==n&&(this.angle=n)}},e.Heart2DDto=class{constructor(e,t,r,i){this.center=[0,0,0],this.direction=[0,1,0],this.rotation=0,this.sizeApprox=2,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.rotation=r),void 0!==i&&(this.sizeApprox=i)}},e.NGonWireDto=class{constructor(e,t,r,i){this.center=[0,0,0],this.direction=[0,1,0],this.nrCorners=6,this.radius=1,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.nrCorners=r),void 0!==i&&(this.radius=i)}},e.EllipseDto=class{constructor(e,t,r,i){this.center=[0,0,0],this.direction=[0,1,0],this.radiusMinor=1,this.radiusMajor=2,void 0!==e&&(this.center=e),void 0!==t&&(this.direction=t),void 0!==r&&(this.radiusMinor=r),void 0!==i&&(this.radiusMajor=i)}},e.GeomCylindricalSurfaceDto=class{constructor(e,t,r){this.radius=1,this.center=[0,0,0],this.direction=[0,1,0],void 0!==e&&(this.radius=e),void 0!==t&&(this.center=t),void 0!==r&&(this.direction=r)}},e.Geom2dTrimmedCurveDto=class{constructor(e,t,r,i,s){this.u1=0,this.u2=1,this.sense=!0,this.adjustPeriodic=!0,void 0!==e&&(this.shape=e),void 0!==t&&(this.u1=t),void 0!==r&&(this.u2=r),void 0!==i&&(this.sense=i),void 0!==s&&(this.adjustPeriodic=s)}},e.Geom2dSegmentDto=class{constructor(e,t){this.start=[0,0],this.end=[1,0],void 0!==e&&(this.start=e),void 0!==t&&(this.end=t)}},e.SliceDto=class{constructor(e,t,r){this.step=.1,this.direction=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.step=t),void 0!==r&&(this.direction=r)}},e.SliceInStepPatternDto=class{constructor(e,t,r){this.steps=[.1,.2],this.direction=[0,1,0],void 0!==e&&(this.shape=e),void 0!==t&&(this.steps=t),void 0!==r&&(this.direction=r)}}}(t||(t={})),function(e){let t;!function(e){e.default="default",e.clearSky="clearSky",e.city="city"}(t=e.skyboxEnum||(e.skyboxEnum={}))}(i||(i={}));class c{constructor(e,t){this.occ=e,this.och=t}geom2dEllipse(e){const t=this.och.entitiesService.gpAx2d(e.center,e.direction),r=new this.occ.Geom2d_Ellipse_2(t,e.radiusMajor,e.radiusMinor,e.sense);return t.delete(),r}geom2dCircle(e){const t=this.och.entitiesService.gpAx2d(e.center,e.direction),r=new this.occ.Geom2d_Circle_2(t,e.radius,e.sense);return t.delete(),r}geom2dTrimmedCurve(e){const t=new this.occ.Handle_Geom2d_Curve_2(e.shape);return new this.occ.Geom2d_TrimmedCurve(t,e.u1,e.u2,e.sense,e.adjustPeriodic)}geom2dSegment(e){const t=this.och.entitiesService.gpPnt2d(e.start),r=this.och.entitiesService.gpPnt2d(e.end),i=new this.occ.GCE2d_MakeSegment_1(t,r),s=i.Value().get();return t.delete(),r.delete(),i.delete(),s}get2dPointFrom2dCurveOnParam(e){const t=e.shape.Value(e.param),r=[t.X(),t.Y()];return t.delete(),r}geomCircleCurve(e){return this.och.entitiesService.createCircle(e.radius,e.center,e.direction,t.typeSpecificityEnum.curve)}geomEllipseCurve(e){return this.och.entitiesService.createEllipse(e.radiusMinor,e.radiusMajor,e.center,e.direction,t.typeSpecificityEnum.curve)}}class h{constructor(e,t){this.occ=e,this.och=t}cylindricalSurface(e){const t=this.och.entitiesService.gpAx3(e.center,e.direction),r=new this.occ.Geom_CylindricalSurface_1(t,e.radius);return t.delete(),r}surfaceFromFace(e){return this.och.surfaceFromFace(e)}}class d{constructor(e,t){this.curves=new c(e,t),this.surfaces=new h(e,t)}}class l{constructor(e,t){this.occ=e,this.och=t}makeEdgeFromGeom2dCurveAndSurface(e){return this.och.edgesService.makeEdgeFromGeom2dCurveAndSurface(e)}line(e){return this.och.edgesService.lineEdge(e)}arcThroughThreePoints(e){return this.och.edgesService.arcThroughThreePoints(e)}arcThroughTwoPointsAndTangent(e){return this.och.edgesService.arcThroughTwoPointsAndTangent(e)}arcFromCircleAndTwoPoints(e){return this.och.edgesService.arcFromCircleAndTwoPoints(e)}arcFromCircleAndTwoAngles(e){return this.och.edgesService.arcFromCircleAndTwoAngles(e)}arcFromCirclePointAndAngle(e){return this.och.edgesService.arcFromCirclePointAndAngle(e)}createCircleEdge(e){return this.och.entitiesService.createCircle(e.radius,e.center,e.direction,t.typeSpecificityEnum.edge)}createEllipseEdge(e){return this.och.entitiesService.createEllipse(e.radiusMinor,e.radiusMajor,e.center,e.direction,t.typeSpecificityEnum.edge)}removeInternalEdges(e){const t=new this.occ.ShapeUpgrade_UnifySameDomain_2(e.shape,!0,!0,!1);t.Build();const r=t.Shape();return t.delete(),r}getEdge(e){return this.och.shapeGettersService.getEdge(e)}edgesToPoints(e){return this.och.edgesService.edgesToPoints(e)}reversedEdge(e){const t=e.shape.Reversed(),r=this.och.converterService.getActualTypeOfShape(t);return t.delete(),r}pointOnEdgeAtParam(e){return this.och.edgesService.pointOnEdgeAtParam(e)}tangentOnEdgeAtParam(e){return this.och.edgesService.tangentOnEdgeAtParam(e)}startPointOnEdge(e){return this.och.edgesService.startPointOnEdge(e)}endPointOnEdge(e){return this.och.edgesService.endPointOnEdge(e)}pointOnEdgeAtLength(e){return this.och.edgesService.pointOnEdgeAtLength(e)}tangentOnEdgeAtLength(e){return this.och.edgesService.tangentOnEdgeAtLength(e)}divideEdgeByParamsToPoints(e){return this.och.edgesService.divideEdgeByParamsToPoints(e)}divideEdgeByEqualDistanceToPoints(e){return this.och.edgesService.divideEdgeByEqualDistanceToPoints(e)}getEdges(e){return this.och.shapeGettersService.getEdges(e)}getEdgesAlongWire(e){return this.och.edgesService.getEdgesAlongWire(e)}getCircularEdgesAlongWire(e){return this.och.edgesService.getCircularEdgesAlongWire(e)}getLinearEdgesAlongWire(e){return this.och.edgesService.getLinearEdgesAlongWire(e)}getEdgeLength(e){return this.och.edgesService.getEdgeLength(e)}getEdgesLengths(e){return this.och.edgesService.getEdgesLengths(e)}getEdgeCenterOfMass(e){return this.och.geomService.getLinearCenterOfMass(e)}getEdgesCentersOfMass(e){return this.och.edgesService.getEdgesCentersOfMass(e)}getCornerPointsOfEdgesForShape(e){return this.och.edgesService.getCornerPointsOfEdgesForShape(e)}getCircularEdgeCenterPoint(e){return this.och.edgesService.getCircularEdgeCenterPoint(e)}getCircularEdgeRadius(e){return this.och.edgesService.getCircularEdgeRadius(e)}getCircularEdgePlaneDirection(e){return this.och.edgesService.getCircularEdgePlaneDirection(e)}constraintTanLinesFromTwoPtsToCircle(e){return this.och.edgesService.constraintTanLinesFromTwoPtsToCircle(e)}constraintTanLinesFromPtToCircle(e){return this.och.edgesService.constraintTanLinesFromPtToCircle(e)}constraintTanLinesOnTwoCircles(e){return this.och.edgesService.constraintTanLinesOnTwoCircles(e)}constraintTanCirclesOnTwoCircles(e){return this.och.edgesService.constraintTanCirclesOnTwoCircles(e)}constraintTanCirclesOnCircleAndPnt(e){return this.och.edgesService.constraintTanCirclesOnCircleAndPnt(e)}}class u{constructor(e,t){this.occ=e,this.och=t}createFaceFromWire(e){return this.och.facesService.createFaceFromWire(e)}createFaceFromWires(e){return this.och.facesService.createFaceFromWires(e)}createFacesFromWires(e){return this.och.facesService.createFacesFromWires(e)}faceFromSurface(e){return this.och.facesService.faceFromSurface(e)}faceFromSurfaceAndWire(e){return this.och.facesService.faceFromSurfaceAndWire(e)}getUMinBound(e){return this.och.facesService.getUMinBound(e)}getUMaxBound(e){return this.och.facesService.getUMaxBound(e)}getVMinBound(e){return this.och.facesService.getVMinBound(e)}getVMaxBound(e){return this.och.facesService.getVMaxBound(e)}subdivideToPointsControlled(e){return this.och.facesService.subdivideToPointsControlled(e)}subdivideToPoints(e){return this.och.facesService.subdivideToPoints(e)}subdivideToNormals(e){return this.och.facesService.subdivideToNormals(e)}subdivideToPointsOnParam(e){return this.och.facesService.subdivideToPointsOnParam(e)}subdivideToUVOnParam(e){return this.och.facesService.subdivideToUVOnParam(e)}subdivideToUV(e){return this.och.facesService.subdivideToUV(e)}uvOnFace(e){return this.och.facesService.uvOnFace(e)}pointsOnUVs(e){return this.och.facesService.pointsOnUVs(e)}normalsOnUVs(e){return this.och.facesService.normalsOnUVs(e)}pointOnUV(e){return this.och.facesService.pointOnUV(e)}normalOnUV(e){return this.och.facesService.faceNormalOnUV(e)}createPolygonFace(e){return this.och.facesService.createPolygonFace(e)}createCircleFace(e){return this.och.entitiesService.createCircle(e.radius,e.center,e.direction,t.typeSpecificityEnum.face)}createEllipseFace(e){return this.och.entitiesService.createEllipse(e.radiusMinor,e.radiusMajor,e.center,e.direction,t.typeSpecificityEnum.face)}createSquareFace(e){return this.och.facesService.createSquareFace(e)}createRectangleFace(e){return this.och.facesService.createRectangleFace(e)}createFaceFromMultipleCircleTanWireCollections(e){return this.och.facesService.createFaceFromMultipleCircleTanWireCollections(e)}createFaceFromMultipleCircleTanWires(e){return this.och.facesService.createFaceFromMultipleCircleTanWires(e)}getFace(e){return this.och.shapeGettersService.getFace(e)}getFaces(e){return this.och.shapeGettersService.getFaces(e)}reversedFace(e){const t=e.shape.Reversed(),r=this.och.converterService.getActualTypeOfShape(t);return t.delete(),r}getFaceArea(e){return this.och.facesService.getFaceArea(e)}getFacesAreas(e){return this.och.facesService.getFacesAreas(e)}getFaceCenterOfMass(e){return this.och.facesService.getFaceCenterOfMass(e)}getFacesCentersOfMass(e){return this.och.facesService.getFacesCentersOfMass(e)}filterFacePoints(e){return this.och.facesService.filterFacePoints(e)}}class p{constructor(e,t){this.occ=e,this.och=t}makeCompound(e){return this.och.converterService.makeCompound(e)}}class f{constructor(e,t){this.occ=e,this.och=t}vertexFromPoint(e){return this.och.entitiesService.makeVertex(e.point)}verticesFromPoints(e){return e.points.map((e=>this.vertexFromPoint({point:e})))}verticesCompoundFromPoints(e){const t=this.verticesFromPoints(e);return this.och.converterService.makeCompound({shapes:t})}getVertices(e){return this.och.shapeGettersService.getVertices(e)}getVerticesAsPoints(e){return this.och.verticesService.getVerticesAsPoints(e)}verticesToPoints(e){return this.och.verticesService.verticesToPoints(e)}vertexToPoint(e){return this.och.converterService.vertexToPoint(e)}}class v{constructor(e,t){this.occ=e,this.och=t}purgeInternalEdges(e){const t=new this.occ.TopOpeBRepTool_PurgeInternalEdges(e.shape,!0);if(t.Perform(),t.IsDone())return t.Shape();throw new Error("Could not purge internal edges for the shape")}unifySameDomain(e){const t=new this.occ.ShapeUpgrade_UnifySameDomain_2(e.shape,e.unifyEdges,e.unifyFaces,e.concatBSplines);return t.Build(),t.Shape()}isClosed(e){return e.shape.Closed_1()}isConvex(e){return e.shape.Convex_1()}isChecked(e){return e.shape.Checked_1()}isFree(e){return e.shape.Free_1()}isInfinite(e){return e.shape.Infinite_1()}isModified(e){return e.shape.Modified_1()}isLocked(e){return e.shape.Locked_1()}isNull(e){return e.shape.IsNull()}isEqual(e){return e.shape.IsEqual(e.otherShape)}isNotEqual(e){return e.shape.IsNotEqual(e.otherShape)}isPartner(e){return e.shape.IsPartner(e.otherShape)}isSame(e){return e.shape.IsSame(e.otherShape)}getOrientation(e){const r=e.shape.Orientation_1();let i;return r===this.occ.TopAbs_Orientation.TopAbs_FORWARD?i=t.topAbsOrientationEnum.forward:r===this.occ.TopAbs_Orientation.TopAbs_REVERSED?i=t.topAbsOrientationEnum.reversed:r===this.occ.TopAbs_Orientation.TopAbs_INTERNAL?i=t.topAbsOrientationEnum.internal:r===this.occ.TopAbs_Orientation.TopAbs_EXTERNAL&&(i=t.topAbsOrientationEnum.external),i}getShapeType(e){return this.och.enumService.getShapeTypeEnum(e.shape)}}class g{constructor(e,t){this.occ=e,this.och=t}sewFaces(e){return this.och.shellsService.sewFaces(e)}isClosed(e){return this.occ.BRep_Tool.IsClosed_1(e.shape)}getShellSurfaceArea(e){return this.och.shellsService.getShellSurfaceArea(e)}}class m{constructor(e,t){this.occ=e,this.och=t}fromClosedShell(e){return this.och.solidsService.fromClosedShell(e)}createBox(e){return this.och.solidsService.createBox(e)}createCube(e){return this.och.solidsService.createCube(e)}createBoxFromCorner(e){return this.och.solidsService.createBoxFromCorner(e)}createCylinder(e){return this.och.solidsService.createCylinder(e)}createCylindersOnLines(e){return this.och.solidsService.createCylindersOnLines(e)}createSphere(e){return this.och.solidsService.createSphere(e)}createCone(e){return this.och.solidsService.createCone(e)}getSolidSurfaceArea(e){return this.och.solidsService.getSolidSurfaceArea(e)}getSolidVolume(e){return this.och.solidsService.getSolidVolume(e)}getSolidsVolumes(e){return this.och.solidsService.getSolidsVolumes(e)}getSolidCenterOfMass(e){return this.och.solidsService.getSolidCenterOfMass(e)}getSolidsCentersOfMass(e){return this.och.solidsService.getSolidsCentersOfMass(e)}getSolids(e){return this.och.solidsService.getSolids(e)}filterSolidPoints(e){return this.och.solidsService.filterSolidPoints(e)}}class S{constructor(e,t){this.occ=e,this.och=t}createPolygonWire(e){return this.och.wiresService.createPolygonWire(e)}createPolygons(e){const t=e.polygons.map((e=>this.createPolygonWire(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}createPolylineWire(e){return this.och.wiresService.createPolylineWire(e)}createPolylines(e){const t=e.polylines.map((e=>this.createPolylineWire(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}createLineWire(e){return this.och.wiresService.createLineWire(e)}createLines(e){const t=e.lines.map((e=>this.createLineWire(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}createBezier(e){return this.och.wiresService.createBezier(e)}createBezierWires(e){const t=e.bezierWires.map((e=>this.createBezier(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}interpolatePoints(e){return this.och.wiresService.interpolatePoints(e)}interpolateWires(e){const t=e.interpolations.map((e=>this.interpolatePoints(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}splitOnPoints(e){return this.och.wiresService.splitOnPoints(e)}combineEdgesAndWiresIntoAWire(e){return this.och.converterService.combineEdgesAndWiresIntoAWire(e)}createWireFromEdge(e){return this.och.wiresService.createWireFromEdges(e)}addEdgesAndWiresToWire(e){return this.och.wiresService.addEdgesAndWiresToWire(e)}createBSpline(e){return this.och.wiresService.createBSpline(e)}createBSplines(e){const t=e.bSplines.map((e=>this.createBSpline(e))).filter((e=>void 0!==e));return this.och.converterService.makeCompoundIfNeeded(t,e.returnCompound)}createZigZagBetweenTwoWires(e){return this.och.wiresService.createZigZagBetweenTwoWires(e)}divideWireByParamsToPoints(e){return this.och.wiresService.divideWireByParamsToPoints(e)}divideWiresByParamsToPoints(e){return e.shapes.map((t=>this.divideWireByParamsToPoints(Object.assign(Object.assign({},e),{shape:t}))))}divideWireByEqualDistanceToPoints(e){return this.och.wiresService.divideWireByEqualDistanceToPoints(e)}divideWiresByEqualDistanceToPoints(e){return e.shapes.map((t=>this.divideWireByEqualDistanceToPoints(Object.assign(Object.assign({},e),{shape:t}))))}pointOnWireAtParam(e){return this.och.wiresService.pointOnWireAtParam(e)}pointOnWireAtLength(e){return this.och.wiresService.pointOnWireAtLength(e)}tangentOnWireAtParam(e){return this.och.wiresService.tangentOnWireAtParam(e)}tangentOnWireAtLength(e){return this.och.wiresService.tangentOnWireAtLength(e)}derivativesOnWireAtLength(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=new this.occ.GCPnts_AbscissaPoint_2(r,e.length,r.FirstParameter()),s=i.Parameter(),n=this.och.entitiesService.gpPnt([0,0,0]),o=this.och.entitiesService.gpVec([0,0,0]),a=this.och.entitiesService.gpVec([0,0,0]),c=this.och.entitiesService.gpVec([0,0,0]);r.D3(s,n,o,a,c);const h=[[o.X(),o.Y(),o.Z()],[a.X(),a.Y(),a.Z()],[c.X(),c.Y(),c.Z()]];return o.delete(),a.delete(),c.delete(),r.delete(),i.delete(),n.delete(),h}derivativesOnWireAtParam(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.och.entitiesService.gpPnt([0,0,0]),s=this.och.entitiesService.gpVec([0,0,0]),n=this.och.entitiesService.gpVec([0,0,0]),o=this.och.entitiesService.gpVec([0,0,0]),a=this.och.vecHelper.remap(e.param,0,1,r.FirstParameter(),r.LastParameter());r.D3(a,i,s,n,o);const c=[[s.X(),s.Y(),s.Z()],[n.X(),n.Y(),n.Z()],[o.X(),o.Y(),o.Z()]];return s.delete(),n.delete(),o.delete(),r.delete(),i.delete(),c}startPointOnWire(e){return this.och.wiresService.startPointOnWire(e)}endPointOnWire(e){return this.och.wiresService.endPointOnWire(e)}createCircleWire(e){return this.och.entitiesService.createCircle(e.radius,e.center,e.direction,t.typeSpecificityEnum.wire)}createEllipseWire(e){return this.och.entitiesService.createEllipse(e.radiusMinor,e.radiusMajor,e.center,e.direction,t.typeSpecificityEnum.wire)}createSquareWire(e){return this.och.wiresService.createSquareWire(e)}createStarWire(e){return this.och.wiresService.createStarWire(e)}createChristmasTreeWire(e){return this.och.wiresService.createChristmasTreeWire(e)}createParallelogramWire(e){return this.och.wiresService.createParallelogramWire(e)}createHeartWire(e){return this.och.wiresService.createHeartWire(e)}createNGonWire(e){return this.och.wiresService.createNGonWire(e)}createRectangleWire(e){return this.och.wiresService.createRectangleWire(e)}createLPolygonWire(e){return this.och.wiresService.createLPolygonWire(e)}getWire(e){return this.och.shapeGettersService.getWire(e)}getWires(e){return this.och.shapeGettersService.getWires(e)}getWireLength(e){return this.och.wiresService.getWireLength(e)}getWiresLengths(e){return this.och.wiresService.getWiresLengths(e)}getWireCenterOfMass(e){return this.och.wiresService.getWireCenterOfMass(e)}getWiresCentersOfMass(e){return e.shapes.map((e=>this.och.wiresService.getWireCenterOfMass({shape:e})))}reversedWire(e){const t=e.shape.Reversed(),r=this.och.converterService.getActualTypeOfShape(t);return t.delete(),r}reversedWireFromReversedEdges(e){const t=e.shape,r=this.och.edgesService.getEdgesAlongWire({shape:t}).map((e=>this.och.converterService.getActualTypeOfShape(e.Reversed()))),i=this.och.converterService.combineEdgesAndWiresIntoAWire({shapes:r.reverse()}),s=this.och.converterService.getActualTypeOfShape(i);return i.delete(),r.forEach((e=>e.delete())),s}placeWireOnFace(e){const t=e.wire,r=e.face,i=this.och.surfaceFromFace({shape:r});return this.och.wiresService.placeWire(t,i)}placeWiresOnFace(e){const t=e.wires,r=e.face,i=this.och.surfaceFromFace({shape:r});return t.map((e=>this.och.wiresService.placeWire(e,i)))}closeOpenWire(e){const t=e.shape,r=this.och.wiresService.startPointOnWire({shape:t}),i=this.och.wiresService.endPointOnWire({shape:t});if(this.och.vecHelper.vectorsTheSame(r,i,1e-7))return t;const s=this.createLineWire({start:i,end:r}),n=this.addEdgesAndWiresToWire({shape:t,shapes:[s]});return s.delete(),n}project(e){const t=e.wire,r=this.och.entitiesService.gpDir(e.direction),i=new this.occ.BRepProj_Projection_1(t,e.shape,r),s=i.Shape();return r.delete(),i.delete(),s}wiresToPoints(e){const t=this.getWires({shape:e.shape}),r=[];return t.forEach((t=>{const i=this.och.edgesService.edgesToPoints(Object.assign(Object.assign({},e),{shape:t})).flat(),s=this.och.vecHelper.removeConsecutiveDuplicates(i,!1);r.push(s)})),r}projectWires(e){const t=[];return e.wires.forEach((r=>{const i=this.och.entitiesService.gpDir(e.direction),s=new this.occ.BRepProj_Projection_1(r,e.shape,i),n=s.Shape();t.push(n),i.delete(),s.delete()})),t}createWireFromTwoCirclesTan(e){return this.och.wiresService.createWireFromTwoCirclesTan(e)}}class E{constructor(e,t){this.vertex=new f(e,t),this.edge=new l(e,t),this.wire=new S(e,t),this.face=new u(e,t),this.shell=new g(e,t),this.solid=new m(e,t),this.compound=new p(e,t),this.shape=new v(e,t)}}class w{constructor(e){this.occ=e}BRep_Tool_Range_1(e,t,r){return this.occ.BRep_Tool.Range_1(e,t,r)}BRep_Tool_Curve_2(e,t,r){return this.occ.BRep_Tool.Curve_2(e,t,r)}BRepTools_UVBounds_1(e,t,r,i,s){return this.occ.BRepTools.UVBounds_1(e,t,r,i,s)}}class _{constructor(e){this.occ=e}forEachWire(e,t){let r=0;const i=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_WIRE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(i.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_WIRE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);i.More();i.Next())t(r++,this.occ.TopoDS.Wire_2(i.Current()));i.delete()}forEachEdge(e,t){const r={};let i=0;const s=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_EDGE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(s.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_EDGE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);s.More();s.Next()){const e=this.occ.TopoDS.Edge_1(s.Current()),n=e.HashCode(1e8);Object.prototype.hasOwnProperty.call(r,n)||(r[n]=i,i++,t(i,e))}return s.delete(),r}forEachEdgeAlongWire(e,t){const r={};let i=0;const s=new this.occ.BRepTools_WireExplorer_1;for(s.Init_1(e);s.More();s.Next()){const e=this.occ.TopoDS.Edge_1(s.Current()),n=e.HashCode(1e8);Object.prototype.hasOwnProperty.call(r,n)||(r[n]=i,i++,t(i,e))}return s.delete(),r}forEachFace(e,t){let r=0;const i=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_FACE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(i.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_FACE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);i.More();i.Next())t(r++,this.occ.TopoDS.Face_1(i.Current()));i.delete()}forEachShell(e,t){let r=0;const i=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_SHELL,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(i.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_SHELL,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);i.More();i.Next())t(r++,this.occ.TopoDS.Shell_1(i.Current()));i.delete()}forEachVertex(e,t){let r=0;const i=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(i.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);i.More();i.Next())t(r++,this.occ.TopoDS.Vertex_1(i.Current()));i.delete()}forEachSolid(e,t){let r=0;const i=new this.occ.TopExp_Explorer_2(e,this.occ.TopAbs_ShapeEnum.TopAbs_SOLID,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);for(i.Init(e,this.occ.TopAbs_ShapeEnum.TopAbs_SOLID,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);i.More();i.Next())t(r++,this.occ.TopoDS.Solid_2(i.Current()));i.delete()}}class y{constructor(e){this.occ=e}getShapeTypeEnum(e){let r=t.shapeTypeEnum.unknown;const i=e.ShapeType();return r=i===this.occ.TopAbs_ShapeEnum.TopAbs_EDGE?t.shapeTypeEnum.edge:i===this.occ.TopAbs_ShapeEnum.TopAbs_WIRE?t.shapeTypeEnum.wire:i===this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX?t.shapeTypeEnum.vertex:i===this.occ.TopAbs_ShapeEnum.TopAbs_SOLID?t.shapeTypeEnum.solid:i===this.occ.TopAbs_ShapeEnum.TopAbs_SHELL?t.shapeTypeEnum.shell:i===this.occ.TopAbs_ShapeEnum.TopAbs_FACE?t.shapeTypeEnum.face:i===this.occ.TopAbs_ShapeEnum.TopAbs_COMPSOLID?t.shapeTypeEnum.compSolid:i===this.occ.TopAbs_ShapeEnum.TopAbs_COMPOUND?t.shapeTypeEnum.compound:t.shapeTypeEnum.shape,r}getGccEntPositionFromEnum(e){let r=this.occ.GccEnt_Position.GccEnt_noqualifier;return r=e===t.gccEntPositionEnum.unqualified?this.occ.GccEnt_Position.GccEnt_unqualified:e===t.gccEntPositionEnum.enclosed?this.occ.GccEnt_Position.GccEnt_enclosed:e===t.gccEntPositionEnum.enclosing?this.occ.GccEnt_Position.GccEnt_enclosing:e===t.gccEntPositionEnum.outside?this.occ.GccEnt_Position.GccEnt_outside:(t.gccEntPositionEnum.noqualifier,this.occ.GccEnt_Position.GccEnt_noqualifier),r}getTopAbsStateEnum(e){let r=t.topAbsStateEnum.unknown;return r=e===this.occ.TopAbs_State.TopAbs_IN?t.topAbsStateEnum.in:e===this.occ.TopAbs_State.TopAbs_OUT?t.topAbsStateEnum.out:e===this.occ.TopAbs_State.TopAbs_ON?t.topAbsStateEnum.on:t.topAbsStateEnum.unknown,r}convertFourSidesStrictEnumToTwoCircleInclusionEnum(e){return e===t.fourSidesStrictEnum.inside?t.twoCircleInclusionEnum.inside:e===t.fourSidesStrictEnum.outside?t.twoCircleInclusionEnum.outside:e===t.fourSidesStrictEnum.insideOutside?t.twoCircleInclusionEnum.insideOutside:e===t.fourSidesStrictEnum.outsideInside?t.twoCircleInclusionEnum.outsideInside:t.twoCircleInclusionEnum.none}}class P{constructor(e){this.occ=e}getActualTypeOfShape(e){let t=e;return t=e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_EDGE?this.occ.TopoDS.Edge_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_WIRE?this.occ.TopoDS.Wire_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX?this.occ.TopoDS.Vertex_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_SOLID?this.occ.TopoDS.Solid_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_SHELL?this.occ.TopoDS.Shell_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_FACE?this.occ.TopoDS.Face_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_COMPSOLID?this.occ.TopoDS.CompSolid_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_COMPOUND?this.occ.TopoDS.Compound_1(e):e,t}combineEdgesAndWiresIntoAWire(e){if(void 0===e.shapes)throw Error("Shapes are not defined");const t=new this.occ.BRepBuilderAPI_MakeWire_1;if(e.shapes.forEach((e=>{e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_EDGE?t.Add_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_WIRE&&t.Add_2(e)})),t.IsDone()){this.occ.BRepLib.BuildCurves3d_1(t.Wire(),1e-7,this.occ.GeomAbs_Shape.GeomAbs_C1,14,0);const e=t.Wire();return t.delete(),e}{let e;const r=t.Error();throw t.delete(),r===this.occ.BRepBuilderAPI_WireError.BRepBuilderAPI_DisconnectedWire?e="Wire is disconnected and can not be constructed":r===this.occ.BRepBuilderAPI_WireError.BRepBuilderAPI_EmptyWire?e="Wire is empty and can not be constructed":r===this.occ.BRepBuilderAPI_WireError.BRepBuilderAPI_NonManifoldWire?e="Wire is non manifold and can not be constructed":r===this.occ.BRepBuilderAPI_WireError.BRepBuilderAPI_WireDone&&(e="Wire is done"),new Error(e)}}vertexToPoint(e){const t=this.occ.BRep_Tool.Pnt(e.shape),r=[t.X(),t.Y(),t.Z()];return t.delete(),r}getGeomCurveFromEdge(e,t,r){const i=e.Location_1();return this.occ.BRep_Tool.Curve_1(e,i,t,r).get()}makeCompound(e){const t=new this.occ.TopoDS_Compound,r=new this.occ.BRep_Builder;return r.MakeCompound(t),e.shapes.forEach((e=>{const i=new this.occ.BRepBuilderAPI_Copy_2(e,!0,!1),s=i.Shape();r.Add(t,s),i.delete(),s.delete()})),r.delete(),t}makeCompoundIfNeeded(e,t){if(t){const t=this.makeCompound({shapes:e});return e.forEach((e=>e.delete())),t}return e}}class A{constructor(e){this.occ=e}createCircle(e,r,i,s){const n=this.gcMakeCircle(r,i,e);if(s===t.typeSpecificityEnum.curve)return n;{const e=this.bRepBuilderAPIMakeEdge(n);if(s===t.typeSpecificityEnum.edge)return e;{const r=this.bRepBuilderAPIMakeWire(e);if(s===t.typeSpecificityEnum.wire)return e.delete(),r;if(s===t.typeSpecificityEnum.face)return this.bRepBuilderAPIMakeFaceFromWire(r,!0)}}return n}createEllipse(e,r,i,s,n){const o=this.gcMakeEllipse(i,s,e,r);if(n===t.typeSpecificityEnum.curve)return o;{const e=this.bRepBuilderAPIMakeEdge(o);if(n===t.typeSpecificityEnum.edge)return e;{const r=this.bRepBuilderAPIMakeWire(e);if(n===t.typeSpecificityEnum.wire)return e.delete(),r;if(n===t.typeSpecificityEnum.face)return this.bRepBuilderAPIMakeFaceFromWire(r,!0)}}return o}makeVertex(e){const t=this.gpPnt(e),r=new this.occ.BRepBuilderAPI_MakeVertex(t),i=r.Vertex();return t.delete(),r.delete(),i}gpPnt2d(e){return new this.occ.gp_Pnt2d_3(e[0],e[1])}gpPnt(e){return new this.occ.gp_Pnt_3(e[0],e[1],e[2])}gpVec(e){return new this.occ.gp_Vec_4(e[0],e[1],e[2])}gpXYZ(e){return new this.occ.gp_XYZ_2(e[0],e[1],e[2])}gpVec2d(e){return new this.occ.gp_Vec2d_4(e[0],e[1])}gpDir(e){return new this.occ.gp_Dir_4(e[0],e[1],e[2])}gpDir2d(e){return new this.occ.gp_Dir2d_4(e[0],e[1])}gcMakeCircle(e,t,r){const i=new this.occ.GC_MakeCircle_2(this.gpAx2(e,t),r),s=i.Value().get();return i.delete(),s}gcMakeEllipse(e,t,r,i){const s=this.gpAx2(e,t),n=new this.occ.GC_MakeEllipse_2(s,i,r);if(n.IsDone()){const e=n.Value().get();return n.delete(),s.delete(),e}throw new Error("Ellipse could not be created.")}bRepBuilderAPIMakeEdge(e){const t=this.castToHandleGeomCurve(e),r=new this.occ.BRepBuilderAPI_MakeEdge_24(t),i=r.Edge();return r.delete(),t.delete(),i}bRepBuilderAPIMakeWire(e){const t=new this.occ.BRepBuilderAPI_MakeWire_2(e),r=t.Wire();return t.delete(),r}bRepBuilderAPIMakeShell(e){const t=this.occ.BRep_Tool.Surface_2(e),r=new this.occ.BRepBuilderAPI_MakeShell_2(t,!1),i=r.Shell();return r.delete(),t.delete(),i}bRepBuilderAPIMakeFaceFromWires(e,t){let r;const i=[];return e.forEach((e=>{if(i.length>0){const t=new this.occ.BRepBuilderAPI_MakeFace_22(i[i.length-1],e);i.push(t.Face()),t.delete()}else{const r=new this.occ.BRepBuilderAPI_MakeFace_15(e,t);i.push(r.Face()),r.delete()}})),i.length>0&&(r=i.pop(),i.forEach((e=>e.delete()))),r}bRepBuilderAPIMakeFaceFromWire(e,t){const r=new this.occ.BRepBuilderAPI_MakeFace_15(e,t),i=r.Face();return r.delete(),i}bRepBuilderAPIMakeFaceFromSurface(e,t){const r=new this.occ.Handle_Geom_Surface_2(e),i=new this.occ.BRepBuilderAPI_MakeFace_8(r,t),s=i.Face();return i.delete(),r.delete(),s}bRepBuilderAPIMakeFaceFromSurfaceAndWire(e,t,r){const i=new this.occ.Handle_Geom_Surface_2(e),s=new this.occ.BRepBuilderAPI_MakeFace_21(i,t,r),n=s.Face();return s.delete(),i.delete(),n}bRepPrimAPIMakeSphere(e,t,r){const i=this.gpAx2(e,t),s=new this.occ.BRepPrimAPI_MakeSphere_9(i,r),n=s.Shape();return s.delete(),i.delete(),n}gpAx3(e,t){return new this.occ.gp_Ax3_4(this.gpPnt(e),this.gpDir(t))}gpAx2(e,t){return new this.occ.gp_Ax2_3(this.gpPnt(e),this.gpDir(t))}gpAx2FromTwoVectors(e,t,r){return new this.occ.gp_Ax2_2(this.gpPnt(e),this.gpDir(t),this.gpDir(r))}gpAx1(e,t){return new this.occ.gp_Ax1_2(this.gpPnt(e),this.gpDir(t))}gpAx2d(e,t){const r=this.gpPnt2d(e),i=this.gpDir2d(t);return new this.occ.gp_Ax2d_2(r,i)}gpAx22d(e,t,r){const i=this.gpPnt2d(e),s=this.gpDir2d(t),n=this.gpDir2d(r),o=new this.occ.gp_Ax22d_2(i,s,n);return s.delete(),n.delete(),i.delete(),o}gpPln(e,t){const r=this.gpPnt(e),i=this.gpDir(t),s=new this.occ.gp_Pln_3(r,i);return r.delete(),i.delete(),s}bRepPrimAPIMakeCylinder(e,t,r,i){const s=this.gpAx2(e,t),n=new this.occ.BRepPrimAPI_MakeCylinder_3(s,r,i),o=n.Shape();return n.delete(),s.delete(),o}bRepPrimAPIMakeCylinderBetweenPoints(e,t,r){const i=this.gpPnt(e),s=this.gpPnt(t),n=new this.occ.gp_Vec_5(i,s),o=n.Magnitude(),a=this.gpAx2(e,[n.X(),n.Y(),n.Z()]),c=new this.occ.BRepPrimAPI_MakeCylinder_3(a,r,o),h=c.Shape();return c.delete(),a.delete(),i.delete(),s.delete(),n.delete(),h}bRepPrimAPIMakeBox(e,t,r,i){const s=this.gpPnt([-e/2+i[0],-r/2+i[1],-t/2+i[2]]),n=new this.occ.BRepPrimAPI_MakeBox_3(s,e,r,t),o=n.Shape();return n.delete(),s.delete(),o}castToHandleGeomCurve(e){return new this.occ.Handle_Geom_Curve_2(e)}}class T{constructor(e,t,r,i,s,n,o,a,c,h,d,l){this.occ=e,this.enumService=t,this.entitiesService=r,this.converterService=i,this.booleansService=s,this.shapeGettersService=n,this.edgesService=o,this.transformsService=a,this.vecHelper=c,this.wiresService=h,this.facesService=d,this.shellsService=l}loftAdvanced(e){if(e.periodic&&!e.closed)throw new Error("Cant construct periodic non closed loft.");const r=new this.occ.BRepOffsetAPI_ThruSections(e.makeSolid,e.straight,e.tolerance),i=[],s=[];if(e.startVertex){const t=this.entitiesService.makeVertex(e.startVertex);r.AddVertex(t),s.push(t)}if(e.closed&&!e.periodic)e.shapes.push(e.shapes[0]);else if(e.closed&&e.periodic){const s=[];e.shapes.forEach((r=>{this.enumService.getShapeTypeEnum(r)===t.shapeTypeEnum.edge&&(r=this.entitiesService.bRepBuilderAPIMakeWire(r));const i=this.wiresService.divideWireByParamsToPoints({shape:r,nrOfDivisions:e.nrPeriodicSections,removeStartPoint:!1,removeEndPoint:!1});s.push(i)}));for(let t=0;t<=e.nrPeriodicSections;t++){const n=s.map((e=>e[t])),o=this.wiresService.interpolatePoints({points:n,tolerance:e.tolerance,periodic:!0});r.AddWire(o),i.push(o)}}e.periodic||e.shapes.forEach((e=>{r.AddWire(e)}));const n=[];if(e.endVertex){const t=this.entitiesService.makeVertex(e.endVertex);r.AddVertex(t),n.push(t)}let o;e.useSmoothing&&r.SetSmoothing(e.useSmoothing),e.maxUDegree&&r.SetMaxDegree(e.maxUDegree),e.parType===t.approxParametrizationTypeEnum.approxChordLength?o=this.occ.Approx_ParametrizationType.Approx_ChordLength:e.parType===t.approxParametrizationTypeEnum.approxCentripetal?o=this.occ.Approx_ParametrizationType.Approx_Centripetal:e.parType===t.approxParametrizationTypeEnum.approxIsoParametric&&(o=this.occ.Approx_ParametrizationType.Approx_IsoParametric),o&&r.SetParType(o),r.CheckCompatibility(!1);const a=r.Shape(),c=this.converterService.getActualTypeOfShape(a);return a.delete(),r.delete(),i.forEach((e=>e.delete())),s.forEach((e=>e.delete())),n.forEach((e=>e.delete())),c}closestPointsBetweenTwoShapes(e,t){const r=new this.occ.Message_ProgressRange_1,i=new this.occ.BRepExtrema_DistShapeShape_2(e,t,this.occ.Extrema_ExtFlag.Extrema_ExtFlag_MIN,this.occ.Extrema_ExtAlgo.Extrema_ExtAlgo_Grad,r),s=new this.occ.Message_ProgressRange_1;if(i.Perform(s),i.IsDone()&&i.NbSolution()>0){const e=i.PointOnShape1(1),t=i.PointOnShape2(1);return[[e.X(),e.Y(),e.Z()],[t.X(),t.Y(),t.Z()]]}throw new Error("Closest points could not be found.")}closestPointsOnShapeFromPoints(e){return e.points.map((e=>this.entitiesService.makeVertex(e))).map((t=>this.closestPointsBetweenTwoShapes(t,e.shape))).map((e=>e[1]))}closestPointsOnShapesFromPoints(e){const t=e.points.map((e=>this.entitiesService.makeVertex(e))),r=[];return e.shapes.forEach((e=>{const i=t.map((t=>this.closestPointsBetweenTwoShapes(t,e)));r.push(...i.map((e=>e[1])))})),r}distancesToShapeFromPoints(e){return e.points.map((e=>this.entitiesService.makeVertex(e))).map((t=>this.closestPointsBetweenTwoShapes(t,e.shape))).map((e=>this.vecHelper.distanceBetweenPoints(e[0],e[1])))}loft(e){const r=new this.occ.BRepOffsetAPI_ThruSections(e.makeSolid,!1,1e-6);e.shapes.forEach((e=>{this.enumService.getShapeTypeEnum(e)===t.shapeTypeEnum.edge&&(e=this.entitiesService.bRepBuilderAPIMakeWire(e)),r.AddWire(e)})),r.CheckCompatibility(!1);const i=r.Shape(),s=this.converterService.getActualTypeOfShape(i);return i.delete(),r.delete(),s}offset(e){return this.offsetAdv({shape:e.shape,face:e.face,distance:e.distance,tolerance:e.tolerance,joinType:t.joinTypeEnum.arc,removeIntEdges:!1})}offsetAdv(e){if(e.tolerance||(e.tolerance=.1),0===e.distance)return e.shape;let r;const i=this.getJoinType(e.joinType),s=this.occ.BRepOffset_Mode.BRepOffset_Skin,n=[];if(this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.wire||this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.edge){let o;this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.edge?(o=this.entitiesService.bRepBuilderAPIMakeWire(e.shape),n.push(o)):o=e.shape;try{r=new this.occ.BRepOffsetAPI_MakeOffset_1,e.face?r.Init_1(e.face,i,!1):r.Init_2(i,!1),r.AddWire(o);const t=new this.occ.Message_ProgressRange_1;r.Build(t),r.Perform(e.distance,0)}catch(t){r=new this.occ.BRepOffsetAPI_MakeOffsetShape,r.PerformByJoin(o,e.distance,e.tolerance,s,!1,!1,i,e.removeIntEdges,new this.occ.Message_ProgressRange_1)}}else{const t=e.shape;r=new this.occ.BRepOffsetAPI_MakeOffsetShape,r.PerformByJoin(t,e.distance,e.tolerance,s,!1,!1,i,e.removeIntEdges,new this.occ.Message_ProgressRange_1)}const o=r.Shape(),a=this.converterService.getActualTypeOfShape(o);return o.delete(),r&&r.delete(),n.forEach((e=>e.delete())),a}offset3DWire(e){const t=this.extrude({shape:e.shape,direction:e.direction}),r=this.makeThickSolidSimple({shape:t,offset:e.offset}),i=this.shapeGettersService.getEdges({shape:e.shape}).length,s=(4*i+2)/2-1,n=s-i+1,o=[];let a;this.shapeGettersService.getFaces({shape:r}).forEach(((e,t)=>{if(t>=n&&t<=s){const t=this.shapeGettersService.getEdges({shape:e})[2];o.push(t)}}));try{a=this.converterService.combineEdgesAndWiresIntoAWire({shapes:o}),a=a.Reversed(),a=this.converterService.getActualTypeOfShape(a)}catch(e){return a=o,a}return a}extrudeShapes(e){return e.shapes.map((t=>{const r=this.extrude({shape:t,direction:e.direction}),i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}))}extrude(e){const t=new this.occ.gp_Vec_4(e.direction[0],e.direction[1],e.direction[2]),r=new this.occ.BRepPrimAPI_MakePrism_1(e.shape,t,!1,!0),i=r.Shape();return r.delete(),t.delete(),i}splitShapeWithShapes(e){const t=new this.occ.TopTools_ListOfShape_1;return e.shapes.forEach((e=>{t.Append_1(e)})),this.occ.BitByBitDev.BitSplit(e.shape,t)}revolve(e){let t;if(e.angle||(e.angle=360),e.direction||(e.direction=[0,0,1]),e.angle>=360){const r=new this.occ.gp_Pnt_3(0,0,0),i=new this.occ.gp_Dir_4(e.direction[0],e.direction[1],e.direction[2]),s=new this.occ.gp_Ax1_2(r,i),n=new this.occ.BRepPrimAPI_MakeRevol_2(e.shape,s,e.copy);t=n.Shape(),n.delete(),r.delete(),i.delete(),s.delete()}else{const r=new this.occ.gp_Pnt_3(0,0,0),i=new this.occ.gp_Dir_4(e.direction[0],e.direction[1],e.direction[2]),s=new this.occ.gp_Ax1_2(r,i),n=new this.occ.BRepPrimAPI_MakeRevol_1(e.shape,s,.0174533*e.angle,e.copy);t=n.Shape(),n.delete(),r.delete(),i.delete(),s.delete()}const r=this.converterService.getActualTypeOfShape(t);return t.delete(),r}rotatedExtrude(e){const t=this.transformsService.translate({translation:[0,e.height,0],shape:e.shape}),r=this.transformsService.rotate({axis:[0,1,0],angle:e.angle,shape:t}),i=this.wiresService.createBSpline({points:[[0,0,0],[0,e.height,0]],closed:!1}),s=[];for(let t=0;t<=30;t++){const r=t/30;s.push([20*Math.sin(r*e.angle*.0174533),e.height*r,20*Math.cos(r*e.angle*.0174533)])}const n=this.wiresService.createBSpline({points:s,closed:!1}),o=new this.occ.BRepOffsetAPI_MakePipeShell(i);o.SetMode_5(n,!0,this.occ.BRepFill_TypeOfContact.BRepFill_NoContact),o.Add_1(e.shape,!1,!1),o.Add_1(r,!1,!1),o.Build(new this.occ.Message_ProgressRange_1),o.MakeSolid();const a=o.Shape(),c=this.converterService.getActualTypeOfShape(a);return a.delete(),o.delete(),n.delete(),i.delete(),r.delete(),t.delete(),c}pipe(e){const t=new this.occ.BRepOffsetAPI_MakePipeShell(e.shape);e.shapes.forEach((e=>{t.Add_1(e,!1,!1)})),t.Build(new this.occ.Message_ProgressRange_1),t.MakeSolid();const r=t.Shape(),i=this.converterService.getActualTypeOfShape(r);return r.delete(),t.delete(),i}pipePolylineWireNGon(e){const t=e.shape,r=[],i=this.shapeGettersService.getEdges({shape:t});i.forEach(((t,s)=>{const n=this.edgesService.startPointOnEdge({shape:t}),o=this.edgesService.tangentOnEdgeAtParam({shape:t,param:0});let a,c=o;if(s>0&&s<i.length-1){const e=i[s-1];a=this.edgesService.tangentOnEdgeAtParam({shape:e,param:1}),c=[o[0]+a[0]/2,o[1]+a[1]/2,o[2]+a[2]/2]}const h=this.wiresService.createNGonWire({radius:e.radius,center:n,direction:c,nrCorners:e.nrCorners});if(r.push(h),s===i.length-1){const i=this.edgesService.endPointOnEdge({shape:t}),s=this.edgesService.tangentOnEdgeAtParam({shape:t,param:1}),n=this.wiresService.createNGonWire({radius:e.radius,center:i,direction:s,nrCorners:e.nrCorners});r.push(n)}}));const s=new this.occ.BRepOffsetAPI_MakePipeShell(t);r.forEach((e=>{s.Add_1(e,!1,!1)})),s.Build(new this.occ.Message_ProgressRange_1),s.MakeSolid();const n=s.Shape(),o=this.converterService.getActualTypeOfShape(n);return n.delete(),s.delete(),o}pipeWireCylindrical(e){const r=e.shape,i=[],s=this.shapeGettersService.getEdges({shape:r});s.forEach(((r,n)=>{const o=this.edgesService.startPointOnEdge({shape:r}),a=this.edgesService.tangentOnEdgeAtParam({shape:r,param:0});let c,h=a;if(n>0&&n<s.length-1){const e=s[n-1];c=this.edgesService.tangentOnEdgeAtParam({shape:e,param:1}),h=[a[0]+c[0]/2,a[1]+c[1]/2,a[2]+c[2]/2]}const d=this.entitiesService.createCircle(e.radius,o,h,t.typeSpecificityEnum.wire);if(i.push(d),n===s.length-1){const s=this.edgesService.endPointOnEdge({shape:r}),n=this.edgesService.tangentOnEdgeAtParam({shape:r,param:1}),o=this.entitiesService.createCircle(e.radius,s,n,t.typeSpecificityEnum.wire);i.push(o)}}));const n=new this.occ.BRepOffsetAPI_MakePipeShell(r);i.forEach((e=>{n.Add_1(e,!1,!1)})),n.Build(new this.occ.Message_ProgressRange_1),n.MakeSolid();const o=n.Shape(),a=this.converterService.getActualTypeOfShape(o);return o.delete(),n.delete(),a}pipeWiresCylindrical(e){return e.shapes.map((t=>this.pipeWireCylindrical({shape:t,radius:e.radius})))}makeThickSolidSimple(e){const t=new this.occ.BRepOffsetAPI_MakeThickSolid;t.MakeThickSolidBySimple(e.shape,e.offset),t.Build(new this.occ.Message_ProgressRange_1);const r=t.Shape(),i=this.converterService.getActualTypeOfShape(r);let s=i;if(e.offset>0){const e=this.shapeGettersService.getFaces({shape:i}).map((e=>e.Reversed()));s=this.shellsService.sewFaces({shapes:e,tolerance:1e-7}),i.delete()}return t.delete(),r.delete(),s}makeThickSolidByJoin(e){const t=new this.occ.TopTools_ListOfShape_1;e.shapes.forEach((e=>{t.Append_1(e)}));const r=new this.occ.BRepOffsetAPI_MakeThickSolid,i=this.getJoinType(e.joinType);r.MakeThickSolidByJoin(e.shape,t,e.offset,e.tolerance,this.occ.BRepOffset_Mode.BRepOffset_Skin,e.intersection,e.selfIntersection,i,e.removeIntEdges,new this.occ.Message_ProgressRange_1);const s=r.Shape(),n=this.converterService.getActualTypeOfShape(s);return s.delete(),r.delete(),t.delete(),n}getJoinType(e){let r;switch(e){case t.joinTypeEnum.arc:r=this.occ.GeomAbs_JoinType.GeomAbs_Arc;break;case t.joinTypeEnum.intersection:r=this.occ.GeomAbs_JoinType.GeomAbs_Intersection;break;case t.joinTypeEnum.tangent:r=this.occ.GeomAbs_JoinType.GeomAbs_Tangent}return r}getBRepOffsetMode(e){let r;switch(e){case t.bRepOffsetModeEnum.skin:r=this.occ.BRepOffset_Mode.BRepOffset_Skin;break;case t.bRepOffsetModeEnum.pipe:r=this.occ.BRepOffset_Mode.BRepOffset_Pipe;break;case t.bRepOffsetModeEnum.rectoVerso:r=this.occ.BRepOffset_Mode.BRepOffset_RectoVerso}return r}slice(e){if(e.step<=0)throw new Error("Step needs to be positive.");const{bbox:t,transformedShape:r}=this.createBBoxAndTransformShape(e.shape,e.direction),i=[];if(!t.IsThin(1e-4)){const{minY:s,maxY:n,maxDist:o}=this.computeBounds(t),a=[];for(let t=s;t<n;t+=e.step){const e=this.facesService.createSquareFace({size:o,center:[0,t,0],direction:[0,1,0]});a.push(e)}this.applySlices(r,a,e.direction,i)}return this.converterService.makeCompound({shapes:i})}sliceInStepPattern(e){if(!e.steps||0===e.steps.length)throw new Error("Steps must be provided with at elast one positive value");const{bbox:t,transformedShape:r}=this.createBBoxAndTransformShape(e.shape,e.direction),i=[];if(!t.IsThin(1e-4)){const{minY:s,maxY:n,maxDist:o}=this.computeBounds(t),a=[];let c=0;for(let t=s;t<n;t+=e.steps[c]){const r=this.facesService.createSquareFace({size:o,center:[0,t,0],direction:[0,1,0]});a.push(r),void 0===e.steps[c+1]?c=0:c++}this.applySlices(r,a,e.direction,i)}return this.converterService.makeCompound({shapes:i})}createBBoxAndTransformShape(e,t){const r=this.transformsService.align({shape:e,fromOrigin:[0,0,0],fromDirection:t,toOrigin:[0,0,0],toDirection:[0,1,0]}),i=new this.occ.Bnd_Box_1;return this.occ.BRepBndLib.Add(r,i,!1),{bbox:i,transformedShape:r}}computeBounds(e){const t=e.CornerMin(),r=e.CornerMax(),i=t.Y(),s=r.Y(),n=t.X(),o=r.X(),a=t.Z(),c=o-n,h=r.Z()-a;let d=c>=h?c:h;return d*=1.2,{minY:i,maxY:s,maxDist:d}}applySlices(e,r,i,s){const n=[];if(this.enumService.getShapeTypeEnum(e)===t.shapeTypeEnum.solid)n.push(e);else{const t=this.shapeGettersService.getSolids({shape:e});n.push(...t)}if(0===n.length)throw new Error("No solids found to slice.");n.forEach((e=>{const n=new t.IntersectionDto;n.keepEdges=!0,n.shapes=[e];const o=this.converterService.makeCompound({shapes:r});n.shapes.push(o),this.booleansService.intersection(n).forEach((e=>{if(e&&!e.IsNull()){const t=this.transformsService.align({shape:e,fromOrigin:[0,0,0],fromDirection:[0,1,0],toOrigin:[0,0,0],toDirection:i});s.push(t)}}))}))}}class b{constructor(e,t,r,i){this.occ=e,this.converterService=t,this.entitiesService=r,this.vecHelper=i}alignAndTranslate(e){const t=this.align({shape:e.shape,fromOrigin:[0,0,0],fromDirection:[0,1,0],toOrigin:[0,0,0],toDirection:e.direction}),r=this.translate({shape:t,translation:e.center});return t.delete(),r}translate(e){const t=new this.occ.gp_Trsf_1,r=new this.occ.gp_Vec_4(e.translation[0],e.translation[1],e.translation[2]);t.SetTranslation_1(r);const i=new this.occ.BRepBuilderAPI_Transform_2(e.shape,t,!0),s=i.Shape(),n=this.converterService.getActualTypeOfShape(s);return s.delete(),t.delete(),i.delete(),r.delete(),n}mirror(e){const t=new this.occ.gp_Trsf_1,r=this.entitiesService.gpAx1(e.origin,e.direction);t.SetMirror_2(r);const i=new this.occ.BRepBuilderAPI_Transform_2(e.shape,t,!0),s=i.Shape(),n=this.converterService.getActualTypeOfShape(s);return s.delete(),i.delete(),t.delete(),r.delete(),n}mirrorAlongNormal(e){const t=new this.occ.gp_Trsf_1,r=this.entitiesService.gpAx2(e.origin,e.normal);t.SetMirror_3(r);const i=new this.occ.BRepBuilderAPI_Transform_2(e.shape,t,!0),s=i.Shape(),n=this.converterService.getActualTypeOfShape(s);return r.delete(),s.delete(),i.delete(),t.delete(),n}rotate(e){let t;if(0!==e.angle){const t=new this.occ.gp_Trsf_1,r=new this.occ.gp_Vec_4(e.axis[0],e.axis[1],e.axis[2]),i=new this.occ.gp_Dir_4(e.axis[0],e.axis[1],e.axis[2]),s=new this.occ.gp_Pnt_3(0,0,0),n=new this.occ.gp_Ax1_2(s,i);t.SetRotation_1(n,this.vecHelper.degToRad(e.angle));const o=new this.occ.BRepBuilderAPI_Transform_2(e.shape,t,!0),a=o.Shape(),c=this.converterService.getActualTypeOfShape(a);return a.delete(),r.delete(),i.delete(),s.delete(),n.delete(),o.delete(),t.delete(),c}t=e.shape;const r=this.converterService.getActualTypeOfShape(t);return 0!==e.angle&&t.delete(),r}align(e){const t=new this.occ.gp_Trsf_1,r=this.entitiesService.gpAx3(e.fromOrigin,e.fromDirection),i=this.entitiesService.gpAx3(e.toOrigin,e.toDirection);t.SetDisplacement(r,i);const s=new this.occ.TopLoc_Location_2(t),n=e.shape.Moved(s,!1);t.delete(),r.delete(),i.delete();const o=this.converterService.getActualTypeOfShape(n);return n.delete(),o}}class C{constructor(e,t){this.occ=e,this.shapeGettersService=t}intersection(e){if(e.shapes.length<2)throw new Error("Intersection requires 2 or more shapes to be given");const t=e.shapes[0];let r=[];for(let i=1;i<e.shapes.length;i++){let s;const n=new this.occ.Message_ProgressRange_1,o=new this.occ.BRepAlgoAPI_Common_3(t,e.shapes[i],n),a=new this.occ.Message_ProgressRange_1;o.HasGenerated()&&(o.Build(a),s=o.Shape(),r.push(s)),n.delete(),o.delete(),a.delete()}return!e.keepEdges&&r.length>0&&(r=r.map((e=>{const t=new this.occ.ShapeUpgrade_UnifySameDomain_2(e,!0,!0,!1);t.Build();const r=t.Shape();return t.delete(),r}))),r}difference(e){let t=e.shape;const r=e.shapes;for(let e=0;e<r.length;e++){r[e]&&!r[e].IsNull()||console.error("Tool in Difference is null!");const i=new this.occ.Message_ProgressRange_1,s=new this.occ.BRepAlgoAPI_Cut_3(t,r[e],i),n=new this.occ.Message_ProgressRange_1;s.Build(n),t=s.Shape(),i.delete(),n.delete(),s.delete()}if(!e.keepEdges){const e=new this.occ.ShapeUpgrade_UnifySameDomain_2(t,!0,!0,!1);e.Build();const r=e.Shape();t.delete(),t=r,e.delete()}if(1===this.shapeGettersService.getNumSolidsInCompound(t)){const e=this.shapeGettersService.getSolidFromCompound(t,0);t.delete(),t=e}return t}union(e){let t=e.shapes[0];for(let r=0;r<e.shapes.length;r++){const i=new this.occ.Message_ProgressRange_1,s=new this.occ.BRepAlgoAPI_Fuse_3(t,e.shapes[r],i),n=new this.occ.Message_ProgressRange_1;s.Build(n),t=s.Shape(),i.delete(),n.delete(),s.delete()}if(!e.keepEdges){const e=new this.occ.ShapeUpgrade_UnifySameDomain_2(t,!0,!0,!1);e.Build(),t=e.Shape(),e.delete()}return t}}class D{constructor(e,t,r){this.occ=e,this.enumService=t,this.iteratorService=r}getNumSolidsInCompound(e){if(!e||this.enumService.getShapeTypeEnum(e)!==t.shapeTypeEnum.compound||e.IsNull())throw new Error("Shape is not a compound or is null.");let r=0;return this.iteratorService.forEachSolid(e,(()=>{r++})),r}getSolidFromCompound(e,t){if(!e||e.ShapeType()>this.occ.TopAbs_ShapeEnum.TopAbs_COMPSOLID||e.IsNull())return console.error("Not a compound shape!"),e;t||(t=0);let r=e,i=0;return this.iteratorService.forEachSolid(e,((e,s)=>{e===t&&(r=this.occ.TopoDS.Solid_1(s)),i++})),0===i&&console.error("NO SOLIDS FOUND IN SHAPE!"),r.hash=e.hash+1,r}getEdges(e){if(e.shape&&this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.edge)return[e.shape];if(!e.shape||e.shape.IsNull())throw new Error("Shape is not provided or is of incorrect type");const r=[];return this.iteratorService.forEachEdge(e.shape,((e,t)=>{r.push(t)})),r}getEdge(e){if(!e.shape||e.shape.ShapeType&&e.shape.ShapeType()>this.occ.TopAbs_ShapeEnum.TopAbs_WIRE||e.shape.IsNull())throw new Error("Edge can not be found for shape that is not provided or is of incorrect type");e.index||(e.index=0);let t={},r=!1;if(this.iteratorService.forEachEdge(e.shape,((i,s)=>{i===e.index&&(t=s,r=!0)})),r)return t;throw new Error(`Edge can not be found for shape on index ${e.index}`)}getWires(e){const t=[];return this.iteratorService.forEachWire(e.shape,((e,r)=>{t.push(r)})),t}getWire(e){if(!e.shape||e.shape.IsNull())throw new Error("Shape is not provided or is null");const r=this.enumService.getShapeTypeEnum(e.shape);if(r===t.shapeTypeEnum.wire||r===t.shapeTypeEnum.edge||r===t.shapeTypeEnum.vertex)throw new Error("Shape is of incorrect type");let i;if(e.index||(e.index=0),this.iteratorService.forEachWire(e.shape,((t,r)=>{t===e.index&&(i=this.occ.TopoDS.Wire_1(r))})),!i)throw Error("Wire not found");return i}getFaces(e){const t=[];return this.iteratorService.forEachFace(e.shape,((e,r)=>{t.push(r)})),t}getSolids(e){const t=[];return this.iteratorService.forEachSolid(e.shape,((e,r)=>{t.push(r)})),t}getFace(e){if(!e.shape||e.shape.IsNull())throw new Error("Shape is not provided or is null");const r=this.enumService.getShapeTypeEnum(e.shape);if(r===t.shapeTypeEnum.wire||r===t.shapeTypeEnum.edge||r===t.shapeTypeEnum.vertex)throw new Error("Shape is of incorrect type");e.index||(e.index=0);let i={},s=0;if(this.iteratorService.forEachFace(e.shape,((t,r)=>{t===e.index&&(i=this.occ.TopoDS.Face_1(r)),s++})),s<e.index||e.index<0)throw new Error("Face index is out of range");return i}getVertices(e){if(e.shape&&this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.vertex)return[e.shape];if(!e.shape||e.shape.IsNull())throw new Error("Shape is not provided or is of incorrect type");const r=[];return this.iteratorService.forEachVertex(e.shape,((e,t)=>{r.push(t)})),r}}class k{constructor(e,t,r,i,s,n,o,a,c,h){this.occ=e,this.occRefReturns=t,this.shapeGettersService=r,this.entitiesService=i,this.iteratorService=s,this.converterService=n,this.enumService=o,this.geomService=a,this.transformsService=c,this.vecHelper=h}getCornerPointsOfEdgesForShape(e){const t=this.shapeGettersService.getEdges(e);let r=[];return t.forEach((e=>{const t={current:0},i={current:0},s=this.occRefReturns.BRep_Tool_Curve_2(e,t,i);try{const e=s.get();if(e){const s=e.Value(t.current),n=e.Value(i.current),o=[s.X(),s.Y(),s.Z()],a=[n.X(),n.Y(),n.Z()];s.delete(),n.delete(),r.push(o),r.push(a)}}catch(e){console.log(e)}})),r.length>0&&(r=this.vecHelper.removeAllDuplicateVectors(r)),r}getCircularEdgesAlongWire(e){return this.getEdgesAlongWire(e).filter((e=>this.isEdgeCircular({shape:e})))}getLinearEdgesAlongWire(e){return this.getEdgesAlongWire(e).filter((e=>this.isEdgeLinear({shape:e})))}getEdgesAlongWire(e){if(e.shape&&this.enumService.getShapeTypeEnum(e.shape)===t.shapeTypeEnum.edge)return[e.shape];if(!e.shape||e.shape.IsNull())throw new Error("Shape is not provided or is of incorrect type");const r=[],i=this.fixEdgeOrientationsAlongWire(e);return this.iteratorService.forEachEdgeAlongWire(i,((e,t)=>{r.push(t)})),r}fixEdgeOrientationsAlongWire(e){const t=[];return this.iteratorService.forEachEdgeAlongWire(e.shape,((e,r)=>{t.push(r)})),this.converterService.combineEdgesAndWiresIntoAWire({shapes:t})}arcThroughThreePoints(e){const t=this.entitiesService.gpPnt(e.start),r=this.entitiesService.gpPnt(e.middle),i=this.entitiesService.gpPnt(e.end),s=new this.occ.GC_MakeArcOfCircle_4(t,r,i),n=new this.occ.Handle_Geom_Curve_2(s.Value().get()),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return t.delete(),r.delete(),i.delete(),s.delete(),n.delete(),o.delete(),a}arcThroughTwoPointsAndTangent(e){const t=this.entitiesService.gpPnt(e.start),r=this.entitiesService.gpVec(e.tangentVec),i=this.entitiesService.gpPnt(e.end),s=new this.occ.GC_MakeArcOfCircle_5(t,r,i),n=new this.occ.Handle_Geom_Curve_2(s.Value().get()),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return t.delete(),r.delete(),i.delete(),s.delete(),n.delete(),o.delete(),a}arcFromCircleAndTwoAngles(e){const t=this.getGpCircleFromEdge({shape:e.circle}),r=this.vecHelper.degToRad(e.alphaAngle1),i=this.vecHelper.degToRad(e.alphaAngle2),s=new this.occ.GC_MakeArcOfCircle_1(t,r,i,e.sense),n=new this.occ.Handle_Geom_Curve_2(s.Value().get()),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return t.delete(),s.delete(),n.delete(),o.delete(),a}arcFromCirclePointAndAngle(e){const t=this.getGpCircleFromEdge({shape:e.circle}),r=this.vecHelper.degToRad(e.alphaAngle),i=this.entitiesService.gpPnt(e.point),s=new this.occ.GC_MakeArcOfCircle_2(t,i,r,e.sense),n=new this.occ.Handle_Geom_Curve_2(s.Value().get()),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return t.delete(),s.delete(),i.delete(),n.delete(),o.delete(),a}lineEdge(e){const t=this.entitiesService.gpPnt(e.start),r=this.entitiesService.gpPnt(e.end),i=new this.occ.GC_MakeSegment_1(t,r).Value(),s=i.get(),n=new this.occ.Handle_Geom_Curve_2(s),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return o.delete(),n.delete(),t.delete(),r.delete(),i.delete(),s.delete(),a}getEdgeLength(e){const t=e.shape,r=new this.occ.GProp_GProps_1;this.occ.BRepGProp.LinearProperties(t,r,!1,!1);const i=r.Mass();return r.delete(),i}getEdgesLengths(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getEdgeLength({shape:e})))}getEdgesCentersOfMass(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.geomService.getLinearCenterOfMass({shape:e})))}edgesToPoints(e){const r=this.enumService.getShapeTypeEnum(e.shape);let i=[];i=r===t.shapeTypeEnum.edge?[e.shape]:r===t.shapeTypeEnum.wire?this.getEdgesAlongWire({shape:e.shape}):this.shapeGettersService.getEdges({shape:e.shape});const s=[],n=i.map((e=>this.startPointOnEdge({shape:e})));return i.forEach((t=>{const r=[],i=new this.occ.TopLoc_Location_1,n=new this.occ.BRepAdaptor_Curve_2(t),o=new this.occ.GCPnts_TangentialDeflection_2(n,e.angularDeflection,e.curvatureDeflection,e.minimumOfPoints,e.uTolerance,e.minimumLength),a=o.NbPoints(),c=[];for(let e=0;e<a;e++){const t=o.Value(e+1);r.push([t.X(),t.Y(),t.Z()]),c.push(t)}s.push(r),c.forEach((e=>e.delete())),i.delete(),n.delete(),o.delete()})),s.forEach(((e,t)=>{const r=this.vecHelper.distanceBetweenPoints(e[0],n[t]);this.vecHelper.distanceBetweenPoints(n[t],e[e.length-1])<r&&e.reverse()})),s}startPointOnEdge(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.pointOnCurveAtParam({shape:i,param:0});return i.delete(),s}endPointOnEdge(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.pointOnCurveAtParam({shape:i,param:1});return i.delete(),s}makeEdgeFromGeom2dCurveAndSurfaceBounded(e,t,r){const i=new this.occ.Handle_Geom2d_Curve_2(e.curve),s=new this.occ.Handle_Geom_Surface_2(e.surface),n=new this.occ.BRepBuilderAPI_MakeEdge_31(i,s,t,r),o=n.Shape(),a=this.converterService.getActualTypeOfShape(o);return o.delete(),n.delete(),a}makeEdgeFromGeom2dCurveAndSurface(e){const t=new this.occ.Handle_Geom2d_Curve_2(e.curve),r=new this.occ.Handle_Geom_Surface_2(e.surface),i=new this.occ.BRepBuilderAPI_MakeEdge_30(t,r),s=i.Shape(),n=this.converterService.getActualTypeOfShape(s);return s.delete(),i.delete(),n}constraintTanLinesFromTwoPtsToCircle(e){const r=this.getCircularEdgePlaneDirection({shape:e.circle}),i=this.getCircularEdgeCenterPoint({shape:e.circle}),s=new t.AlignDto;s.fromDirection=r,s.toDirection=[0,0,1],s.fromOrigin=i,s.toOrigin=[0,0,0],s.shape=e.circle;const n=this.transformsService.align(s),o=this.entitiesService.makeVertex(e.point1);s.shape=o;const a=this.transformsService.align(s);o.delete();const c=this.converterService.vertexToPoint({shape:a});a.delete();const h=this.entitiesService.gpPnt2d([c[0],c[1]]),d=this.entitiesService.makeVertex(e.point2);s.shape=d;const l=this.transformsService.align(s);d.delete();const u=this.converterService.vertexToPoint({shape:l});l.delete();const p=this.entitiesService.gpPnt2d([u[0],u[1]]),f=this.getGpCircle2dFromEdge({shape:n});n.delete();const v=new this.occ.GccEnt_QualifiedCirc(f,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified));f.delete();const g=new this.occ.GccAna_Lin2d2Tan_2(v,h,e.tolerance),m=new this.occ.GccAna_Lin2d2Tan_2(v,p,e.tolerance);v.delete();const S=[];for(let e=1;e<=g.NbSolutions();e++){const t=g.ThisSolution(e),n=t.Location(),o=this.lineEdge({start:[n.X(),n.Y(),0],end:c});s.fromDirection=[0,0,1],s.toDirection=r,s.fromOrigin=[0,0,0],s.toOrigin=i,s.shape=o;const a=this.transformsService.align(s);S.push(a),t.delete(),n.delete(),o.delete()}g.delete();const E=[];for(let e=1;e<=m.NbSolutions();e++){const t=m.ThisSolution(e),n=t.Location(),o=this.lineEdge({start:[n.X(),n.Y(),0],end:u});s.fromDirection=[0,0,1],s.toDirection=r,s.fromOrigin=[0,0,0],s.toOrigin=i,s.shape=o;const a=this.transformsService.align(s);E.push(a),t.delete(),n.delete(),o.delete()}m.delete();let w=[];if(w=e.positionResult===t.positionResultEnum.all?[...S,...E]:e.positionResult===t.positionResultEnum.keepSide1?[S[1],E[0]]:e.positionResult===t.positionResultEnum.keepSide2?[S[0],E[1]]:[...S,...E],2===w.length&&e.circleRemainder!==t.circleInclusionEnum.none){let r,i;e.positionResult===t.positionResultEnum.keepSide2?e.circleRemainder===t.circleInclusionEnum.keepSide1?(r=this.startPointOnEdge({shape:w[1]}),i=this.startPointOnEdge({shape:w[0]})):e.circleRemainder===t.circleInclusionEnum.keepSide2&&(r=this.startPointOnEdge({shape:w[0]}),i=this.startPointOnEdge({shape:w[1]})):e.positionResult===t.positionResultEnum.keepSide1&&(e.circleRemainder===t.circleInclusionEnum.keepSide1?(r=this.startPointOnEdge({shape:w[0]}),i=this.startPointOnEdge({shape:w[1]})):e.circleRemainder===t.circleInclusionEnum.keepSide2&&(r=this.startPointOnEdge({shape:w[1]}),i=this.startPointOnEdge({shape:w[0]})));const s=this.arcFromCircleAndTwoPoints({circle:e.circle,start:r,end:i,sense:!0});w.splice(1,0,s)}return w}constraintTanLinesFromPtToCircle(e){const r=this.getCircularEdgePlaneDirection({shape:e.circle}),i=this.getCircularEdgeCenterPoint({shape:e.circle}),s=new t.AlignDto;s.fromDirection=r,s.toDirection=[0,0,1],s.fromOrigin=i,s.toOrigin=[0,0,0],s.shape=e.circle;const n=this.transformsService.align(s),o=this.entitiesService.makeVertex(e.point);s.shape=o;const a=this.transformsService.align(s);o.delete();const c=this.converterService.vertexToPoint({shape:a});a.delete();const h=this.entitiesService.gpPnt2d([c[0],c[1]]),d=this.getGpCircle2dFromEdge({shape:n});n.delete();const l=new this.occ.GccEnt_QualifiedCirc(d,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified));d.delete();const u=new this.occ.GccAna_Lin2d2Tan_2(l,h,e.tolerance);l.delete();const p=[];for(let e=1;e<=u.NbSolutions();e++){const t=u.ThisSolution(e),n=t.Location(),o=this.lineEdge({start:[n.X(),n.Y(),0],end:c});s.fromDirection=[0,0,1],s.toDirection=r,s.fromOrigin=[0,0,0],s.toOrigin=i,s.shape=o;const a=this.transformsService.align(s);p.push(a),t.delete(),n.delete(),o.delete()}u.delete();let f=[];if(f=e.positionResult===t.positionResultEnum.all?[...p]:e.positionResult===t.positionResultEnum.keepSide1?[p[0]]:e.positionResult===t.positionResultEnum.keepSide2?[p[1]]:[...p],2===f.length&&e.circleRemainder!==t.circleInclusionEnum.none){let r,i;e.circleRemainder===t.circleInclusionEnum.keepSide1?(r=this.startPointOnEdge({shape:f[1]}),i=this.startPointOnEdge({shape:f[0]})):e.circleRemainder===t.circleInclusionEnum.keepSide2&&(r=this.startPointOnEdge({shape:f[0]}),i=this.startPointOnEdge({shape:f[1]}));const s=this.arcFromCircleAndTwoPoints({circle:e.circle,start:r,end:i,sense:!0});f.splice(1,0,s)}return f}constraintTanLinesOnTwoCircles(e){const r=this.getCircularEdgePlaneDirection({shape:e.circle1}),i=this.getCircularEdgeCenterPoint({shape:e.circle1}),s=new t.AlignDto;s.fromDirection=r,s.toDirection=[0,0,1],s.fromOrigin=i,s.toOrigin=[0,0,0],s.shape=e.circle1;const n=this.transformsService.align(s);s.shape=e.circle2;const o=this.transformsService.align(s),a=this.getGpCircle2dFromEdge({shape:n}),c=this.getGpCircle2dFromEdge({shape:o});n.delete(),o.delete();const h=new this.occ.GccEnt_QualifiedCirc(a,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified)),d=new this.occ.GccEnt_QualifiedCirc(c,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified));a.delete(),c.delete();const l=new this.occ.GccAna_Lin2d2Tan_3(h,d,e.tolerance),u=new this.occ.GccAna_Lin2d2Tan_3(d,h,e.tolerance);h.delete(),d.delete();const p=[];for(let e=1;e<=l.NbSolutions();e++){const t=l.ThisSolution(e);p.push(t)}l.delete();const f=[];for(let e=1;e<=u.NbSolutions();e++){const t=u.ThisSolution(e);f.push(t)}let v;u.delete(),4===f.length?v=[f[2],f[1],f[0],f[3]]:2===f.length&&(v=[f[1],f[0]]);const g=[];for(let e=0;e<p.length;e++){const t=p[e],n=v[e],o=t.Location(),a=[o.X(),o.Y(),0],c=n.Location(),h=[c.X(),c.Y(),0],d=this.lineEdge({start:a,end:h});s.fromDirection=[0,0,1],s.toDirection=r,s.fromOrigin=[0,0,0],s.toOrigin=i,s.shape=d;const l=this.transformsService.align(s);g.push(l),d.delete(),t.delete(),n.delete(),o.delete(),c.delete()}let m=[];if(m=e.positionResult===t.positionResultEnum.all?[...g]:e.positionResult===t.positionResultEnum.keepSide1&&4===g.length?[g[1],g[3]]:e.positionResult===t.positionResultEnum.keepSide2&&4===g.length?[g[0],g[2]]:e.positionResult===t.positionResultEnum.keepSide1&&2===g.length?[]:e.positionResult===t.positionResultEnum.keepSide2&&2===g.length?[g[0],g[1]]:[...g],2===m.length&&e.circleRemainders!==t.twoCircleInclusionEnum.none){let r,i,s,n;e.circleRemainders===t.twoCircleInclusionEnum.outside?(e.positionResult===t.positionResultEnum.keepSide2||e.positionResult===t.positionResultEnum.all?(r=this.startPointOnEdge({shape:m[1]}),i=this.startPointOnEdge({shape:m[0]})):e.positionResult===t.positionResultEnum.keepSide1&&(r=this.startPointOnEdge({shape:m[0]}),i=this.startPointOnEdge({shape:m[1]})),s=this.endPointOnEdge({shape:m[0]}),n=this.endPointOnEdge({shape:m[1]})):e.circleRemainders===t.twoCircleInclusionEnum.inside?(e.positionResult===t.positionResultEnum.keepSide2||e.positionResult===t.positionResultEnum.all?(r=this.startPointOnEdge({shape:m[0]}),i=this.startPointOnEdge({shape:m[1]})):e.positionResult===t.positionResultEnum.keepSide1&&(r=this.startPointOnEdge({shape:m[1]}),i=this.startPointOnEdge({shape:m[0]})),s=this.endPointOnEdge({shape:m[1]}),n=this.endPointOnEdge({shape:m[0]})):e.circleRemainders===t.twoCircleInclusionEnum.insideOutside?(e.positionResult===t.positionResultEnum.keepSide2||e.positionResult===t.positionResultEnum.all?(r=this.startPointOnEdge({shape:m[0]}),i=this.startPointOnEdge({shape:m[1]})):e.positionResult===t.positionResultEnum.keepSide1&&(r=this.startPointOnEdge({shape:m[1]}),i=this.startPointOnEdge({shape:m[0]})),s=this.endPointOnEdge({shape:m[0]}),n=this.endPointOnEdge({shape:m[1]})):e.circleRemainders===t.twoCircleInclusionEnum.outsideInside&&(e.positionResult===t.positionResultEnum.keepSide2||e.positionResult===t.positionResultEnum.all?(r=this.startPointOnEdge({shape:m[1]}),i=this.startPointOnEdge({shape:m[0]})):e.positionResult===t.positionResultEnum.keepSide1&&(r=this.startPointOnEdge({shape:m[0]}),i=this.startPointOnEdge({shape:m[1]})),s=this.endPointOnEdge({shape:m[1]}),n=this.endPointOnEdge({shape:m[0]}));const o=this.arcFromCircleAndTwoPoints({circle:e.circle1,start:r,end:i,sense:!0}),a=this.arcFromCircleAndTwoPoints({circle:e.circle2,start:s,end:n,sense:!0});m.unshift(o),m.push(a)}return m}constraintTanCirclesOnCircleAndPnt(e){const r=this.getCircularEdgePlaneDirection({shape:e.circle}),i=this.getCircularEdgeCenterPoint({shape:e.circle}),{alignOpt:s,circle1Aligned:n}=this.alignCircle(r,i,e.circle),o=this.entitiesService.makeVertex(e.point);s.shape=o;const a=this.transformsService.align(s);o.delete();const c=this.converterService.vertexToPoint({shape:a});a.delete();const h=this.entitiesService.gpPnt2d([c[0],c[1]]),d=this.getGpCircle2dFromEdge({shape:n});n.delete();const l=new this.occ.GccEnt_QualifiedCirc(d,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified));d.delete();const u=new this.occ.GccAna_Circ2d2TanRad_3(l,h,e.radius,e.tolerance);l.delete();const p=[];for(let e=1;e<=u.NbSolutions();e++){const t=u.ThisSolution(e);p.push(t)}u.delete();const f=[];for(let e=0;e<p.length;e++){const t=p[e],n=this.reconstructCircleAndAlignBack(p,t,s,r,i);f.push(n)}return f}alignCircle(e,r,i){const s=new t.AlignDto;return s.fromDirection=e,s.toDirection=[0,0,1],s.fromOrigin=r,s.toOrigin=[0,0,0],s.shape=i,{alignOpt:s,circle1Aligned:this.transformsService.align(s)}}constraintTanCirclesOnTwoCircles(e){const r=this.getCircularEdgePlaneDirection({shape:e.circle1}),i=this.getCircularEdgeCenterPoint({shape:e.circle1}),{alignOpt:s,circle1Aligned:n}=this.alignCircle(r,i,e.circle1);s.shape=e.circle2;const o=this.transformsService.align(s),a=this.getGpCircle2dFromEdge({shape:n}),c=this.getGpCircle2dFromEdge({shape:o});n.delete(),o.delete();const h=new this.occ.GccEnt_QualifiedCirc(a,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified)),d=new this.occ.GccEnt_QualifiedCirc(c,this.enumService.getGccEntPositionFromEnum(t.gccEntPositionEnum.unqualified));a.delete(),c.delete();const l=new this.occ.GccAna_Circ2d2TanRad_1(h,d,e.radius,e.tolerance);h.delete(),d.delete();const u=[];for(let e=1;e<=l.NbSolutions();e++){const t=l.ThisSolution(e);u.push(t)}l.delete();const p=[];for(let e=0;e<u.length;e++){const t=u[e],n=this.reconstructCircleAndAlignBack(u,t,s,r,i);p.push(n)}return p}divideEdgeByParamsToPoints(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.divideCurveToNrSegments(Object.assign(Object.assign({},e),{shape:i}),i.FirstParameter(),i.LastParameter());return i.delete(),r.delete(),s}divideEdgeByEqualDistanceToPoints(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.divideCurveByEqualLengthDistance(Object.assign(Object.assign({},e),{shape:i}));return i.delete(),r.delete(),s}pointOnEdgeAtParam(e){const t=e.shape,{uMin:r,uMax:i}=this.getEdgeBounds(t),s=this.converterService.getGeomCurveFromEdge(t,r,i),n=this.entitiesService.gpPnt([0,0,0]),o=this.vecHelper.remap(e.param,0,1,r,i);s.D0(o,n);const a=[n.X(),n.Y(),n.Z()];return n.delete(),a}reconstructCircleAndAlignBack(e,r,i,s,n){const o=r.Location(),a=[o.X(),o.Y(),0],c=this.entitiesService.createCircle(r.Radius(),a,[0,0,1],t.typeSpecificityEnum.edge);i.fromDirection=[0,0,1],i.toDirection=s,i.fromOrigin=[0,0,0],i.toOrigin=n,i.shape=c;const h=this.transformsService.align(i);return c.delete(),r.delete(),o.delete(),h}arcFromCircleAndTwoPoints(e){const t=this.getGpCircleFromEdge({shape:e.circle}),r=this.entitiesService.gpPnt(e.start),i=this.entitiesService.gpPnt(e.end),s=new this.occ.GC_MakeArcOfCircle_3(t,r,i,e.sense),n=new this.occ.Handle_Geom_Curve_2(s.Value().get()),o=new this.occ.BRepBuilderAPI_MakeEdge_24(n),a=o.Edge();return t.delete(),r.delete(),i.delete(),s.delete(),n.delete(),o.delete(),a}getCircularEdgePlaneDirection(e){const t=this.getGpCircleFromEdge(e),r=t.Position(),i=r.Direction(),s=[i.X(),i.Y(),i.Z()];return i.delete(),r.delete(),t.delete(),s}getCircularEdgeCenterPoint(e){const t=this.getGpCircleFromEdge(e),r=t.Location(),i=[r.X(),r.Y(),r.Z()];return r.delete(),t.delete(),i}getCircularEdgeRadius(e){const t=this.getGpCircleFromEdge(e),r=t.Radius();return t.delete(),r}getGpCircleFromEdge(e){const t=new this.occ.BRepAdaptor_Curve_2(e.shape);try{const e=t.Circle();return t.delete(),e}catch(e){throw t.delete(),new Error("Edge is not a circular edge.")}}getGpCircle2dFromEdge(e){const t=new this.occ.BRepAdaptor_Curve_2(e.shape);try{const e=t.Circle(),r=e.Position(),i=e.Location(),s=this.entitiesService.gpAx2d([i.X(),i.Y()],[1,0]),n=e.Radius(),o=new this.occ.gp_Circ2d_2(s,n,!0);return t.delete(),e.delete(),r.delete(),i.delete(),s.delete(),o}catch(e){throw t.delete(),new Error("Edge is not a circular edge.")}}tangentOnEdgeAtParam(e){const t=e.shape,{uMin:r,uMax:i}=this.getEdgeBounds(t),s=this.converterService.getGeomCurveFromEdge(t,r,i),n=this.vecHelper.remap(e.param,0,1,r,i),o=s.DN(n,1),a=[o.X(),o.Y(),o.Z()];return o.delete(),a}pointOnEdgeAtLength(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.pointOnCurveAtLength(Object.assign(Object.assign({},e),{shape:i}));return i.delete(),r.delete(),s}tangentOnEdgeAtLength(e){const t=e.shape,r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[t]}),i=new this.occ.BRepAdaptor_CompCurve_2(r,!1),s=this.geomService.tangentOnCurveAtLength(Object.assign(Object.assign({},e),{shape:i}));return r.delete(),i.delete(),s}getEdgeBounds(e){const t={current:0},r={current:0};return this.occRefReturns.BRep_Tool_Range_1(e,t,r),{uMin:t.current,uMax:r.current}}isEdgeCircular(e){const t=new this.occ.BRepAdaptor_Curve_2(e.shape);try{return t.Circle(),t.delete(),!0}catch(e){return!1}}isEdgeLinear(e){const t=new this.occ.BRepAdaptor_Curve_2(e.shape);try{return t.Line(),t.delete(),!0}catch(e){return!1}}}class F{constructor(e,t,r){this.occ=e,this.vecHelper=t,this.entitiesService=r}pointOnCurveAtParam(e){const t=e.shape,r=this.entitiesService.gpPnt([0,0,0]),i=this.vecHelper.remap(e.param,0,1,t.FirstParameter(),t.LastParameter());t.D0(i,r);const s=[r.X(),r.Y(),r.Z()];return r.delete(),s}pointOnCurveAtLength(e){const t=new this.occ.GCPnts_AbscissaPoint_2(e.shape,e.length,e.shape.FirstParameter()),r=t.Parameter(),i=this.entitiesService.gpPnt([0,0,0]);e.shape.D0(r,i);const s=[i.X(),i.Y(),i.Z()];return t.delete(),i.delete(),s}tangentOnCurveAtLength(e){const t=new this.occ.GCPnts_AbscissaPoint_2(e.shape,e.length,e.shape.FirstParameter()),r=t.Parameter(),i=e.shape.DN(r,1),s=[i.X(),i.Y(),i.Z()];return i.delete(),t.delete(),s}tangentOnCurveAtParam(e){const t=e.shape,r=this.vecHelper.remap(e.param,0,1,t.FirstParameter(),t.LastParameter()),i=t.DN(r,1),s=[i.X(),i.Y(),i.Z()];return i.delete(),s}divideCurveByEqualLengthDistance(e){const t=e.shape,r=this.occ.GCPnts_AbscissaPoint.Length_5(t,t.FirstParameter(),t.LastParameter()),i=r/e.nrOfDivisions,s=[];for(let e=0;e<=r+1e-9;e+=i)s.push(e);return e.removeStartPoint&&s.shift(),e.removeEndPoint&&s.pop(),s.map((e=>{const r=new this.occ.GCPnts_AbscissaPoint_2(t,e,t.FirstParameter()),i=r.Parameter();return r.delete(),i})).map((e=>{const r=this.entitiesService.gpPnt([0,0,0]);t.D0(e,r);const i=[r.X(),r.Y(),r.Z()];return r.delete(),i}))}divideCurveToNrSegments(e,t,r){const i=e.shape,s=[];for(let i=0;i<=e.nrOfDivisions;i++){const n=i/e.nrOfDivisions,o=this.vecHelper.remap(n,0,1,t,r);s.push(o)}return e.removeStartPoint&&s.shift(),e.removeEndPoint&&s.pop(),s.map((e=>{const t=this.entitiesService.gpPnt([0,0,0]);i.D0(e,t);const r=[t.X(),t.Y(),t.Z()];return t.delete(),r}))}startPointOnCurve(e){const t=e.shape,r=this.entitiesService.gpPnt([0,0,0]);t.D0(t.FirstParameter(),r);const i=[r.X(),r.Y(),r.Z()];return r.delete(),i}endPointOnCurve(e){const t=e.shape,r=this.entitiesService.gpPnt([0,0,0]);t.D0(t.LastParameter(),r);const i=[r.X(),r.Y(),r.Z()];return r.delete(),i}getLinearCenterOfMass(e){const t=e.shape,r=new this.occ.GProp_GProps_1;this.occ.BRepGProp.LinearProperties(t,r,!1,!1);const i=r.CentreOfMass(),s=[i.X(),i.Y(),i.Z()];return r.delete(),s}}class O{constructor(e,t,r,i,s,n,o,a,c,h,d,l){this.occ=e,this.occRefReturns=t,this.vecHelper=r,this.shapesHelperService=i,this.shapeGettersService=s,this.transformsService=n,this.enumService=o,this.entitiesService=a,this.converterService=c,this.geomService=h,this.edgesService=d,this.booleansService=l}getWireLength(e){return this.shapeGettersService.getEdges(e).map((e=>this.edgesService.getEdgeLength({shape:e}))).reduce(((e,t)=>e+t),0)}getWiresLengths(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getWireLength({shape:e})))}createRectangleWire(e){const t=e.width/2,r=e.length/2,i=[[t,0,r],[-t,0,r],[-t,0,-r],[t,0,-r]].reverse(),s=this.createPolygonWire({points:i}),n=this.transformsService.alignAndTranslate({shape:s,direction:e.direction,center:e.center});return s.delete(),n}createSquareWire(e){return this.createRectangleWire({width:e.size,length:e.size,center:e.center,direction:e.direction})}createChristmasTreeWire(e){const t=this.createLineWire({start:[e.innerDist,0,0],end:[0,e.height,0]}),r=this.createLineWire({start:[e.outerDist,0,0],end:[0,e.height,0]}),i=this.divideWireByEqualDistanceToPoints({shape:t,nrOfDivisions:e.nrSkirts,removeEndPoint:!1,removeStartPoint:!1}),s=this.divideWireByEqualDistanceToPoints({shape:r,nrOfDivisions:e.nrSkirts,removeEndPoint:!1,removeStartPoint:!1}),n=[];if(e.trunkWidth>0&&e.trunkHeight>0?(n.push([0,-e.trunkHeight,0]),n.push([e.trunkWidth/2,-e.trunkHeight,0]),n.push([e.trunkWidth/2,0,0])):n.push([0,0,0]),i.forEach(((t,r)=>{const i=s[r];0===r?n.push(i):0!==r&&r<s.length-1?(n.push([t[0],i[1]+e.height/e.nrSkirts*.1,t[2]]),n.push(i)):n.push(t)})),!e.half){const e=n.map((e=>[-e[0],e[1],e[2]]));e.pop(),n.push(...e.reverse())}let o;if(e.trunkHeight>0&&e.trunkWidth>0){const t=n.map((t=>[t[0],t[1]+e.trunkHeight,t[2]]));o=this.createPolylineWire({points:t})}else o=this.createPolylineWire({points:n});const a=this.transformsService.rotate({shape:o,angle:e.rotation,axis:[0,1,0]});return this.transformsService.alignAndTranslate({shape:a,direction:e.direction,center:e.origin})}createStarWire(e){const t=this.shapesHelperService.starLines(e.innerRadius,e.outerRadius,e.numRays,e.half,e.offsetOuterEdges),r=[];t.forEach((e=>{r.push(this.edgesService.lineEdge(e))}));const i=this.converterService.combineEdgesAndWiresIntoAWire({shapes:r}),s=this.transformsService.alignAndTranslate({shape:i,direction:e.direction,center:e.center});return i.delete(),s}createParallelogramWire(e){const t=this.shapesHelperService.parallelogram(e.width,e.height,e.angle,e.aroundCenter),r=[];t.forEach((e=>{r.push(this.edgesService.lineEdge(e))}));const i=this.converterService.combineEdgesAndWiresIntoAWire({shapes:r}),s=this.transformsService.alignAndTranslate({shape:i,direction:e.direction,center:e.center});return i.delete(),s}createHeartWire(e){const t=e.sizeApprox/2,r=[[0,0,.7*t],[t/6,0,.9*t],[t/2,0,t],[.75*t,0,.9*t],[t,0,t/4],[t/2,0,-t/2],[0,0,-t]],i=r.map((e=>[-e[0],e[1],e[2]])),s=1e-5,n=this.interpolatePoints({points:r,periodic:!1,tolerance:s}),o=this.interpolatePoints({points:i.reverse(),periodic:!1,tolerance:s}),a=this.converterService.combineEdgesAndWiresIntoAWire({shapes:[n,o]}),c=this.transformsService.rotate({shape:a,angle:e.rotation,axis:[0,1,0]}),h=this.transformsService.alignAndTranslate({shape:c,direction:e.direction,center:e.center});return a.delete(),c.delete(),n.delete(),o.delete(),h}createNGonWire(e){const t=this.shapesHelperService.ngon(e.nrCorners,e.radius,[0,0]),r=[];t.forEach((e=>{r.push(this.edgesService.lineEdge(e))}));const i=this.converterService.combineEdgesAndWiresIntoAWire({shapes:r}),s=this.transformsService.alignAndTranslate({shape:i,direction:e.direction,center:e.center});return i.delete(),s}createLPolygonWire(e){let r;switch(e.align){case t.directionEnum.outside:r=this.shapesHelperService.polygonL(e.widthFirst,e.lengthFirst,e.widthSecond,e.lengthSecond);break;case t.directionEnum.inside:r=this.shapesHelperService.polygonLInverted(e.widthFirst,e.lengthFirst,e.widthSecond,e.lengthSecond);break;case t.directionEnum.middle:r=this.shapesHelperService.polygonLMiddle(e.widthFirst,e.lengthFirst,e.widthSecond,e.lengthSecond);break;default:r=this.shapesHelperService.polygonL(e.widthFirst,e.lengthFirst,e.widthSecond,e.lengthSecond)}const i=this.createPolygonWire({points:r}),s=this.transformsService.rotate({shape:i,angle:e.rotation,axis:[0,1,0]}),n=this.transformsService.alignAndTranslate({shape:s,direction:e.direction,center:e.center});return i.delete(),s.delete(),n}createPolygonWire(e){const t=[];for(let r=0;r<e.points.length;r++)t.push(this.entitiesService.gpPnt(e.points[r]));const r=new this.occ.BRepBuilderAPI_MakeWire_1;for(let i=0;i<e.points.length-1;i++){const e=t[i],s=t[i+1],n=this.makeWireBetweenTwoPoints(e,s);r.Add_2(n)}const i=t[e.points.length-1],s=t[0],n=this.makeWireBetweenTwoPoints(i,s);r.Add_2(n);const o=r.Wire();return r.delete(),o}createPolylineWire(e){const t=[];for(let r=0;r<e.points.length;r++)t.push(this.entitiesService.gpPnt(e.points[r]));const r=new this.occ.BRepBuilderAPI_MakeWire_1;for(let i=0;i<e.points.length-1;i++){const e=t[i],s=t[i+1],n=this.makeWireBetweenTwoPoints(e,s);r.Add_2(n)}const i=r.Wire();return r.delete(),i}createLineWire(e){const t=[];t.push(this.entitiesService.gpPnt(e.start)),t.push(this.entitiesService.gpPnt(e.end));const r=new this.occ.BRepBuilderAPI_MakeWire_1;for(let e=0;e<t.length-1;e++){const i=t[e],s=t[e+1],n=this.makeWireBetweenTwoPoints(i,s);r.Add_2(n)}const i=r.Wire();return r.delete(),i}makeWireBetweenTwoPoints(e,t){const r=new this.occ.GC_MakeSegment_1(e,t),i=r.Value(),s=i.get(),n=new this.occ.BRepBuilderAPI_MakeEdge_24(new this.occ.Handle_Geom_Curve_2(s)),o=n.Edge(),a=new this.occ.BRepBuilderAPI_MakeWire_2(o),c=a.Wire();return n.delete(),r.delete(),i.delete(),s.delete(),o.delete(),a.delete(),c}divideWireByParamsToPoints(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.divideCurveToNrSegments(Object.assign(Object.assign({},e),{shape:r}),r.FirstParameter(),r.LastParameter());return r.delete(),i}divideWireByEqualDistanceToPoints(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.divideCurveByEqualLengthDistance(Object.assign(Object.assign({},e),{shape:r}));return r.delete(),i}pointOnWireAtParam(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.pointOnCurveAtParam(Object.assign(Object.assign({},e),{shape:r}));return r.delete(),i}tangentOnWireAtParam(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.tangentOnCurveAtParam(Object.assign(Object.assign({},e),{shape:r}));return r.delete(),i}pointOnWireAtLength(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.pointOnCurveAtLength(Object.assign(Object.assign({},e),{shape:r}));return r.delete(),i}tangentOnWireAtLength(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1),i=this.geomService.tangentOnCurveAtLength(Object.assign(Object.assign({},e),{shape:r}));return r.delete(),i}interpolatePoints(e){const t=new this.occ.TColgp_Array1OfPnt_2(1,e.points.length),r=[];for(let i=1;i<=e.points.length;i++){const s=this.entitiesService.gpPnt(e.points[i-1]);r.push(s),t.SetValue(i,s)}const i=this.occ.BitByBitDev.BitInterpolate(t,e.periodic,e.tolerance);if(i.IsNull())return r.forEach((e=>e.delete())),void t.delete();{const e=i.get(),s=new this.occ.Handle_Geom_Curve_2(e),n=new this.occ.BRepBuilderAPI_MakeEdge_24(s),o=n.Edge(),a=new this.occ.BRepBuilderAPI_MakeWire_2(o),c=a.Wire();return i.Nullify(),i.delete(),s.Nullify(),s.delete(),n.delete(),o.delete(),a.delete(),r.forEach((e=>e.delete())),t.delete(),c}}splitOnPoints(e){const t=1e-7,r=this.startPointOnWire({shape:e.shape}),i=this.endPointOnWire({shape:e.shape}),s=this.vecHelper.vectorsTheSame(i,r,t);s||(e.points.some((e=>this.vecHelper.vectorsTheSame(e,r,t)))||e.points.push(r),e.points.some((e=>this.vecHelper.vectorsTheSame(e,i,t)))||e.points.push(i));const n=this.createLines({lines:e.points.map((e=>({start:e,end:[e[0],e[1]+t,e[2]]}))),returnCompound:!1}),o=this.booleansService.difference({shape:e.shape,shapes:n,keepEdges:!0}),a=this.shapeGettersService.getEdges({shape:o}),c=[];a.forEach((r=>{const i=c[c.length-1],s=this.edgesService.endPointOnEdge({shape:r}),n=this.edgesService.startPointOnEdge({shape:r}),o=e.points.some((e=>this.vecHelper.vectorsTheSame(s,e,t))),a=e.points.some((e=>this.vecHelper.vectorsTheSame(n,e,t)));o&&!a?c.push([r]):!o&&a?i?i.push(r):c.push([r]):o&&a?c.push([r]):o||a||(i?i.push(r):c.push([r]))}));const h=[];if(c.forEach((e=>{const t=this.converterService.combineEdgesAndWiresIntoAWire({shapes:e});h.push(t)})),s&&h.length>1){const r=this.endPointOnWire({shape:h[0]}),i=this.startPointOnWire({shape:h[h.length-1]});if(this.vecHelper.vectorsTheSame(r,i,t)&&!e.points.find((e=>this.vecHelper.vectorsTheSame(e,r,t)))){const e=this.addEdgesAndWiresToWire({shape:h[h.length-1],shapes:[h[0]]});h[0]=e,h.pop()}}return h}createLines(e){const t=e.lines.map((e=>this.createLineWire(e))).filter((e=>void 0!==e));return this.converterService.makeCompoundIfNeeded(t,e.returnCompound)}createWireFromTwoCirclesTan(e){const r=this.shapeGettersService.getEdges({shape:e.circle1}),i=this.shapeGettersService.getEdges({shape:e.circle2});if(1===r.length&&1===i.length){const s=r[0],n=i[0],o=this.edgesService.constraintTanLinesOnTwoCircles({circle1:s,circle2:n,positionResult:e.keepLines===t.twoSidesStrictEnum.outside?t.positionResultEnum.keepSide2:t.positionResultEnum.keepSide1,circleRemainders:this.enumService.convertFourSidesStrictEnumToTwoCircleInclusionEnum(e.circleRemainders),tolerance:e.tolerance}),a=this.converterService.combineEdgesAndWiresIntoAWire({shapes:o});return o.forEach((e=>e.delete())),s.delete(),n.delete(),a}throw new Error("Could not find the edges of the provided circle wires.")}createZigZagBetweenTwoWires(e){const t=e.wire1,r=e.wire2,i=this.edgesService.getEdgesAlongWire({shape:t}),s=this.edgesService.getEdgesAlongWire({shape:r}),n=i.map((t=>this.edgesService.divideEdgeByParamsToPoints({shape:t,nrOfDivisions:2*e.nrZigZags,removeEndPoint:!1,removeStartPoint:!1}))),o=s.map((t=>this.edgesService.divideEdgeByParamsToPoints({shape:t,nrOfDivisions:2*e.nrZigZags,removeEndPoint:!1,removeStartPoint:!1}))),a=n.map(((t,r)=>{const i=o[r],s=[];for(let r=0;r<t.length;r++)r%2==0?e.inverse?s.push(i[r]):s.push(t[r]):e.inverse?s.push(t[r]):s.push(i[r]);return this.createPolylineWire({points:s})}));return this.converterService.combineEdgesAndWiresIntoAWire({shapes:a})}getWireCenterOfMass(e){return this.geomService.getLinearCenterOfMass(e)}createWireFromEdges(e){const t=new this.occ.BRepBuilderAPI_MakeWire_2(e.shape),r=t.Wire();return t.delete(),r}createBSpline(e){const t=new this.occ.TColgp_Array1OfPnt_2(1,e.points.length+(e.closed?1:0)),r=[];for(let i=1;i<=e.points.length;i++){const s=this.entitiesService.gpPnt(e.points[i-1]);r.push(s),t.SetValue(i,s)}e.closed&&t.SetValue(e.points.length+1,t.Value(1));const i=new this.occ.GeomAPI_PointsToBSpline_2(t,3,8,this.occ.GeomAbs_Shape.GeomAbs_C2,.001),s=i.Curve(),n=s.get(),o=new this.occ.Handle_Geom_Curve_2(n),a=new this.occ.BRepBuilderAPI_MakeEdge_24(o),c=a.Edge(),h=new this.occ.BRepBuilderAPI_MakeWire_2(c),d=h.Wire();return r.forEach((e=>e.delete())),t.delete(),i.delete(),s.Nullify(),s.delete(),o.Nullify(),o.delete(),a.delete(),c.delete(),h.delete(),d}createBezier(e){const t=new this.occ.TColgp_Array1OfPnt_2(1,e.points.length+(e.closed?1:0));for(let r=1;r<=e.points.length;r++)t.SetValue(r,this.entitiesService.gpPnt(e.points[r-1]));e.closed&&t.SetValue(e.points.length+1,t.Value(1));const r=new this.occ.Geom_BezierCurve_1(t),i=new this.occ.Handle_Geom_Curve_2(r),s=new this.occ.BRepBuilderAPI_MakeEdge_24(i),n=s.Edge(),o=new this.occ.BRepBuilderAPI_MakeWire_2(n),a=o.Wire();return o.delete(),s.delete(),n.delete(),i.delete(),t.delete(),a}addEdgesAndWiresToWire(e){const t=new this.occ.BRepBuilderAPI_MakeWire_1;let r;if(t.Add_2(e.shape),e.shapes.forEach((e=>{e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_EDGE?t.Add_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_WIRE&&t.Add_2(e)})),!t.IsDone())throw new Error("Wire could not be constructed. Check if edges and wires do not have disconnected elements.");return r=t.Wire(),t.delete(),r}startPointOnWire(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1);return this.geomService.startPointOnCurve(Object.assign(Object.assign({},e),{shape:r}))}endPointOnWire(e){const t=e.shape,r=new this.occ.BRepAdaptor_CompCurve_2(t,!1);return this.geomService.endPointOnCurve(Object.assign(Object.assign({},e),{shape:r}))}placeWire(e,t){const r=this.shapeGettersService.getEdges({shape:e}),i=[];r.forEach((e=>{const r={current:0},s={current:0};this.occRefReturns.BRep_Tool_Range_1(e,r,s);const n=this.occRefReturns.BRep_Tool_Curve_2(e,r,s);if(!n.IsNull()){const e=this.entitiesService.gpPln([0,0,0],[0,1,0]),o=this.occ.GeomAPI.To2d(n,e),a=o.get(),c=this.edgesService.makeEdgeFromGeom2dCurveAndSurfaceBounded({curve:a,surface:t},r.current,s.current);c&&i.push(c),e.delete(),o.delete()}n.delete()})),r.forEach((e=>e.delete()));const s=this.converterService.combineEdgesAndWiresIntoAWire({shapes:i});return i.forEach((e=>e.delete())),s}}class R{constructor(e,t,r,i,s,n,o,a){this.occ=e,this.occRefReturns=t,this.entitiesService=r,this.enumService=i,this.shapeGettersService=s,this.converterService=n,this.booleansService=o,this.wiresService=a}createFaceFromWire(e){let r;if(this.enumService.getShapeTypeEnum(e.shape)!==t.shapeTypeEnum.wire)throw new Error("Provided input shape is not a wire");if(e.planar){const t=this.occ.TopoDS.Wire_1(e.shape);r=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(t,e.planar),t.delete()}else{const t=3,i=15,s=2,n=!1,o=1e-5,a=1e-4,c=.01,h=.1,d=8,l=9,u=new this.occ.BRepFill_Filling(t,i,s,n,o,a,c,h,d,l),p=this.shapeGettersService.getEdges(e);if(p.forEach((e=>{u.Add_1(e,this.occ.GeomAbs_Shape.GeomAbs_C0,!0)})),u.Build(),!u.IsDone())throw new Error("Could not create non planar face");r=u.Face(),u.delete(),p.forEach((e=>e.delete()))}return r}getFaceArea(e){const t=new this.occ.GProp_GProps_1;this.occ.BRepGProp.SurfaceProperties_1(e.shape,t,!1,!1);const r=t.Mass();return t.delete(),r}getFacesAreas(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getFaceArea({shape:e})))}getFaceCenterOfMass(e){const t=new this.occ.GProp_GProps_1;this.occ.BRepGProp.SurfaceProperties_1(e.shape,t,!1,!1);const r=t.CentreOfMass(),i=[r.X(),r.Y(),r.Z()];return t.delete(),r.delete(),i}getFacesCentersOfMass(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getFaceCenterOfMass({shape:e})))}filterFacePoints(e){const r=[];if(e.points.length>0){const i=new this.occ.BRepClass_FaceClassifier_1;return e.points.forEach((s=>{const n=this.entitiesService.gpPnt(s);i.Perform_2(e.shape,n,e.tolerance,e.useBndBox,e.gapTolerance);const o=i.State(),a=this.enumService.getTopAbsStateEnum(o);e.keepOn&&a===t.topAbsStateEnum.on&&r.push(s),e.keepIn&&a===t.topAbsStateEnum.in&&r.push(s),e.keepOut&&a===t.topAbsStateEnum.out&&r.push(s),e.keepUnknown&&a===t.topAbsStateEnum.unknown&&r.push(s),n.delete()})),i.delete(),r}return[]}createSquareFace(e){const t=this.wiresService.createSquareWire(e),r=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(t,!0);return t.delete(),r}createRectangleFace(e){const t=this.wiresService.createRectangleWire(e),r=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(t,!0);return t.delete(),r}createFaceFromMultipleCircleTanWires(e){const r=e.circles,i=[];if(e.combination===t.combinationCirclesForFaceEnum.allWithAll)for(let s=0;s<r.length;s++)for(let n=s+1;n<r.length;n++){const o=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s],circle2:r[n],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),a=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(o,!0);i.push(a)}else if(e.combination===t.combinationCirclesForFaceEnum.inOrder)for(let s=0;s<r.length-1;s++){const n=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s],circle2:r[s+1],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),o=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(n,!0);i.push(o)}else if(e.combination===t.combinationCirclesForFaceEnum.inOrderClosed)for(let s=0;s<r.length;s++){const n=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s],circle2:r[(s+1)%r.length],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),o=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(n,!0);i.push(o)}let s;return s=e.unify?this.booleansService.union({shapes:i,keepEdges:!1}):this.converterService.makeCompound({shapes:i}),s}createFaceFromMultipleCircleTanWireCollections(e){const r=e.listsOfCircles,i=[];if(e.combination===t.combinationCirclesForFaceEnum.allWithAll)for(let s=0;s<r.length;s++){const n=r[s],o=r[s+1];if(!o)break;for(let r=0;r<n.length;r++)for(let s=0;s<o.length;s++){const a=n[r],c=o[s],h=this.wiresService.createWireFromTwoCirclesTan({circle1:a,circle2:c,keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),d=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(h,!0);i.push(d)}}else if(e.combination===t.combinationCirclesForFaceEnum.inOrder){for(let e=0;e<r.length;e++)if(r[e].length!==r[0].length)throw new Error("All lists of circles must have the same length in order to use inOrder strategy.");for(let s=0;s<r.length-1;s++)for(let n=0;n<r[s].length;n++){const o=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s][n],circle2:r[s+1][n],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),a=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(o,!0);i.push(a)}}else if(e.combination===t.combinationCirclesForFaceEnum.inOrderClosed){for(let e=0;e<r.length;e++)if(r[e].length!==r[0].length)throw new Error("All lists of circles must have the same length in order to use inOrderClosed strategy.");for(let s=0;s<r.length-1;s++)for(let n=0;n<r[s].length;n++){const o=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s][n],circle2:r[s+1][n],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),a=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(o,!0);i.push(a)}for(let s=0;s<r.length;s++)for(let n=0;n<r[s].length;n++){const o=this.wiresService.createWireFromTwoCirclesTan({circle1:r[s][n],circle2:r[s][(n+1)%r[s].length],keepLines:t.twoSidesStrictEnum.outside,circleRemainders:t.fourSidesStrictEnum.outside,tolerance:e.tolerance}),a=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(o,!0);i.push(a)}}let s;return s=e.unify?this.booleansService.union({shapes:i,keepEdges:!1}):this.converterService.makeCompound({shapes:i}),s}faceNormalOnUV(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),{uMin:i,uMax:s,vMin:n,vMax:o}=this.getUVBounds(t),a=i+(s-i)*e.paramU,c=n+(o-n)*e.paramV,h=this.entitiesService.gpDir([0,1,0]);this.occ.GeomLib.NormEstim(r,this.entitiesService.gpPnt2d([a,c]),1e-7,h),t.Orientation_1()===this.occ.TopAbs_Orientation.TopAbs_REVERSED&&h.Reverse();const d=[h.X(),h.Y(),h.Z()];return h.delete(),r.delete(),d}getUVBounds(e){const t={current:0},r={current:0},i={current:0},s={current:0};return this.occRefReturns.BRepTools_UVBounds_1(e,t,r,i,s),{uMin:t.current,uMax:r.current,vMin:i.current,vMax:s.current}}createFaceFromWires(e){return this.entitiesService.bRepBuilderAPIMakeFaceFromWires(e.shapes,e.planar)}createFacesFromWires(e){return e.shapes.map((t=>this.createFaceFromWire({shape:t,planar:e.planar})))}faceFromSurface(e){const t=this.entitiesService.bRepBuilderAPIMakeFaceFromSurface(e.shape,e.tolerance);if(t.IsNull())throw t.delete(),new Error("Could not construct a face from the surface. Check if surface is not infinite.");return t}faceFromSurfaceAndWire(e){const t=this.entitiesService.bRepBuilderAPIMakeFaceFromSurfaceAndWire(e.surface,e.wire,e.inside);if(t.IsNull())throw t.delete(),new Error("Could not construct a face from the surface. Check if surface is not infinite.");return t}getUMinBound(e){const t=e.shape,{uMin:r}=this.getUVBounds(t);return r}getUMaxBound(e){const t=e.shape,{uMax:r}=this.getUVBounds(t);return r}getVMinBound(e){const t=e.shape,{vMin:r}=this.getUVBounds(t);return r}getVMaxBound(e){const t=e.shape,{vMax:r}=this.getUVBounds(t);return r}subdivideToPointsControlled(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),i=r.get(),{uMin:s,uMax:n,vMin:o,vMax:a}=this.getUVBounds(t),c=[];for(let t=0;t<e.nrDivisionsU;t++){const r=(n-s)/(e.nrDivisionsU-1),h=r/2,d=r*t;for(let r=0;r<e.nrDivisionsV;r++){const n=(a-o)/(e.nrDivisionsV-1),l=n/2;let u=o+n*r;u+=e.shiftHalfStepNthV&&(t+e.shiftHalfStepVOffsetN)%e.shiftHalfStepNthV==0?l:0;let p=s+d;p+=e.shiftHalfStepNthU&&(r+e.shiftHalfStepUOffsetN)%e.shiftHalfStepNthU==0?h:0;const f=this.entitiesService.gpPnt([0,0,0]);i.D0(p,u,f);const v=[f.X(),f.Y(),f.Z()];let g=!0;(0===t&&e.removeStartEdgeNthU&&(r+e.removeStartEdgeUOffsetN)%e.removeStartEdgeNthU==0||t===e.nrDivisionsU-1&&e.removeEndEdgeNthU&&(r+e.removeEndEdgeUOffsetN)%e.removeEndEdgeNthU==0||0===r&&e.removeStartEdgeNthV&&(t+e.removeStartEdgeVOffsetN)%e.removeStartEdgeNthV==0||r===e.nrDivisionsV-1&&e.removeEndEdgeNthV&&(t+e.removeEndEdgeVOffsetN)%e.removeEndEdgeNthV==0)&&(g=!1),g&&c.push(v),f.delete()}}return r.delete(),c}subdivideToPoints(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),i=r.get(),{uMin:s,uMax:n,vMin:o,vMax:a}=this.getUVBounds(t),c=[],h=e.removeStartEdgeU?1:0,d=e.removeEndEdgeU?1:0,l=e.removeStartEdgeV?1:0,u=e.removeEndEdgeV?1:0;for(let t=0+h;t<e.nrDivisionsU-d;t++){const r=(n-s)/(e.nrDivisionsU-1),h=r/2,d=r*t,p=s+(e.shiftHalfStepU?h:0)+d;for(let t=0+l;t<e.nrDivisionsV-u;t++){const r=(a-o)/(e.nrDivisionsV-1),s=r/2,n=r*t,h=o+(e.shiftHalfStepV?s:0)+n,d=this.entitiesService.gpPnt([0,0,0]);i.D0(p,h,d);const l=[d.X(),d.Y(),d.Z()];c.push(l),d.delete()}}return r.delete(),c}subdivideToNormals(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),{uMin:i,uMax:s,vMin:n,vMax:o}=this.getUVBounds(t),a=[],c=e.removeStartEdgeU?1:0,h=e.removeEndEdgeU?1:0,d=e.removeStartEdgeV?1:0,l=e.removeEndEdgeV?1:0;for(let u=0+c;u<e.nrDivisionsU-h;u++){const c=(s-i)/(e.nrDivisionsU-1),h=c/2,p=c*u,f=i+(e.shiftHalfStepU?h:0)+p;for(let i=0+d;i<e.nrDivisionsV-l;i++){const s=(o-n)/(e.nrDivisionsV-1),c=s/2,h=s*i,d=n+(e.shiftHalfStepV?c:0)+h,l=this.entitiesService.gpDir([0,1,0]),u=this.entitiesService.gpPnt2d([f,d]);this.occ.GeomLib.NormEstim(r,u,1e-7,l),t.Orientation_1()===this.occ.TopAbs_Orientation.TopAbs_REVERSED&&l.Reverse();const p=[l.X(),l.Y(),l.Z()];a.push(p),l.delete(),u.delete()}}return r.delete(),a}subdivideToPointsOnParam(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),i=r.get(),{uMin:s,uMax:n,vMin:o,vMax:a}=this.getUVBounds(t),c=[],h=e.removeStartPoint?1:0,d=e.removeEndPoint?1:0;let l=e.param;l=e.isU?s+(n-s)*l:o+(a-o)*l;for(let t=0+h;t<e.nrPoints-d;t++){let r;if(e.isU){const i=(a-o)/(e.nrPoints-1),s=i/2,n=i*t;r=o+(e.shiftHalfStep?s:0)+n}else{const i=(n-s)/(e.nrPoints-1),o=i/2,a=i*t;r=s+(e.shiftHalfStep?o:0)+a}const h=this.entitiesService.gpPnt([0,0,0]);e.isU?i.D0(l,r,h):i.D0(r,l,h);const d=[h.X(),h.Y(),h.Z()];c.push(d),h.delete()}return r.delete(),c}subdivideToUVOnParam(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,{uMin:r,uMax:i,vMin:s,vMax:n}=this.getUVBounds(t),o=[],a=e.removeStartPoint?1:0,c=e.removeEndPoint?1:0;let h=e.param;h=e.isU?r+(i-r)*h:s+(n-s)*h;for(let t=0+a;t<e.nrPoints-c;t++){let a,c;if(e.isU){const r=(n-s)/(e.nrPoints-1),i=r/2,o=r*t;a=s+(e.shiftHalfStep?i:0)+o}else{const s=(i-r)/(e.nrPoints-1),n=s/2,o=s*t;a=r+(e.shiftHalfStep?n:0)+o}c=e.isU?[h,a]:[a,h],o.push(c)}return o}subdivideToUV(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,{uMin:r,uMax:i,vMin:s,vMax:n}=this.getUVBounds(t),o=[],a=e.removeStartEdgeU?1:0,c=e.removeEndEdgeU?1:0,h=e.removeStartEdgeV?1:0,d=e.removeEndEdgeV?1:0;for(let t=0+a;t<e.nrDivisionsU-c;t++){const a=(i-r)/(e.nrDivisionsU-1),c=a/2,l=a*t,u=r+(e.shiftHalfStepU?c:0)+l;for(let t=0+h;t<e.nrDivisionsV-d;t++){const r=(n-s)/(e.nrDivisionsV-1),i=r/2,a=r*t,c=s+(e.shiftHalfStepV?i:0)+a;o.push([u,c])}}return o}uvOnFace(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,{uMin:r,uMax:i,vMin:s,vMax:n}=this.getUVBounds(t);return[r+(i-r)*e.paramU,s+(n-s)*e.paramV]}pointsOnUVs(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t).get(),{uMin:i,uMax:s,vMin:n,vMax:o}=this.getUVBounds(t),a=e.paramsUV.map((e=>{const t=i+(s-i)*e[0],a=n+(o-n)*e[1],c=this.entitiesService.gpPnt([0,0,0]);r.D0(t,a,c);const h=[c.X(),c.Y(),c.Z()];return c.delete(),h}));return r.delete(),a}normalsOnUVs(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),{uMin:i,uMax:s,vMin:n,vMax:o}=this.getUVBounds(t),a=e.paramsUV.map((e=>{const t=i+(s-i)*e[0],a=n+(o-n)*e[1],c=this.entitiesService.gpDir([0,1,0]);this.occ.GeomLib.NormEstim(r,this.entitiesService.gpPnt2d([t,a]),1e-7,c);const h=[c.X(),c.Y(),c.Z()];return c.delete(),h}));return r.delete(),a}pointOnUV(e){if(void 0===e.shape)throw Error("Face not defined");const t=e.shape,r=this.occ.BRep_Tool.Surface_2(t),i=r.get(),{uMin:s,uMax:n,vMin:o,vMax:a}=this.getUVBounds(t),c=s+(n-s)*e.paramU,h=o+(a-o)*e.paramV,d=this.entitiesService.gpPnt([0,0,0]);i.D0(c,h,d);const l=[d.X(),d.Y(),d.Z()];return d.delete(),r.delete(),l}normalOnUV(e){return this.faceNormalOnUV(e)}createPolygonFace(e){const t=this.wiresService.createPolygonWire(e),r=this.entitiesService.bRepBuilderAPIMakeFaceFromWire(t,!1);return t.delete(),r}}class x{constructor(e,t){this.occ=e,this.shapeGettersService=t}getVerticesAsPoints(e){const t=this.shapeGettersService.getVertices(e);return this.verticesToPoints({shapes:t})}verticesToPoints(e){return e.shapes.map((e=>{const t=this.occ.BRep_Tool.Pnt(e),r=[t.X(),t.Y(),t.Z()];return t.delete(),r}))}}class M{constructor(e,t,r,i){this.occ=e,this.shapeGettersService=t,this.converterService=r,this.facesService=i}getShellSurfaceArea(e){const t=this.shapeGettersService.getFaces(e);return this.facesService.getFacesAreas({shapes:t}).reduce(((e,t)=>e+t),0)}sewFaces(e){const t=new this.occ.BRepBuilderAPI_Sewing(e.tolerance,!0,!0,!0,!1);e.shapes.forEach((e=>{t.Add(e)}));const r=new this.occ.Message_ProgressRange_1;t.Perform(r);const i=t.SewedShape(),s=this.converterService.getActualTypeOfShape(i);return t.delete(),r.delete(),i.delete(),s}}class B{constructor(e,t,r,i,s,n,o,a,c){this.occ=e,this.vecHelper=t,this.iteratorService=r,this.converterService=i,this.entitiesService=s,this.transformsService=n,this.shapeGettersService=o,this.edgesService=a,this.operationsService=c}filletEdges(e){if(!e.indexes||e.indexes.length&&0===e.indexes.length){if(void 0===e.radius)throw Error("Radius not defined");const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational),r=new this.occ.TopExp_Explorer_2(e.shape,this.occ.TopAbs_ShapeEnum.TopAbs_EDGE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE),i=[];for(;r.More();){const s=this.occ.TopoDS.Edge_1(r.Current());i.push(s),t.Add_2(e.radius,s),r.Next()}const s=t.Shape();return t.delete(),r.delete(),i.forEach((e=>e.delete())),s}if(e.indexes&&e.indexes.length>0){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);let r,i=0,s=0;const n=e.indexes;if(this.iteratorService.forEachEdge(e.shape,((r,o)=>{if(n.includes(r)){let r=e.radius;if(e.radiusList&&(r=e.radiusList[s],s++),void 0===r)throw Error("Radius not defined, or radiusList not correct length");t.Add_2(r,o),i++}})),0===i)throw new Error("Fillet Edges Not Found!  Make sure you are looking at the object _before_ the Fillet is applied!");r=t.Shape(),t.delete();const o=this.converterService.getActualTypeOfShape(r);return r.delete(),o}}filletEdgesListOneRadius(e){if(e.edges&&e.edges.length>0){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);e.edges.forEach((r=>{t.Add_2(e.radius,r)}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}filletEdgesList(e){if(e.edges&&e.edges.length>0&&e.radiusList&&e.radiusList.length>0&&e.edges.length===e.radiusList.length){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);e.edges.forEach(((r,i)=>{t.Add_2(e.radiusList[i],r)}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}filletEdgeVariableRadius(e){if(e.paramsU&&e.paramsU.length>0&&e.radiusList&&e.radiusList.length>0&&e.paramsU.length===e.radiusList.length){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);this.assignVariableFilletToEdge(e,t);const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}filletEdgesSameVariableRadius(e){if(e.edges&&e.edges.length>0&&e.radiusList&&e.radiusList.length>0&&e.paramsU.length===e.radiusList.length){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);e.edges.forEach((r=>{this.assignVariableFilletToEdge({edge:r,paramsU:e.paramsU,radiusList:e.radiusList,shape:e.shape},t)}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}filletEdgesVariableRadius(e){if(e.edges&&e.edges.length>0&&e.radiusLists&&e.radiusLists.length>0&&e.paramsULists.length===e.radiusLists.length&&e.paramsULists.length===e.edges.length&&e.radiusLists.length===e.edges.length){const t=new this.occ.BRepFilletAPI_MakeFillet(e.shape,this.occ.ChFi3d_FilletShape.ChFi3d_Rational);e.edges.forEach(((r,i)=>{this.assignVariableFilletToEdge({edge:r,paramsU:e.paramsULists[i],radiusList:e.radiusLists[i],shape:e.shape},t)}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}assignVariableFilletToEdge(e,t){const r=new this.occ.TColgp_Array1OfPnt2d_2(1,e.paramsU.length);e.paramsU.forEach(((t,i)=>{r.SetValue(i+1,this.entitiesService.gpPnt2d([t,e.radiusList[i]]))})),t.Add_5(r,e.edge)}chamferEdges(e){if(!e.indexes||e.indexes.length&&0===e.indexes.length){if(void 0===e.distance)throw Error("Distance is undefined");const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape),r=new this.occ.TopExp_Explorer_2(e.shape,this.occ.TopAbs_ShapeEnum.TopAbs_EDGE,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE),i=[];for(;r.More();){const s=this.occ.TopoDS.Edge_1(r.Current());i.push(s),t.Add_2(e.distance,s),r.Next()}const s=t.Shape();return t.delete(),r.delete(),i.forEach((e=>e.delete())),s}if(e.indexes&&e.indexes.length>0){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);let r,i=0,s=0;const n=e.indexes;this.iteratorService.forEachEdge(e.shape,((r,o)=>{if(n.includes(r)){let r=e.distance;if(e.distanceList&&(r=e.distanceList[s],s++),void 0===r)throw Error("Distance not defined and/or distance list incorrect length");t.Add_2(r,o),i++}})),0===i?(console.error("Chamfer Edges Not Found!  Make sure you are looking at the object _before_ the Fillet is applied!"),r=e.shape):r=t.Shape(),t.delete();const o=this.converterService.getActualTypeOfShape(r);return r.delete(),o}}chamferEdgesList(e){if(e.edges&&e.edges.length>0&&e.distanceList&&e.distanceList.length>0&&e.edges.length===e.distanceList.length){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);e.edges.forEach(((r,i)=>{const s=e.distanceList[i];if(void 0===s)throw Error("Distance is not defined");t.Add_2(s,r)}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}chamferEdgeTwoDistances(e){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);t.Add_3(e.distance1,e.distance2,e.edge,e.face);const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}chamferEdgesTwoDistances(e){if(e.edges&&e.edges.length>0&&e.edges.length===e.faces.length){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);e.edges.forEach(((r,i)=>{t.Add_3(e.distance1,e.distance2,r,e.faces[i])}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}chamferEdgesTwoDistancesLists(e){if(e.edges&&e.edges.length>0&&e.faces&&e.faces.length>0&&e.distances1&&e.distances1.length>0&&e.distances2&&e.distances2.length>0&&e.edges.length===e.faces.length&&e.edges.length===e.distances1.length&&e.edges.length===e.distances2.length){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);e.edges.forEach(((r,i)=>{t.Add_3(e.distances1[i],e.distances2[i],r,e.faces[i])}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}chamferEdgeDistAngle(e){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape),r=this.vecHelper.degToRad(e.angle);t.AddDA(e.distance,r,e.edge,e.face);const i=t.Shape();t.delete();const s=this.converterService.getActualTypeOfShape(i);return i.delete(),s}chamferEdgesDistsAngles(e){if(e.edges&&e.edges.length>0&&e.faces&&e.faces.length>0&&e.distances&&e.distances.length>0&&e.angles&&e.angles.length>0&&e.edges.length===e.distances.length&&e.edges.length===e.faces.length&&e.edges.length===e.angles.length){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape);e.edges.forEach(((r,i)=>{const s=this.vecHelper.degToRad(e.angles[i]);t.AddDA(e.distances[i],s,r,e.faces[i])}));const r=t.Shape();t.delete();const i=this.converterService.getActualTypeOfShape(r);return r.delete(),i}}chamferEdgesDistAngle(e){if(e.edges&&e.edges.length>0&&e.faces&&e.faces.length>0&&e.edges.length===e.faces.length){const t=new this.occ.BRepFilletAPI_MakeChamfer(e.shape),r=this.vecHelper.degToRad(e.angle);e.edges.forEach(((i,s)=>{t.AddDA(e.distance,r,i,e.faces[s])}));const i=t.Shape();t.delete();const s=this.converterService.getActualTypeOfShape(i);return i.delete(),s}}fillet3DWire(e){let t=!1;if(e.radiusList&&e.radiusList.length>0&&e.indexes&&e.indexes.length>0){if(e.radiusList.length!==e.indexes.length)throw new Error("Radius list and indexes are not the same length");t=!0}let r=this.edgesService.fixEdgeOrientationsAlongWire({shape:e.shape});if(t&&e.shape.Closed_1()){const t=this.edgesService.getEdgesAlongWire({shape:e.shape}),i=t.shift(),s=[...t,i];r=this.converterService.combineEdgesAndWiresIntoAWire({shapes:s})}else r=this.converterService.getActualTypeOfShape(e.shape.Reversed());const i=this.operationsService.extrude({shape:r,direction:e.direction});let s=e.indexes;if(t){const t=e.indexes.filter((e=>e>2)),r=Math.max(...t),i=[5];let n=5;for(let e=0;e<r;e++)n+=3,i.push(n);s=e.indexes.map((t=>e.shape.Closed_1()?t<=2?t:i[t-3]:1===t?2:i[t-2]))}const n=this.filletEdges({shape:i,radius:e.radius,indexes:s,radiusList:e.radiusList}),o=[],a=this.shapeGettersService.getFaces({shape:n});a.forEach(((e,t)=>{const r=this.shapeGettersService.getEdges({shape:e})[3];o.push(r)}));const c=this.converterService.combineEdgesAndWiresIntoAWire({shapes:o}),h=this.transformsService.translate({shape:c,translation:e.direction.map((e=>-e))});return i.delete(),n.delete(),a.forEach((e=>e.delete())),o.forEach((e=>e.delete())),h}}class L{constructor(e,t,r,i,s,n,o){this.occ=e,this.shapeGettersService=t,this.facesService=r,this.enumService=i,this.entitiesService=s,this.converterService=n,this.transformsService=o}fromClosedShell(e){const t=this.converterService.getActualTypeOfShape(e.shape),r=new this.occ.BRepBuilderAPI_MakeSolid_3(t),i=r.Solid();return r.delete(),t.delete(),i}createBox(e){return this.entitiesService.bRepPrimAPIMakeBox(e.width,e.length,e.height,e.center)}createCube(e){return this.entitiesService.bRepPrimAPIMakeBox(e.size,e.size,e.size,e.center)}createBoxFromCorner(e){const t=this.entitiesService.bRepPrimAPIMakeBox(e.width,e.length,e.height,e.corner),r=this.transformsService.translate({shape:t,translation:[e.width/2,e.height/2,e.length/2]});return t.delete(),r}createCylinder(e){return this.entitiesService.bRepPrimAPIMakeCylinder(e.center,e.direction?e.direction:[0,1,0],e.radius,e.height)}createCylindersOnLines(e){return e.lines.map((t=>this.entitiesService.bRepPrimAPIMakeCylinderBetweenPoints(t.start,t.end,e.radius)))}createSphere(e){return this.entitiesService.bRepPrimAPIMakeSphere(e.center,[0,0,1],e.radius)}createCone(e){const t=this.entitiesService.gpAx2(e.center,e.direction),r=new this.occ.BRepPrimAPI_MakeCone_4(t,e.radius1,e.radius2,e.height,e.angle),i=r.Shape();return r.delete(),t.delete(),i}filterSolidPoints(e){const r=[];if(e.points.length>0){const i=new this.occ.BRepClass3d_SolidClassifier_1;return i.Load(e.shape),e.points.forEach((s=>{const n=this.entitiesService.gpPnt(s);i.Perform(n,e.tolerance);const o=i.State(),a=this.enumService.getTopAbsStateEnum(o);e.keepOn&&a===t.topAbsStateEnum.on&&r.push(s),e.keepIn&&a===t.topAbsStateEnum.in&&r.push(s),e.keepOut&&a===t.topAbsStateEnum.out&&r.push(s),e.keepUnknown&&a===t.topAbsStateEnum.unknown&&r.push(s),n.delete()})),i.delete(),r}return[]}getSolidVolume(e){const t=new this.occ.GProp_GProps_1;this.occ.BRepGProp.VolumeProperties_1(e.shape,t,!0,!1,!1);const r=t.Mass();return t.delete(),r}getSolidSurfaceArea(e){const t=this.shapeGettersService.getFaces(e);return this.facesService.getFacesAreas({shapes:t}).reduce(((e,t)=>e+t),0)}getSolidsVolumes(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getSolidVolume({shape:e})))}getSolidCenterOfMass(e){const t=new this.occ.GProp_GProps_1;this.occ.BRepGProp.VolumeProperties_1(e.shape,t,!0,!1,!1);const r=t.CentreOfMass(),i=[r.X(),r.Y(),r.Z()];return t.delete(),r.delete(),i}getSolidsCentersOfMass(e){if(void 0===e.shapes)throw Error("Shapes are not defined");return e.shapes.map((e=>this.getSolidCenterOfMass({shape:e})))}getSolids(e){return this.shapeGettersService.getSolids(e)}}class W{constructor(e,t,r){this.vecHelper=e,this.shapesHelperService=t,this.occ=r,this.occRefReturns=new w(r),this.iteratorService=new _(r),this.enumService=new y(r),this.converterService=new P(r),this.entitiesService=new A(r),this.shapeGettersService=new D(r,this.enumService,this.iteratorService),this.geomService=new F(r,this.vecHelper,this.entitiesService),this.booleansService=new C(r,this.shapeGettersService),this.transformsService=new b(r,this.converterService,this.entitiesService,this.vecHelper),this.verticesService=new x(r,this.shapeGettersService),this.edgesService=new k(r,this.occRefReturns,this.shapeGettersService,this.entitiesService,this.iteratorService,this.converterService,this.enumService,this.geomService,this.transformsService,this.vecHelper),this.wiresService=new O(r,this.occRefReturns,this.vecHelper,this.shapesHelperService,this.shapeGettersService,this.transformsService,this.enumService,this.entitiesService,this.converterService,this.geomService,this.edgesService,this.booleansService),this.facesService=new R(r,this.occRefReturns,this.entitiesService,this.enumService,this.shapeGettersService,this.converterService,this.booleansService,this.wiresService),this.shellsService=new M(r,this.shapeGettersService,this.converterService,this.facesService),this.solidsService=new L(r,this.shapeGettersService,this.facesService,this.enumService,this.entitiesService,this.converterService,this.transformsService),this.operationsService=new T(r,this.enumService,this.entitiesService,this.converterService,this.booleansService,this.shapeGettersService,this.edgesService,this.transformsService,this.vecHelper,this.wiresService,this.facesService,this.shellsService),this.filletsService=new B(r,this.vecHelper,this.iteratorService,this.converterService,this.entitiesService,this.transformsService,this.shapeGettersService,this.edgesService,this.operationsService)}surfaceFromFace(e){const t=e.shape;return this.occ.BRep_Tool.Surface_2(t).get()}}class I{constructor(e,t){this.occ=e,this.och=t}union(e){return this.och.booleansService.union(e)}difference(e){return this.och.booleansService.difference(e)}intersection(e){const t=this.och.booleansService.intersection(e);return this.och.converterService.makeCompound({shapes:t})}}class V{constructor(e,t){this.occ=e,this.och=t}saveShapeSTEP(e){const t=e.shape;let r;if(e.adjustYtoZ){const t=this.och.transformsService.rotate({shape:e.shape,axis:[1,0,0],angle:-90});r=this.och.transformsService.mirrorAlongNormal({shape:t,origin:[0,0,0],normal:[0,0,1]}),t.delete()}const i=new this.occ.STEPControl_Writer_1;let s;s=r||t;const n=new this.occ.Message_ProgressRange_1;let o,a;try{o=i.Transfer(s,this.occ.STEPControl_StepModelType.STEPControl_AsIs,!0,n)}catch(e){throw new Error("Failed when calling writer.Transfer.")}if(o!==this.occ.IFSelect_ReturnStatus.IFSelect_RetDone)throw new Error("Failed when transfering to step writer.");if(i.Write("x")!==this.occ.IFSelect_ReturnStatus.IFSelect_RetDone)throw new Error("Failed when writing step file.");{const e=this.occ.FS.readFile("/x",{encoding:"utf8"});this.occ.FS.unlink("/x"),a=e}return r&&r.delete(),n.delete(),a}loadSTEPorIGES(e){const t=e.fileName,r=e.filetext,i=(()=>{switch(t.toLowerCase().split(".").pop()){case"step":case"stp":return"step";case"iges":case"igs":return"iges";default:return}})();let s;if(this.occ.FS.createDataFile("/",`file.${i}`,r,!0,!0,!0),"step"===i)s=new this.occ.STEPControl_Reader_1;else{if("iges"!==i)return void console.error("opencascade can't parse this extension! (yet)");s=new this.occ.IGESControl_Reader_1}if(s.ReadFile(`file.${i}`)===this.occ.IFSelect_ReturnStatus.IFSelect_RetDone){const t=new this.occ.Message_ProgressRange_1;s.TransferRoots(t),t.delete();let r,n=s.OneShape();if(e.adjustZtoY){const e=this.och.transformsService.mirrorAlongNormal({shape:n,origin:[0,0,0],normal:[0,0,1]});r=this.och.transformsService.rotate({shape:e,axis:[1,0,0],angle:90}),e.delete()}return this.occ.FS.unlink(`/file.${i}`),r&&(n.delete(),n=r),n}console.error("Something in OCCT went wrong trying to read "+t)}}class N{constructor(e,t){this.occ=e,this.och=t}closestPointsBetweenTwoShapes(e){return this.och.operationsService.closestPointsBetweenTwoShapes(e.shape1,e.shape2)}closestPointsOnShapeFromPoints(e){return this.och.operationsService.closestPointsOnShapeFromPoints(e)}closestPointsOnShapesFromPoints(e){return this.och.operationsService.closestPointsOnShapesFromPoints(e)}distancesToShapeFromPoints(e){return this.och.operationsService.distancesToShapeFromPoints(e)}loft(e){return this.och.operationsService.loft(e)}loftAdvanced(e){return this.och.operationsService.loftAdvanced(e)}offset(e){return this.och.operationsService.offset(e)}offsetAdv(e){return this.och.operationsService.offsetAdv(e)}offset3DWire(e){return this.och.operationsService.offset3DWire(e)}extrudeShapes(e){return this.och.operationsService.extrudeShapes(e)}extrude(e){return this.och.operationsService.extrude(e)}splitShapeWithShapes(e){return this.och.operationsService.splitShapeWithShapes(e)}revolve(e){return this.och.operationsService.revolve(e)}rotatedExtrude(e){return this.och.operationsService.rotatedExtrude(e)}pipe(e){return this.och.operationsService.pipe(e)}pipePolylineWireNGon(e){return this.och.operationsService.pipePolylineWireNGon(e)}pipeWireCylindrical(e){return this.och.operationsService.pipeWireCylindrical(e)}pipeWiresCylindrical(e){return this.och.operationsService.pipeWiresCylindrical(e)}makeThickSolidSimple(e){return this.och.operationsService.makeThickSolidSimple(e)}makeThickSolidByJoin(e){return this.och.operationsService.makeThickSolidByJoin(e)}slice(e){return this.och.operationsService.slice(e)}sliceInStepPattern(e){return this.och.operationsService.sliceInStepPattern(e)}}class G{constructor(e,t){this.occ=e,this.och=t}transform(e){const t=this.scale({shape:e.shape,factor:e.scaleFactor}),r=this.rotate({shape:t,axis:e.rotationAxis,angle:e.rotationAngle}),i=this.translate({shape:r,translation:e.translation});return t.delete(),r.delete(),i}rotate(e){return this.och.transformsService.rotate(e)}rotateAroundCenter(e){const t=this.translate({shape:e.shape,translation:e.center.map((e=>-e))}),r=e.angle,i=this.rotate({shape:t,axis:e.axis,angle:r}),s=this.translate({shape:i,translation:e.center});return i.delete(),t.delete(),s}align(e){return this.och.transformsService.align(e)}alignAndTranslate(e){return this.och.transformsService.alignAndTranslate(e)}translate(e){return this.och.transformsService.translate(e)}scale(e){const t=new this.occ.gp_Trsf_1,r=this.och.entitiesService.gpPnt([0,0,0]);t.SetScale(r,e.factor);const i=new this.occ.BRepBuilderAPI_Transform_2(e.shape,t,!0),s=i.Shape(),n=this.och.converterService.getActualTypeOfShape(s);return r.delete(),t.delete(),i.delete(),s.delete(),n}scale3d(e){const t=this.translate({shape:e.shape,translation:e.center.map((e=>-e))}),r=new this.occ.gp_GTrsf_1,i=e.scale,s=new this.occ.gp_Mat_2(i[0],0,0,0,i[1],0,0,0,i[2]);let n;r.SetVectorialPart(s);try{const i=new this.occ.BRepBuilderAPI_GTransform_2(t,r,!1),s=new this.occ.Message_ProgressRange_1;i.Build(s);const o=i.Shape();n=this.translate({shape:o,translation:e.center}),i.delete(),o.delete(),s.delete()}catch(e){throw new Error("Could not scale the shape")}return t.delete(),r.delete(),s.delete(),n}mirror(e){return this.och.transformsService.mirror(e)}mirrorAlongNormal(e){return this.och.transformsService.mirrorAlongNormal(e)}transformShapes(e){return this.checkIfListsEqualLength([e.shapes,e.translations,e.rotationAxes,e.rotationAngles,e.scaleFactors]),e.shapes.map(((t,r)=>this.transform({shape:t,translation:e.translations[r],rotationAxis:e.rotationAxes[r],rotationAngle:e.rotationAngles[r],scaleFactor:e.scaleFactors[r]})))}rotateShapes(e){return this.checkIfListsEqualLength([e.shapes,e.axes,e.angles]),e.shapes.map(((t,r)=>this.rotate({shape:t,axis:e.axes[r],angle:e.angles[r]})))}rotateAroundCenterShapes(e){return this.checkIfListsEqualLength([e.shapes,e.axes,e.angles]),e.shapes.map(((t,r)=>this.rotateAroundCenter({shape:t,axis:e.axes[r],angle:e.angles[r],center:e.centers[r]})))}alignShapes(e){return this.checkIfListsEqualLength([e.shapes,e.fromOrigins,e.fromDirections,e.toOrigins,e.toDirections]),e.shapes.map(((t,r)=>this.align({shape:t,fromOrigin:e.fromOrigins[r],fromDirection:e.fromDirections[r],toOrigin:e.toOrigins[r],toDirection:e.toDirections[r]})))}alignAndTranslateShapes(e){return this.checkIfListsEqualLength([e.shapes,e.centers,e.directions]),e.shapes.map(((t,r)=>this.alignAndTranslate({shape:t,center:e.centers[r],direction:e.directions[r]})))}translateShapes(e){return this.checkIfListsEqualLength([e.shapes,e.translations]),e.shapes.map(((t,r)=>this.translate({shape:t,translation:e.translations[r]})))}scaleShapes(e){return this.checkIfListsEqualLength([e.shapes,e.factors]),e.shapes.map(((t,r)=>this.scale({shape:t,factor:e.factors[r]})))}scale3dShapes(e){return this.checkIfListsEqualLength([e.shapes,e.scales,e.centers]),e.shapes.map(((t,r)=>this.scale3d({shape:t,scale:e.scales[r],center:e.centers[r]})))}mirrorShapes(e){return this.checkIfListsEqualLength([e.shapes,e.directions,e.origins]),e.shapes.map(((t,r)=>this.mirror({shape:t,origin:e.origins[r],direction:e.directions[r]})))}mirrorAlongNormalShapes(e){return this.checkIfListsEqualLength([e.shapes,e.normals,e.origins]),e.shapes.map(((t,r)=>this.mirrorAlongNormal({shape:t,normal:e.normals[r],origin:e.origins[r]})))}checkIfListsEqualLength(e){const t=e[0].length;if(e.some((e=>e.length!==t)))throw new Error("Some of the list lengths are not the same. For this operation to work all lists need to be of equal length")}}class j{constructor(e,t){this.occ=e,this.och=t}filletEdges(e){return this.och.filletsService.filletEdges(e)}filletEdgesList(e){return this.och.filletsService.filletEdgesList(e)}filletEdgesListOneRadius(e){return this.och.filletsService.filletEdgesListOneRadius(e)}filletEdgeVariableRadius(e){return this.och.filletsService.filletEdgeVariableRadius(e)}filletEdgesVariableRadius(e){return this.och.filletsService.filletEdgesVariableRadius(e)}filletEdgesSameVariableRadius(e){return this.och.filletsService.filletEdgesSameVariableRadius(e)}chamferEdges(e){return this.och.filletsService.chamferEdges(e)}chamferEdgesList(e){return this.och.filletsService.chamferEdgesList(e)}chamferEdgeDistAngle(e){return this.och.filletsService.chamferEdgeDistAngle(e)}chamferEdgesDistAngle(e){return this.och.filletsService.chamferEdgesDistAngle(e)}chamferEdgesDistsAngles(e){return this.och.filletsService.chamferEdgesDistsAngles(e)}chamferEdgeTwoDistances(e){return this.och.filletsService.chamferEdgeTwoDistances(e)}chamferEdgesTwoDistances(e){return this.och.filletsService.chamferEdgesTwoDistances(e)}chamferEdgesTwoDistancesLists(e){return this.och.filletsService.chamferEdgesTwoDistancesLists(e)}filletTwoEdgesInPlaneIntoAWire(e){const t=this.och.entitiesService.gpPln(e.planeOrigin,e.planeDirection),r=new this.occ.ChFi2d_FilletAlgo_3(e.edge1,e.edge2,t);r.Perform(e.radius);const i=this.och.entitiesService.gpPnt(e.planeOrigin),s=new this.occ.TopoDS_Edge,n=new this.occ.TopoDS_Edge;let o=-1;void 0!==e.solution&&(o=e.solution);const a=r.Result(i,s,n,o),c=this.och.converterService.combineEdgesAndWiresIntoAWire({shapes:[s,a,n]});return r.delete(),i.delete(),t.delete(),s.delete(),n.delete(),a.delete(),c}fillet3DWire(e){return this.och.filletsService.fillet3DWire(e)}fillet2d(e){if(e.indexes&&e.radiusList&&e.radiusList.length!==e.indexes.length)throw new Error("When using radius list, length of the list must match index list of corners that you want to fillet.");let t,r=!1;if(e.shape.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_FACE)t=this.och.converterService.getActualTypeOfShape(e.shape),r=!0;else{if(e.shape.ShapeType()!==this.occ.TopAbs_ShapeEnum.TopAbs_WIRE)throw new Error("You can only fillet a 2d wire or a 2d face.");{const r=new this.occ.BRepBuilderAPI_MakeFace_15(e.shape,!0),i=new this.occ.Message_ProgressRange_1;r.Build(i);const s=r.Shape();t=this.och.converterService.getActualTypeOfShape(s),s.delete(),i.delete(),r.delete()}}const i=new this.occ.BRepFilletAPI_MakeFillet2d_2(t),s=new this.occ.TopExp_Explorer_2(e.shape,this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX,this.occ.TopAbs_ShapeEnum.TopAbs_SHAPE);let n=1;const o=[];for(;s.More();s.Next()){const e=this.occ.TopoDS.Vertex_1(s.Current());n%2==0&&o.push(e),n++}r||e.shape.Closed_1()||o.pop();let a=0;o.forEach(((t,r)=>{e.indexes?e.indexes.includes(r+1)&&(this.applyRadiusToVertex(e,i,t,a),a++):this.applyRadiusToVertex(e,i,t,r)}));const c=new this.occ.Message_ProgressRange_1;let h;if(i.Build(c),r)h=i.Shape();else if(i.IsDone()){const e=i.Shape(),t=this.och.shapeGettersService.getWires({shape:e});1===t.length&&(h=t[0])}else{const r=this.och.facesService.faceNormalOnUV({shape:t,paramU:.5,paramV:.5});h=this.fillet3DWire({shape:e.shape,radius:e.radius,radiusList:e.radiusList,indexes:e.indexes,direction:r})}return s.delete(),i.delete(),c.delete(),o.forEach((e=>e.delete())),h}applyRadiusToVertex(e,t,r,i){if(e.radiusList){const s=e.radiusList;t.AddFillet(r,s[i])}else e.radius&&t.AddFillet(r,e.radius)}}class U{constructor(e,t){this.occ=e,this.och=t}fixEdgeOrientationsAlongWire(e){return this.och.edgesService.fixEdgeOrientationsAlongWire(e)}basicShapeRepair(e){const t=new this.occ.ShapeFix_Shape_1;t.Init(e.shape),t.SetPrecision(e.precision),t.SetMaxTolerance(e.maxTolerance),t.SetMinTolerance(e.minTolerance);const r=new this.occ.Message_ProgressRange_1;t.Perform(r),r.delete();const i=t.Shape();return t.delete(),i}fixSmallEdgeOnWire(e){const t=new this.occ.ShapeFix_Wire_1;return t.Load_1(e.shape),t.FixSmall_1(e.lockvtx,e.precsmall),t.Perform(),t.Wire()}}class H{constructor(e,t){this.occ=e,this.och=t,this.shapes=new E(e,t),this.geom=new d(e,t),this.transforms=new G(e,t),this.operations=new N(e,t),this.booleans=new I(e,t),this.fillets=new j(e,t),this.shapeFix=new U(e,t),this.io=new V(e,t)}shapesToMeshes(e){return e.shapes.map((t=>this.shapeToMesh({shape:t,precision:e.precision,adjustYtoZ:e.adjustYtoZ})))}shapeToMesh(e){const t=[],r=[],i=[];let s=e.shape;if(s.IsNull())return{faceList:t,edgeList:r,pointsList:[]};if(this.occ.BRepTools.Clean(s,!0),e.adjustYtoZ){const t=this.och.transformsService.rotate({shape:e.shape,axis:[1,0,0],angle:-90}),r=this.och.transformsService.mirrorAlongNormal({shape:t,origin:[0,0,0],normal:[0,0,1]});t.delete(),s.delete(),s=r}const n=[],o=this.och.shapeGettersService.getFaces({shape:s});let a;o&&o.length&&(a=new this.occ.BRepMesh_IncrementalMesh_2(s,e.precision,!1,.5,!1),o.forEach(((e,r)=>{const i=new this.occ.TopLoc_Location_1,s=this.occ.BRep_Tool.Triangulation(e,i,0);if(s.IsNull())return void console.error("Encountered Null Face!");const o={vertex_coord:[],normal_coord:[],uvs:[],tri_indexes:[],vertex_coord_vec:[],number_of_triangles:0,face_index:r},a=new this.occ.Poly_Connect_2(s),c=s.get();o.vertex_coord=new Array(3*c.NbNodes()),o.vertex_coord_vec=[];for(let e=0;e<c.NbNodes();e++){const t=c.Node(e+1).Transformed(i.Transformation()),r=c.UVNode(e+1);o.uvs[2*e+0]=r.X(),o.uvs[2*e+1]=r.Y(),o.vertex_coord[3*e+0]=t.X(),o.vertex_coord[3*e+1]=t.Y(),o.vertex_coord[3*e+2]=t.Z(),o.vertex_coord_vec.push([t.X(),t.Y(),t.Z()])}const h=new this.occ.TColgp_Array1OfDir_2(1,c.NbNodes());this.occ.StdPrs_ToolTriangulatedShape.Normal(e,a,h),o.normal_coord=new Array(3*h.Length());for(let e=0;e<h.Length();e++){const t=h.Value(e+1);o.normal_coord[3*e+0]=t.X(),o.normal_coord[3*e+1]=t.Y(),o.normal_coord[3*e+2]=t.Z()}const d=e.Orientation_1(),l=s.get().Triangles();o.tri_indexes=new Array(3*l.Length());let u=0;for(let e=1;e<=s.get().NbTriangles();e++){const t=l.Value(e);let r=t.Value(1),i=t.Value(2);const s=t.Value(3);if(d!==this.occ.TopAbs_Orientation.TopAbs_FORWARD){const e=r;r=i,i=e}o.tri_indexes[3*u+0]=r-1,o.tri_indexes[3*u+1]=i-1,o.tri_indexes[3*u+2]=s-1,u++}o.number_of_triangles=u,t.push(o),n.push(s),i.delete(),h.delete(),l.delete(),a.delete()})));for(let e=0;e<n.length;e++)n[e].Nullify(),n[e].delete();this.och.shapeGettersService.getEdges({shape:s}).forEach(((t,i)=>{const s={vertex_coord:[],edge_index:-1},n=new this.occ.TopLoc_Location_1,o=new this.occ.BRepAdaptor_Curve_2(t),a=new this.occ.GCPnts_TangentialDeflection_2(o,e.precision,.1,2,1e-9,1e-7);s.vertex_coord=[];const c=a.NbPoints(),h=[];for(let e=0;e<c;e++){const t=a.Value(e+1);s.vertex_coord.push([t.X(),t.Y(),t.Z()]),h.push(t)}s.edge_index=i,r.push(s),h.forEach((e=>e.delete())),n.delete(),o.delete(),a.delete(),this.occ.BRepTools.Clean(t,!0)}));const c=this.och.shapeGettersService.getVertices({shape:s});return c.length>0&&c.forEach((e=>{const t=this.occ.BRep_Tool.Pnt(e);i.push([t.X(),t.Y(),t.Z()]),t.delete()})),a&&a.Delete(),this.occ.BRepTools.Clean(s,!0),{faceList:t,edgeList:r,pointsList:i}}}const z=(n=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,i;(e=void 0!==(e=e||{})?e:{}).ready=new Promise((function(e,r){t=e,i=r}));var s,o,a,c,h,d,l=Object.assign({},e),u=[],p="./this.program",f=(e,t)=>{throw t},v="object"==typeof window,g="function"==typeof importScripts,m="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,S="";m?(S=g?r(699).dirname(S)+"/":"//",d=()=>{h||(c=r(439),h=r(699))},s=function(e,t){return d(),e=h.normalize(e),c.readFileSync(e,t?void 0:"utf8")},a=e=>{var t=s(e,!0);return t.buffer||(t=new Uint8Array(t)),t},o=(e,t,r)=>{d(),e=h.normalize(e),c.readFile(e,(function(e,i){e?r(e):t(i.buffer)}))},process.argv.length>1&&(p=process.argv[1].replace(/\\/g,"/")),u=process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof Sr))throw e})),process.on("unhandledRejection",(function(e){throw e})),f=(e,t)=>{if(re())throw process.exitCode=e,t;var r;(r=t)instanceof Sr||w("exiting due to exception: "+r),process.exit(e)},e.inspect=function(){return"[Emscripten Module object]"}):(v||g)&&(g?S=self.location.href:"undefined"!=typeof document&&document.currentScript&&(S=document.currentScript.src),n&&(S=n),S=0!==S.indexOf("blob:")?S.substr(0,S.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(a=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o=(e,t,r)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?t(i.response):r()},i.onerror=r,i.send(null)});var E=e.print||console.log.bind(console),w=e.printErr||console.warn.bind(console);Object.assign(e,l),l=null,e.arguments&&(u=e.arguments),e.thisProgram&&(p=e.thisProgram),e.quit&&(f=e.quit);var _;function y(e){y.shown||(y.shown={}),y.shown[e]||(y.shown[e]=1,w(e))}e.wasmBinary&&(_=e.wasmBinary);var P,A=e.noExitRuntime||!0;"object"!=typeof WebAssembly&&ce("no native wasm support detected");var T,b=!1;function C(e,t){e||ce(t)}var D="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t,r){for(var i=(t>>>=0)+r,s=t;e[s]&&!(s>=i);)++s;if(s-t>16&&e.buffer&&D)return D.decode(e.subarray(t,s));for(var n="";t<s;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var c=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|c:(7&o)<<18|a<<12|c<<6|63&e[t++])<65536)n+=String.fromCharCode(o);else{var h=o-65536;n+=String.fromCharCode(55296|h>>10,56320|1023&h)}}else n+=String.fromCharCode((31&o)<<6|a)}else n+=String.fromCharCode(o)}return n}function F(e,t){return(e>>>=0)?k(L,e,t):""}function O(e,t,r,i){if(!(i>0))return 0;for(var s=r>>>=0,n=r+i-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),a<=127){if(r>=n)break;t[r++>>>0]=a}else if(a<=2047){if(r+1>=n)break;t[r++>>>0]=192|a>>6,t[r++>>>0]=128|63&a}else if(a<=65535){if(r+2>=n)break;t[r++>>>0]=224|a>>12,t[r++>>>0]=128|a>>6&63,t[r++>>>0]=128|63&a}else{if(r+3>=n)break;t[r++>>>0]=240|a>>18,t[r++>>>0]=128|a>>12&63,t[r++>>>0]=128|a>>6&63,t[r++>>>0]=128|63&a}}return t[r>>>0]=0,r-s}function R(e,t,r){return O(e,L,t,r)}function x(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:4}return t}var M,B,L,W,I,V,N,G,j,U="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function H(e,t){for(var r=e,i=r>>1,s=i+t/2;!(i>=s)&&I[i>>>0];)++i;if((r=i<<1)-e>32&&U)return U.decode(L.subarray(e>>>0,r>>>0));for(var n="",o=0;!(o>=t/2);++o){var a=W[e+2*o>>>1];if(0==a)break;n+=String.fromCharCode(a)}return n}function z(e,t,r){if(void 0===r&&(r=2147483647),r<2)return 0;for(var i=t,s=(r-=2)<2*e.length?r/2:e.length,n=0;n<s;++n){var o=e.charCodeAt(n);W[t>>>1]=o,t+=2}return W[t>>>1]=0,t-i}function $(e){return 2*e.length}function Y(e,t){for(var r=0,i="";!(r>=t/4);){var s=V[e+4*r>>>2];if(0==s)break;if(++r,s>=65536){var n=s-65536;i+=String.fromCharCode(55296|n>>10,56320|1023&n)}else i+=String.fromCharCode(s)}return i}function q(e,t,r){if(void 0===r&&(r=2147483647),r<4)return 0;for(var i=t>>>=0,s=i+r-4,n=0;n<e.length;++n){var o=e.charCodeAt(n);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++n)),V[t>>>2]=o,(t+=4)+4>s)break}return V[t>>>2]=0,t-i}function X(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t}function Z(e){var t=x(e)+1,r=lr(t);return r&&O(e,B,r,t),r}function J(t){M=t,e.HEAP8=B=new Int8Array(t),e.HEAP16=W=new Int16Array(t),e.HEAP32=V=new Int32Array(t),e.HEAPU8=L=new Uint8Array(t),e.HEAPU16=I=new Uint16Array(t),e.HEAPU32=N=new Uint32Array(t),e.HEAPF32=G=new Float32Array(t),e.HEAPF64=j=new Float64Array(t)}e.INITIAL_MEMORY;var K,Q=[],ee=[],te=[];function re(){return A}var ie=0,se=null,ne=null;function oe(t){ie++,e.monitorRunDependencies&&e.monitorRunDependencies(ie)}function ae(t){if(ie--,e.monitorRunDependencies&&e.monitorRunDependencies(ie),0==ie&&(null!==se&&(clearInterval(se),se=null),ne)){var r=ne;ne=null,r()}}function ce(t){e.onAbort&&e.onAbort(t),w(t="Aborted("+t+")"),b=!0,T=1,t+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(t);throw i(r),r}var he,de,le,ue;function pe(e){return e.startsWith("data:application/octet-stream;base64,")}function fe(e){return e.startsWith("file://")}function ve(e){try{if(e==he&&_)return new Uint8Array(_);if(a)return a(e);throw"both async and sync fetching of the wasm failed"}catch(e){ce(e)}}function ge(t){for(;t.length>0;){var r=t.shift();if("function"!=typeof r){var i=r.func;"number"==typeof i?void 0===r.arg?Se(i)():Se(i)(r.arg):i(void 0===r.arg?null:r.arg)}else r(e)}}pe(he="bitbybit-dev-occt.wasm")||(de=he,he=e.locateFile?e.locateFile(de,S):S+de);var me=[];function Se(e){var t=me[e];return t||(e>=me.length&&(me.length=e+1),me[e]=t=K.get(e)),t}function Ee(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){N[this.ptr+4>>>2]=e},this.get_type=function(){return N[this.ptr+4>>>2]},this.set_destructor=function(e){N[this.ptr+8>>>2]=e},this.get_destructor=function(){return N[this.ptr+8>>>2]},this.set_refcount=function(e){V[this.ptr>>>2]=e},this.set_caught=function(e){e=e?1:0,B[this.ptr+12>>>0]=e},this.get_caught=function(){return 0!=B[this.ptr+12>>>0]},this.set_rethrown=function(e){e=e?1:0,B[this.ptr+13>>>0]=e},this.get_rethrown=function(){return 0!=B[this.ptr+13>>>0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=V[this.ptr>>>2];V[this.ptr>>>2]=e+1},this.release_ref=function(){var e=V[this.ptr>>>2];return V[this.ptr>>>2]=e-1,1===e},this.set_adjusted_ptr=function(e){N[this.ptr+16>>>2]=e},this.get_adjusted_ptr=function(){return N[this.ptr+16>>>2]},this.get_exception_ptr=function(){if(mr(this.get_type()))return N[this.excPtr>>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var we={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var r=0,i=e.length-1;i>=0;i--){var s=e[i];"."===s?e.splice(i,1):".."===s?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=we.isAbs(e),r="/"===e.substr(-1);return(e=we.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=we.splitPath(e),r=t[0],i=t[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=we.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments,0);return we.normalize(e.join("/"))},join2:(e,t)=>we.normalize(e+"/"+t)},_e={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var i=r>=0?arguments[r]:Te.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";e=i+"/"+e,t=we.isAbs(i)}return(t?"/":"")+(e=we.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||"."},relative:(e,t)=>{function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=_e.resolve(e).substr(1),t=_e.resolve(t).substr(1);for(var i=r(e.split("/")),s=r(t.split("/")),n=Math.min(i.length,s.length),o=n,a=0;a<n;a++)if(i[a]!==s[a]){o=a;break}var c=[];for(a=o;a<i.length;a++)c.push("..");return(c=c.concat(s.slice(o))).join("/")}},ye={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){ye.ttys[e]={input:[],output:[],ops:t},Te.registerDevice(e,ye.stream_ops)},stream_ops:{open:function(e){var t=ye.ttys[e.node.rdev];if(!t)throw new Te.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,i,s){if(!e.tty||!e.tty.ops.get_char)throw new Te.ErrnoError(60);for(var n=0,o=0;o<i;o++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new Te.ErrnoError(29)}if(void 0===a&&0===n)throw new Te.ErrnoError(6);if(null==a)break;n++,t[r+o]=a}return n&&(e.node.timestamp=Date.now()),n},write:function(e,t,r,i,s){if(!e.tty||!e.tty.ops.put_char)throw new Te.ErrnoError(60);try{for(var n=0;n<i;n++)e.tty.ops.put_char(e.tty,t[r+n])}catch(e){throw new Te.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),n}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if(m){var r=Buffer.alloc(256),i=0;try{i=c.readSync(process.stdin.fd,r,0,256,-1)}catch(e){if(!e.toString().includes("EOF"))throw e;i=0}t=i>0?r.slice(0,i).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n");if(!t)return null;e.input=cr(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(E(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(E(k(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(w(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(w(k(e.output,0)),e.output=[])}}};function Pe(e){e=function(e,t){return 65536*Math.ceil(e/65536)}(e);var t=gr(65536,e);return t?(function(e,t){L.fill(0,e,e+t)}(t,e),t):0}var Ae={ops_table:null,mount:function(e){return Ae.createNode(null,"/",16895,0)},createNode:function(e,t,r,i){if(Te.isBlkdev(r)||Te.isFIFO(r))throw new Te.ErrnoError(63);Ae.ops_table||(Ae.ops_table={dir:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,lookup:Ae.node_ops.lookup,mknod:Ae.node_ops.mknod,rename:Ae.node_ops.rename,unlink:Ae.node_ops.unlink,rmdir:Ae.node_ops.rmdir,readdir:Ae.node_ops.readdir,symlink:Ae.node_ops.symlink},stream:{llseek:Ae.stream_ops.llseek}},file:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:{llseek:Ae.stream_ops.llseek,read:Ae.stream_ops.read,write:Ae.stream_ops.write,allocate:Ae.stream_ops.allocate,mmap:Ae.stream_ops.mmap,msync:Ae.stream_ops.msync}},link:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,readlink:Ae.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:Te.chrdev_stream_ops}});var s=Te.createNode(e,t,r,i);return Te.isDir(s.mode)?(s.node_ops=Ae.ops_table.dir.node,s.stream_ops=Ae.ops_table.dir.stream,s.contents={}):Te.isFile(s.mode)?(s.node_ops=Ae.ops_table.file.node,s.stream_ops=Ae.ops_table.file.stream,s.usedBytes=0,s.contents=null):Te.isLink(s.mode)?(s.node_ops=Ae.ops_table.link.node,s.stream_ops=Ae.ops_table.link.stream):Te.isChrdev(s.mode)&&(s.node_ops=Ae.ops_table.chrdev.node,s.stream_ops=Ae.ops_table.chrdev.stream),s.timestamp=Date.now(),e&&(e.contents[t]=s,e.timestamp=s.timestamp),s},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){t>>>=0;var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var i=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(i.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(t>>>=0,e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Te.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Te.isDir(e.mode)?t.size=4096:Te.isFile(e.mode)?t.size=e.usedBytes:Te.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Ae.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Te.genericErrors[44]},mknod:function(e,t,r,i){return Ae.createNode(e,t,r,i)},rename:function(e,t,r){if(Te.isDir(e.mode)){var i;try{i=Te.lookupNode(t,r)}catch(e){}if(i)for(var s in i.contents)throw new Te.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=Te.lookupNode(e,t);for(var i in r.contents)throw new Te.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var i=Ae.createNode(e,t,41471,0);return i.link=r,i},readlink:function(e){if(!Te.isLink(e.mode))throw new Te.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,i,s){var n=e.node.contents;if(s>=e.node.usedBytes)return 0;var o=Math.min(e.node.usedBytes-s,i);if(o>8&&n.subarray)t.set(n.subarray(s,s+o),r);else for(var a=0;a<o;a++)t[r+a]=n[s+a];return o},write:function(e,t,r,i,s,n){if(t.buffer===B.buffer&&(n=!1),!i)return 0;var o=e.node;if(o.timestamp=Date.now(),t.subarray&&(!o.contents||o.contents.subarray)){if(n)return o.contents=t.subarray(r,r+i),o.usedBytes=i,i;if(0===o.usedBytes&&0===s)return o.contents=t.slice(r,r+i),o.usedBytes=i,i;if(s+i<=o.usedBytes)return o.contents.set(t.subarray(r,r+i),s),i}if(Ae.expandFileStorage(o,s+i),o.contents.subarray&&t.subarray)o.contents.set(t.subarray(r,r+i),s);else for(var a=0;a<i;a++)o.contents[s+a]=t[r+a];return o.usedBytes=Math.max(o.usedBytes,s+i),i},llseek:function(e,t,r){var i=t;if(1===r?i+=e.position:2===r&&Te.isFile(e.node.mode)&&(i+=e.node.usedBytes),i<0)throw new Te.ErrnoError(28);return i},allocate:function(e,t,r){Ae.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,i,s){if(!Te.isFile(e.node.mode))throw new Te.ErrnoError(43);var n,o,a=e.node.contents;if(2&s||a.buffer!==M){if((r>0||r+t<a.length)&&(a=a.subarray?a.subarray(r,r+t):Array.prototype.slice.call(a,r,r+t)),o=!0,!(n=Pe(t)))throw new Te.ErrnoError(48);n>>>=0,B.set(a,n>>>0)}else o=!1,n=a.byteOffset;return{ptr:n,allocated:o}},msync:function(e,t,r,i,s){if(!Te.isFile(e.node.mode))throw new Te.ErrnoError(43);return 2&s||Ae.stream_ops.write(e,t,0,i,r,!1),0}}},Te={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(e,t={})=>{if(!(e=_e.resolve(Te.cwd(),e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new Te.ErrnoError(32);for(var r=we.normalizeArray(e.split("/").filter((e=>!!e)),!1),i=Te.root,s="/",n=0;n<r.length;n++){var o=n===r.length-1;if(o&&t.parent)break;if(i=Te.lookupNode(i,r[n]),s=we.join2(s,r[n]),Te.isMountpoint(i)&&(!o||o&&t.follow_mount)&&(i=i.mounted.root),!o||t.follow)for(var a=0;Te.isLink(i.mode);){var c=Te.readlink(s);if(s=_e.resolve(we.dirname(s),c),i=Te.lookupPath(s,{recurse_count:t.recurse_count+1}).node,a++>40)throw new Te.ErrnoError(32)}}return{path:s,node:i}},getPath:e=>{for(var t;;){if(Te.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:(e,t)=>{for(var r=0,i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return(e+r>>>0)%Te.nameTable.length},hashAddNode:e=>{var t=Te.hashName(e.parent.id,e.name);e.name_next=Te.nameTable[t],Te.nameTable[t]=e},hashRemoveNode:e=>{var t=Te.hashName(e.parent.id,e.name);if(Te.nameTable[t]===e)Te.nameTable[t]=e.name_next;else for(var r=Te.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:(e,t)=>{var r=Te.mayLookup(e);if(r)throw new Te.ErrnoError(r,e);for(var i=Te.hashName(e.id,t),s=Te.nameTable[i];s;s=s.name_next){var n=s.name;if(s.parent.id===e.id&&n===t)return s}return Te.lookup(e,t)},createNode:(e,t,r,i)=>{var s=new Te.FSNode(e,t,r,i);return Te.hashAddNode(s),s},destroyNode:e=>{Te.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>!(49152&~e),flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:e=>{var t=Te.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:e=>{var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>Te.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup:e=>Te.nodePermissions(e,"x")||(e.node_ops.lookup?0:2),mayCreate:(e,t)=>{try{return Te.lookupNode(e,t),20}catch(e){}return Te.nodePermissions(e,"wx")},mayDelete:(e,t,r)=>{var i;try{i=Te.lookupNode(e,t)}catch(e){return e.errno}var s=Te.nodePermissions(e,"wx");if(s)return s;if(r){if(!Te.isDir(i.mode))return 54;if(Te.isRoot(i)||Te.getPath(i)===Te.cwd())return 10}else if(Te.isDir(i.mode))return 31;return 0},mayOpen:(e,t)=>e?Te.isLink(e.mode)?32:Te.isDir(e.mode)&&("r"!==Te.flagsToPermissionString(t)||512&t)?31:Te.nodePermissions(e,Te.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd:(e=0,t=Te.MAX_OPEN_FDS)=>{for(var r=e;r<=t;r++)if(!Te.streams[r])return r;throw new Te.ErrnoError(33)},getStream:e=>Te.streams[e],createStream:(e,t,r)=>{Te.FSStream||(Te.FSStream=function(){this.shared={}},Te.FSStream.prototype={},Object.defineProperties(Te.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return!!(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}},flags:{get:function(){return this.shared.flags},set:function(e){this.shared.flags=e}},position:{get:function(){return this.shared.position},set:function(e){this.shared.position=e}}})),e=Object.assign(new Te.FSStream,e);var i=Te.nextfd(t,r);return e.fd=i,Te.streams[i]=e,e},closeStream:e=>{Te.streams[e]=null},chrdev_stream_ops:{open:e=>{var t=Te.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:()=>{throw new Te.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice:(e,t)=>{Te.devices[e]={stream_ops:t}},getDevice:e=>Te.devices[e],getMounts:e=>{for(var t=[],r=[e];r.length;){var i=r.pop();t.push(i),r.push.apply(r,i.mounts)}return t},syncfs:(e,t)=>{"function"==typeof e&&(t=e,e=!1),Te.syncFSRequests++,Te.syncFSRequests>1&&w("warning: "+Te.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=Te.getMounts(Te.root.mount),i=0;function s(e){return Te.syncFSRequests--,t(e)}function n(e){if(e)return n.errored?void 0:(n.errored=!0,s(e));++i>=r.length&&s(null)}r.forEach((t=>{if(!t.type.syncfs)return n(null);t.type.syncfs(t,e,n)}))},mount:(e,t,r)=>{var i,s="/"===r,n=!r;if(s&&Te.root)throw new Te.ErrnoError(10);if(!s&&!n){var o=Te.lookupPath(r,{follow_mount:!1});if(r=o.path,i=o.node,Te.isMountpoint(i))throw new Te.ErrnoError(10);if(!Te.isDir(i.mode))throw new Te.ErrnoError(54)}var a={type:e,opts:t,mountpoint:r,mounts:[]},c=e.mount(a);return c.mount=a,a.root=c,s?Te.root=c:i&&(i.mounted=a,i.mount&&i.mount.mounts.push(a)),c},unmount:e=>{var t=Te.lookupPath(e,{follow_mount:!1});if(!Te.isMountpoint(t.node))throw new Te.ErrnoError(28);var r=t.node,i=r.mounted,s=Te.getMounts(i);Object.keys(Te.nameTable).forEach((e=>{for(var t=Te.nameTable[e];t;){var r=t.name_next;s.includes(t.mount)&&Te.destroyNode(t),t=r}})),r.mounted=null;var n=r.mount.mounts.indexOf(i);r.mount.mounts.splice(n,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod:(e,t,r)=>{var i=Te.lookupPath(e,{parent:!0}).node,s=we.basename(e);if(!s||"."===s||".."===s)throw new Te.ErrnoError(28);var n=Te.mayCreate(i,s);if(n)throw new Te.ErrnoError(n);if(!i.node_ops.mknod)throw new Te.ErrnoError(63);return i.node_ops.mknod(i,s,t,r)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,Te.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,Te.mknod(e,t,0)),mkdirTree:(e,t)=>{for(var r=e.split("/"),i="",s=0;s<r.length;++s)if(r[s]){i+="/"+r[s];try{Te.mkdir(i,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,r)=>(void 0===r&&(r=t,t=438),t|=8192,Te.mknod(e,t,r)),symlink:(e,t)=>{if(!_e.resolve(e))throw new Te.ErrnoError(44);var r=Te.lookupPath(t,{parent:!0}).node;if(!r)throw new Te.ErrnoError(44);var i=we.basename(t),s=Te.mayCreate(r,i);if(s)throw new Te.ErrnoError(s);if(!r.node_ops.symlink)throw new Te.ErrnoError(63);return r.node_ops.symlink(r,i,e)},rename:(e,t)=>{var r,i,s=we.dirname(e),n=we.dirname(t),o=we.basename(e),a=we.basename(t);if(r=Te.lookupPath(e,{parent:!0}).node,i=Te.lookupPath(t,{parent:!0}).node,!r||!i)throw new Te.ErrnoError(44);if(r.mount!==i.mount)throw new Te.ErrnoError(75);var c,h=Te.lookupNode(r,o),d=_e.relative(e,n);if("."!==d.charAt(0))throw new Te.ErrnoError(28);if("."!==(d=_e.relative(t,s)).charAt(0))throw new Te.ErrnoError(55);try{c=Te.lookupNode(i,a)}catch(e){}if(h!==c){var l=Te.isDir(h.mode),u=Te.mayDelete(r,o,l);if(u)throw new Te.ErrnoError(u);if(u=c?Te.mayDelete(i,a,l):Te.mayCreate(i,a))throw new Te.ErrnoError(u);if(!r.node_ops.rename)throw new Te.ErrnoError(63);if(Te.isMountpoint(h)||c&&Te.isMountpoint(c))throw new Te.ErrnoError(10);if(i!==r&&(u=Te.nodePermissions(r,"w")))throw new Te.ErrnoError(u);Te.hashRemoveNode(h);try{r.node_ops.rename(h,i,a)}catch(e){throw e}finally{Te.hashAddNode(h)}}},rmdir:e=>{var t=Te.lookupPath(e,{parent:!0}).node,r=we.basename(e),i=Te.lookupNode(t,r),s=Te.mayDelete(t,r,!0);if(s)throw new Te.ErrnoError(s);if(!t.node_ops.rmdir)throw new Te.ErrnoError(63);if(Te.isMountpoint(i))throw new Te.ErrnoError(10);t.node_ops.rmdir(t,r),Te.destroyNode(i)},readdir:e=>{var t=Te.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Te.ErrnoError(54);return t.node_ops.readdir(t)},unlink:e=>{var t=Te.lookupPath(e,{parent:!0}).node;if(!t)throw new Te.ErrnoError(44);var r=we.basename(e),i=Te.lookupNode(t,r),s=Te.mayDelete(t,r,!1);if(s)throw new Te.ErrnoError(s);if(!t.node_ops.unlink)throw new Te.ErrnoError(63);if(Te.isMountpoint(i))throw new Te.ErrnoError(10);t.node_ops.unlink(t,r),Te.destroyNode(i)},readlink:e=>{var t=Te.lookupPath(e).node;if(!t)throw new Te.ErrnoError(44);if(!t.node_ops.readlink)throw new Te.ErrnoError(28);return _e.resolve(Te.getPath(t.parent),t.node_ops.readlink(t))},stat:(e,t)=>{var r=Te.lookupPath(e,{follow:!t}).node;if(!r)throw new Te.ErrnoError(44);if(!r.node_ops.getattr)throw new Te.ErrnoError(63);return r.node_ops.getattr(r)},lstat:e=>Te.stat(e,!0),chmod:(e,t,r)=>{var i;if(!(i="string"==typeof e?Te.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);i.node_ops.setattr(i,{mode:4095&t|-4096&i.mode,timestamp:Date.now()})},lchmod:(e,t)=>{Te.chmod(e,t,!0)},fchmod:(e,t)=>{var r=Te.getStream(e);if(!r)throw new Te.ErrnoError(8);Te.chmod(r.node,t)},chown:(e,t,r,i)=>{var s;if(!(s="string"==typeof e?Te.lookupPath(e,{follow:!i}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);s.node_ops.setattr(s,{timestamp:Date.now()})},lchown:(e,t,r)=>{Te.chown(e,t,r,!0)},fchown:(e,t,r)=>{var i=Te.getStream(e);if(!i)throw new Te.ErrnoError(8);Te.chown(i.node,t,r)},truncate:(e,t)=>{if(t<0)throw new Te.ErrnoError(28);var r;if(!(r="string"==typeof e?Te.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new Te.ErrnoError(63);if(Te.isDir(r.mode))throw new Te.ErrnoError(31);if(!Te.isFile(r.mode))throw new Te.ErrnoError(28);var i=Te.nodePermissions(r,"w");if(i)throw new Te.ErrnoError(i);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:(e,t)=>{var r=Te.getStream(e);if(!r)throw new Te.ErrnoError(8);if(!(2097155&r.flags))throw new Te.ErrnoError(28);Te.truncate(r.node,t)},utime:(e,t,r)=>{var i=Te.lookupPath(e,{follow:!0}).node;i.node_ops.setattr(i,{timestamp:Math.max(t,r)})},open:(t,r,i)=>{if(""===t)throw new Te.ErrnoError(44);var s;if(i=void 0===i?438:i,i=64&(r="string"==typeof r?Te.modeStringToFlags(r):r)?4095&i|32768:0,"object"==typeof t)s=t;else{t=we.normalize(t);try{s=Te.lookupPath(t,{follow:!(131072&r)}).node}catch(e){}}var n=!1;if(64&r)if(s){if(128&r)throw new Te.ErrnoError(20)}else s=Te.mknod(t,i,0),n=!0;if(!s)throw new Te.ErrnoError(44);if(Te.isChrdev(s.mode)&&(r&=-513),65536&r&&!Te.isDir(s.mode))throw new Te.ErrnoError(54);if(!n){var o=Te.mayOpen(s,r);if(o)throw new Te.ErrnoError(o)}512&r&&!n&&Te.truncate(s,0),r&=-131713;var a=Te.createStream({node:s,path:Te.getPath(s),flags:r,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return a.stream_ops.open&&a.stream_ops.open(a),!e.logReadFiles||1&r||(Te.readFiles||(Te.readFiles={}),t in Te.readFiles||(Te.readFiles[t]=1)),a},close:e=>{if(Te.isClosed(e))throw new Te.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{Te.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek:(e,t,r)=>{if(Te.isClosed(e))throw new Te.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Te.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new Te.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:(e,t,r,i,s)=>{if(r>>>=0,i<0||s<0)throw new Te.ErrnoError(28);if(Te.isClosed(e))throw new Te.ErrnoError(8);if(1==(2097155&e.flags))throw new Te.ErrnoError(8);if(Te.isDir(e.node.mode))throw new Te.ErrnoError(31);if(!e.stream_ops.read)throw new Te.ErrnoError(28);var n=void 0!==s;if(n){if(!e.seekable)throw new Te.ErrnoError(70)}else s=e.position;var o=e.stream_ops.read(e,t,r,i,s);return n||(e.position+=o),o},write:(e,t,r,i,s,n)=>{if(r>>>=0,i<0||s<0)throw new Te.ErrnoError(28);if(Te.isClosed(e))throw new Te.ErrnoError(8);if(!(2097155&e.flags))throw new Te.ErrnoError(8);if(Te.isDir(e.node.mode))throw new Te.ErrnoError(31);if(!e.stream_ops.write)throw new Te.ErrnoError(28);e.seekable&&1024&e.flags&&Te.llseek(e,0,2);var o=void 0!==s;if(o){if(!e.seekable)throw new Te.ErrnoError(70)}else s=e.position;var a=e.stream_ops.write(e,t,r,i,s,n);return o||(e.position+=a),a},allocate:(e,t,r)=>{if(Te.isClosed(e))throw new Te.ErrnoError(8);if(t<0||r<=0)throw new Te.ErrnoError(28);if(!(2097155&e.flags))throw new Te.ErrnoError(8);if(!Te.isFile(e.node.mode)&&!Te.isDir(e.node.mode))throw new Te.ErrnoError(43);if(!e.stream_ops.allocate)throw new Te.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:(e,t,r,i,s)=>{if(2&i&&!(2&s)&&2!=(2097155&e.flags))throw new Te.ErrnoError(2);if(1==(2097155&e.flags))throw new Te.ErrnoError(2);if(!e.stream_ops.mmap)throw new Te.ErrnoError(43);return e.stream_ops.mmap(e,t,r,i,s)},msync:(e,t,r,i,s)=>(r>>>=0,e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,i,s):0),munmap:e=>0,ioctl:(e,t,r)=>{if(!e.stream_ops.ioctl)throw new Te.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:(e,t={})=>{if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,i=Te.open(e,t.flags),s=Te.stat(e).size,n=new Uint8Array(s);return Te.read(i,n,0,s,0),"utf8"===t.encoding?r=k(n,0):"binary"===t.encoding&&(r=n),Te.close(i),r},writeFile:(e,t,r={})=>{r.flags=r.flags||577;var i=Te.open(e,r.flags,r.mode);if("string"==typeof t){var s=new Uint8Array(x(t)+1),n=O(t,s,0,s.length);Te.write(i,s,0,n,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Te.write(i,t,0,t.byteLength,void 0,r.canOwn)}Te.close(i)},cwd:()=>Te.currentPath,chdir:e=>{var t=Te.lookupPath(e,{follow:!0});if(null===t.node)throw new Te.ErrnoError(44);if(!Te.isDir(t.node.mode))throw new Te.ErrnoError(54);var r=Te.nodePermissions(t.node,"x");if(r)throw new Te.ErrnoError(r);Te.currentPath=t.path},createDefaultDirectories:()=>{Te.mkdir("/tmp"),Te.mkdir("/home"),Te.mkdir("/home/web_user")},createDefaultDevices:()=>{Te.mkdir("/dev"),Te.registerDevice(Te.makedev(1,3),{read:()=>0,write:(e,t,r,i,s)=>i}),Te.mkdev("/dev/null",Te.makedev(1,3)),ye.register(Te.makedev(5,0),ye.default_tty_ops),ye.register(Te.makedev(6,0),ye.default_tty1_ops),Te.mkdev("/dev/tty",Te.makedev(5,0)),Te.mkdev("/dev/tty1",Te.makedev(6,0));var e=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}if(m)try{var t=r(725);return function(){return t.randomBytes(1)[0]}}catch(e){}return function(){ce("randomDevice")}}();Te.createDevice("/dev","random",e),Te.createDevice("/dev","urandom",e),Te.mkdir("/dev/shm"),Te.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{Te.mkdir("/proc");var e=Te.mkdir("/proc/self");Te.mkdir("/proc/self/fd"),Te.mount({mount:()=>{var t=Te.createNode(e,"fd",16895,73);return t.node_ops={lookup:(e,t)=>{var r=+t,i=Te.getStream(r);if(!i)throw new Te.ErrnoError(8);var s={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path}};return s.parent=s,s}},t}},{},"/proc/self/fd")},createStandardStreams:()=>{e.stdin?Te.createDevice("/dev","stdin",e.stdin):Te.symlink("/dev/tty","/dev/stdin"),e.stdout?Te.createDevice("/dev","stdout",null,e.stdout):Te.symlink("/dev/tty","/dev/stdout"),e.stderr?Te.createDevice("/dev","stderr",null,e.stderr):Te.symlink("/dev/tty1","/dev/stderr"),Te.open("/dev/stdin",0),Te.open("/dev/stdout",1),Te.open("/dev/stderr",1)},ensureErrnoError:()=>{Te.ErrnoError||(Te.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},Te.ErrnoError.prototype=new Error,Te.ErrnoError.prototype.constructor=Te.ErrnoError,[44].forEach((e=>{Te.genericErrors[e]=new Te.ErrnoError(e),Te.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:()=>{Te.ensureErrnoError(),Te.nameTable=new Array(4096),Te.mount(Ae,{},"/"),Te.createDefaultDirectories(),Te.createDefaultDevices(),Te.createSpecialDirectories(),Te.filesystems={MEMFS:Ae}},init:(t,r,i)=>{Te.init.initialized=!0,Te.ensureErrnoError(),e.stdin=t||e.stdin,e.stdout=r||e.stdout,e.stderr=i||e.stderr,Te.createStandardStreams()},quit:()=>{Te.init.initialized=!1;for(var e=0;e<Te.streams.length;e++){var t=Te.streams[e];t&&Te.close(t)}},getMode:(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:(e,t)=>{var r=Te.analyzePath(e,t);return r.exists?r.object:null},analyzePath:(e,t)=>{try{e=(i=Te.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var i=Te.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=i.path,r.parentObject=i.node,r.name=we.basename(e),i=Te.lookupPath(e,{follow:!t}),r.exists=!0,r.path=i.path,r.object=i.node,r.name=i.node.name,r.isRoot="/"===i.path}catch(e){r.error=e.errno}return r},createPath:(e,t,r,i)=>{e="string"==typeof e?e:Te.getPath(e);for(var s=t.split("/").reverse();s.length;){var n=s.pop();if(n){var o=we.join2(e,n);try{Te.mkdir(o)}catch(e){}e=o}}return o},createFile:(e,t,r,i,s)=>{var n=we.join2("string"==typeof e?e:Te.getPath(e),t),o=Te.getMode(i,s);return Te.create(n,o)},createDataFile:(e,t,r,i,s,n)=>{var o=t;e&&(e="string"==typeof e?e:Te.getPath(e),o=t?we.join2(e,t):e);var a=Te.getMode(i,s),c=Te.create(o,a);if(r){if("string"==typeof r){for(var h=new Array(r.length),d=0,l=r.length;d<l;++d)h[d]=r.charCodeAt(d);r=h}Te.chmod(c,146|a);var u=Te.open(c,577);Te.write(u,r,0,r.length,0,n),Te.close(u),Te.chmod(c,a)}return c},createDevice:(e,t,r,i)=>{var s=we.join2("string"==typeof e?e:Te.getPath(e),t),n=Te.getMode(!!r,!!i);Te.createDevice.major||(Te.createDevice.major=64);var o=Te.makedev(Te.createDevice.major++,0);return Te.registerDevice(o,{open:e=>{e.seekable=!1},close:e=>{i&&i.buffer&&i.buffer.length&&i(10)},read:(e,t,i,s,n)=>{for(var o=0,a=0;a<s;a++){var c;try{c=r()}catch(e){throw new Te.ErrnoError(29)}if(void 0===c&&0===o)throw new Te.ErrnoError(6);if(null==c)break;o++,t[i+a]=c}return o&&(e.node.timestamp=Date.now()),o},write:(e,t,r,s,n)=>{for(var o=0;o<s;o++)try{i(t[r+o])}catch(e){throw new Te.ErrnoError(29)}return s&&(e.node.timestamp=Date.now()),o}}),Te.mkdev(s,n,o)},forceLoadFile:e=>{if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!s)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=cr(s(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new Te.ErrnoError(29)}},createLazyFile:(e,t,r,i,s)=>{function n(){this.lengthKnown=!1,this.chunks=[]}if(n.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},n.prototype.setDataGetter=function(e){this.getter=e},n.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,i=Number(e.getResponseHeader("Content-length")),s=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,n=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,o=1048576;s||(o=i);var a=this;a.setDataGetter((e=>{var t=e*o,s=(e+1)*o-1;if(s=Math.min(s,i-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>i-1)throw new Error("only "+i+" bytes available! programmer error!");var s=new XMLHttpRequest;if(s.open("GET",r,!1),i!==o&&s.setRequestHeader("Range","bytes="+e+"-"+t),s.responseType="arraybuffer",s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.send(null),!(s.status>=200&&s.status<300||304===s.status))throw new Error("Couldn't load "+r+". Status: "+s.status);return void 0!==s.response?new Uint8Array(s.response||[]):cr(s.responseText||"",!0)})(t,s)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!n&&i||(o=i=1,i=this.getter(0).length,o=i,E("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=i,this._chunkSize=o,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!g)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o=new n;Object.defineProperties(o,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:o}}else a={isDevice:!1,url:r};var c=Te.createFile(e,t,a,i,s);a.contents?c.contents=a.contents:a.url&&(c.contents=null,c.url=a.url),Object.defineProperties(c,{usedBytes:{get:function(){return this.contents.length}}});var h={};function d(e,t,r,i,s){var n=e.node.contents;if(s>=n.length)return 0;var o=Math.min(n.length-s,i);if(n.slice)for(var a=0;a<o;a++)t[r+a]=n[s+a];else for(a=0;a<o;a++)t[r+a]=n.get(s+a);return o}return Object.keys(c.stream_ops).forEach((e=>{var t=c.stream_ops[e];h[e]=function(){return Te.forceLoadFile(c),t.apply(null,arguments)}})),h.read=(e,t,r,i,s)=>(Te.forceLoadFile(c),d(e,t,r,i,s)),h.mmap=(e,t,r,i,s)=>{Te.forceLoadFile(c);var n=Pe(t);if(!n)throw new Te.ErrnoError(48);return d(e,B,n,t,r),{ptr:n,allocated:!0}},c.stream_ops=h,c},createPreloadedFile:(e,t,r,i,s,n,a,c,h,d)=>{var l=t?_e.resolve(we.join2(e,t)):e;function u(r){function o(r){d&&d(),c||Te.createDataFile(e,t,r,i,s,h),n&&n(),ae()}Nt.handledByPreloadPlugin(r,l,o,(()=>{a&&a(),ae()}))||o(r)}oe(),"string"==typeof r?function(e,t,r,i){var s="al "+e;o(e,(function(t){C(t,'Loading data file "'+e+'" failed (no arrayBuffer).'),u(new Uint8Array(t)),s&&ae()}),(function(t){if(!r)throw'Loading data file "'+e+'" failed.';r()})),s&&oe()}(r,0,a):u(r)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var i=Te.indexedDB();try{var s=i.open(Te.DB_NAME(),Te.DB_VERSION)}catch(e){return r(e)}s.onupgradeneeded=()=>{E("creating db"),s.result.createObjectStore(Te.DB_STORE_NAME)},s.onsuccess=()=>{var i=s.result.transaction([Te.DB_STORE_NAME],"readwrite"),n=i.objectStore(Te.DB_STORE_NAME),o=0,a=0,c=e.length;function h(){0==a?t():r()}e.forEach((e=>{var t=n.put(Te.analyzePath(e).object.contents,e);t.onsuccess=()=>{++o+a==c&&h()},t.onerror=()=>{a++,o+a==c&&h()}})),i.onerror=r},s.onerror=r},loadFilesFromDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var i=Te.indexedDB();try{var s=i.open(Te.DB_NAME(),Te.DB_VERSION)}catch(e){return r(e)}s.onupgradeneeded=r,s.onsuccess=()=>{var i=s.result;try{var n=i.transaction([Te.DB_STORE_NAME],"readonly")}catch(e){return void r(e)}var o=n.objectStore(Te.DB_STORE_NAME),a=0,c=0,h=e.length;function d(){0==c?t():r()}e.forEach((e=>{var t=o.get(e);t.onsuccess=()=>{Te.analyzePath(e).exists&&Te.unlink(e),Te.createDataFile(we.dirname(e),we.basename(e),t.result,!0,!0,!0),++a+c==h&&d()},t.onerror=()=>{c++,a+c==h&&d()}})),n.onerror=r},s.onerror=r}},be={DEFAULT_POLLMASK:5,calculateAt:function(e,t,r){if(we.isAbs(t))return t;var i;if(-100===e)i=Te.cwd();else{var s=Te.getStream(e);if(!s)throw new Te.ErrnoError(8);i=s.path}if(0==t.length){if(!r)throw new Te.ErrnoError(44);return i}return we.join2(i,t)},doStat:function(e,t,r){try{var i=e(t)}catch(e){if(e&&e.node&&we.normalize(t)!==we.normalize(Te.getPath(e.node)))return-54;throw e}return V[r>>>2]=i.dev,V[r+4>>>2]=0,V[r+8>>>2]=i.ino,V[r+12>>>2]=i.mode,V[r+16>>>2]=i.nlink,V[r+20>>>2]=i.uid,V[r+24>>>2]=i.gid,V[r+28>>>2]=i.rdev,V[r+32>>>2]=0,ue=[i.size>>>0,(le=i.size,+Math.abs(le)>=1?le>0?(0|Math.min(+Math.floor(le/4294967296),4294967295))>>>0:~~+Math.ceil((le-+(~~le>>>0))/4294967296)>>>0:0)],V[r+40>>>2]=ue[0],V[r+44>>>2]=ue[1],V[r+48>>>2]=4096,V[r+52>>>2]=i.blocks,V[r+56>>>2]=i.atime.getTime()/1e3|0,V[r+60>>>2]=0,V[r+64>>>2]=i.mtime.getTime()/1e3|0,V[r+68>>>2]=0,V[r+72>>>2]=i.ctime.getTime()/1e3|0,V[r+76>>>2]=0,ue=[i.ino>>>0,(le=i.ino,+Math.abs(le)>=1?le>0?(0|Math.min(+Math.floor(le/4294967296),4294967295))>>>0:~~+Math.ceil((le-+(~~le>>>0))/4294967296)>>>0:0)],V[r+80>>>2]=ue[0],V[r+84>>>2]=ue[1],0},doMsync:function(e,t,r,i,s){var n=L.slice(e,e+r);Te.msync(t,n,s,r,i)},varargs:void 0,get:function(){return be.varargs+=4,V[be.varargs-4>>>2]},getStr:function(e){return F(e)},getStreamFromFD:function(e){var t=Te.getStream(e);if(!t)throw new Te.ErrnoError(8);return t}},Ce="To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking";function De(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var ke=void 0;function Fe(e){for(var t="",r=e;L[r>>>0];)t+=ke[L[r++>>>0]];return t}var Oe={},Re={},xe={},Me=48,Be=57;function Le(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=Me&&t<=Be?"_"+e:e}function We(e,t){return e=Le(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function Ie(e,t){var r=We(t,(function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var Ve=void 0;function Ne(e){throw new Ve(e)}var Ge=void 0;function je(e){throw new Ge(e)}function Ue(e,t,r){function i(t){var i=r(t);i.length!==e.length&&je("Mismatched type converter count");for(var s=0;s<e.length;++s)He(e[s],i[s])}e.forEach((function(e){xe[e]=t}));var s=new Array(t.length),n=[],o=0;t.forEach(((e,t)=>{Re.hasOwnProperty(e)?s[t]=Re[e]:(n.push(e),Oe.hasOwnProperty(e)||(Oe[e]=[]),Oe[e].push((()=>{s[t]=Re[e],++o===n.length&&i(s)})))})),0===n.length&&i(s)}function He(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||Ne('type "'+i+'" must have a positive integer typeid pointer'),Re.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;Ne("Cannot register type '"+i+"' twice")}if(Re[e]=t,delete xe[e],Oe.hasOwnProperty(e)){var s=Oe[e];delete Oe[e],s.forEach((e=>e()))}}function ze(e){Ne(e.$$.ptrType.registeredClass.name+" instance already deleted")}var $e=!1;function Ye(e){}function qe(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function Xe(e,t,r){if(t===r)return e;if(void 0===r.baseClass)return null;var i=Xe(e,t,r.baseClass);return null===i?null:r.downcast(i)}var Ze={};var Je=[];function Ke(){for(;Je.length;){var e=Je.pop();e.$$.deleteScheduled=!1,e.delete()}}var Qe=void 0;var et={};function tt(e,t){return t.ptrType&&t.ptr||je("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&je("Both smartPtrType and smartPtr must be specified"),t.count={value:1},rt(Object.create(e,{$$:{value:t}}))}function rt(e){return"undefined"==typeof FinalizationRegistry?(rt=e=>e,e):($e=new FinalizationRegistry((e=>{qe(e.$$)})),rt=e=>{var t=e.$$;if(t.smartPtr){var r={$$:t};$e.register(e,r,e)}return e},Ye=e=>$e.unregister(e),rt(e))}function it(){}function st(e,t,r){if(void 0===e[t].overloadTable){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Ne("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function nt(t,r,i){e.hasOwnProperty(t)?((void 0===i||void 0!==e[t].overloadTable&&void 0!==e[t].overloadTable[i])&&Ne("Cannot register public name '"+t+"' twice"),st(e,t,t),e.hasOwnProperty(i)&&Ne("Cannot register multiple overloads of a function with the same number of arguments ("+i+")!"),e[t].overloadTable[i]=r):(e[t]=r,void 0!==i&&(e[t].numArguments=i))}function ot(e,t,r,i,s,n,o,a){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=s,this.getActualType=n,this.upcast=o,this.downcast=a,this.pureVirtualFunctions=[]}function at(e,t,r){for(;t!==r;)t.upcast||Ne("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function ct(e,t){if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),0;t.$$||Ne('Cannot pass "'+Dt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass;return at(t.$$.ptr,r,this.registeredClass)}function ht(e,t){var r;if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,r),r):0;t.$$||Ne('Cannot pass "'+Dt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&Ne("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var i=t.$$.ptrType.registeredClass;if(r=at(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&Ne("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:Ne("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var s=t.clone();r=this.rawShare(r,Tt.toHandle((function(){s.delete()}))),null!==e&&e.push(this.rawDestructor,r)}break;default:Ne("Unsupporting sharing policy")}return r}function dt(e,t){if(null===t)return this.isReference&&Ne("null is not a valid "+this.name),0;t.$$||Ne('Cannot pass "'+Dt(t)+'" as a '+this.name),t.$$.ptr||Ne("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&Ne("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass;return at(t.$$.ptr,r,this.registeredClass)}function lt(e){return this.fromWireType(N[e>>>2])}function ut(e,t,r,i,s,n,o,a,c,h,d){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=s,this.pointeeType=n,this.sharingPolicy=o,this.rawGetPointee=a,this.rawConstructor=c,this.rawShare=h,this.rawDestructor=d,s||void 0!==t.baseClass?this.toWireType=ht:i?(this.toWireType=ct,this.destructorFunction=null):(this.toWireType=dt,this.destructorFunction=null)}function pt(t,r){var i,s,n,o=(t=Fe(t)).includes("j")?(i=t,s=r,n=[],function(){return n.length=0,Object.assign(n,arguments),function(t,r,i){return t.includes("j")?function(t,r,i){var s=e["dynCall_"+t];return i&&i.length?s.apply(null,[r].concat(i)):s.call(null,r)}(t,r,i):Se(r).apply(null,i)}(i,s,n)}):Se(r);return"function"!=typeof o&&Ne("unknown function pointer with signature "+t+": "+r),o}var ft=void 0;function vt(e){var t=fr(e),r=Fe(t);return ur(t),r}function gt(e,t){var r=[],i={};throw t.forEach((function e(t){i[t]||Re[t]||(xe[t]?xe[t].forEach(e):(r.push(t),i[t]=!0))})),new ft(e+": "+r.map(vt).join([", "]))}function mt(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=We(e.name||"unknownFunctionName",(function(){}));r.prototype=e.prototype;var i=new r,s=e.apply(i,t);return s instanceof Object?s:i}function St(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function Et(e,t,r,i,s){var n=t.length;n<2&&Ne("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var o=null!==t[1]&&null!==r,a=!1,c=1;c<t.length;++c)if(null!==t[c]&&void 0===t[c].destructorFunction){a=!0;break}var h="void"!==t[0].name,d="",l="";for(c=0;c<n-2;++c)d+=(0!==c?", ":"")+"arg"+c,l+=(0!==c?", ":"")+"arg"+c+"Wired";var u="return function "+Le(e)+"("+d+") {\nif (arguments.length !== "+(n-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(n-2)+" args!');\n}\n";a&&(u+="var destructors = [];\n");var p=a?"destructors":"null",f=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],v=[Ne,i,s,St,t[0],t[1]];for(o&&(u+="var thisWired = classParam.toWireType("+p+", this);\n"),c=0;c<n-2;++c)u+="var arg"+c+"Wired = argType"+c+".toWireType("+p+", arg"+c+"); // "+t[c+2].name+"\n",f.push("argType"+c),v.push(t[c+2]);if(o&&(l="thisWired"+(l.length>0?", ":"")+l),u+=(h?"var rv = ":"")+"invoker(fn"+(l.length>0?", ":"")+l+");\n",a)u+="runDestructors(destructors);\n";else for(c=o?1:2;c<t.length;++c){var g=1===c?"thisWired":"arg"+(c-2)+"Wired";null!==t[c].destructorFunction&&(u+=g+"_dtor("+g+"); // "+t[c].name+"\n",f.push(g+"_dtor"),v.push(t[c].destructorFunction))}return h&&(u+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),u+="}\n",f.push(u),mt(Function,f).apply(null,v)}function wt(e,t){for(var r=[],i=0;i<e;i++)r.push(V[(t>>2)+i>>>0]);return r}function _t(e,t,r){return e instanceof Object||Ne(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||Ne(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||Ne("cannot call emscripten binding method "+r+" on deleted object"),at(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}var yt=[],Pt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function At(e){e>4&&0==--Pt[e].refcount&&(Pt[e]=void 0,yt.push(e))}var Tt={toValue:e=>(e||Ne("Cannot use deleted val. handle = "+e),Pt[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=yt.length?yt.pop():Pt.length;return Pt[t]={refcount:1,value:e},t}}};function bt(e,t,r){switch(t){case 0:return function(e){var t=r?B:L;return this.fromWireType(t[e>>>0])};case 1:return function(e){var t=r?W:I;return this.fromWireType(t[e>>>1])};case 2:return function(e){var t=r?V:N;return this.fromWireType(t[e>>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function Ct(e,t){var r=Re[e];return void 0===r&&Ne(t+" has unknown type "+vt(e)),r}function Dt(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function kt(e,t){switch(t){case 2:return function(e){return this.fromWireType(G[e>>>2])};case 3:return function(e){return this.fromWireType(j[e>>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Ft(e,t,r){switch(t){case 0:return r?function(e){return B[e>>>0]}:function(e){return L[e>>>0]};case 1:return r?function(e){return W[e>>>1]}:function(e){return I[e>>>1]};case 2:return r?function(e){return V[e>>>2]}:function(e){return N[e>>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var Ot={};function Rt(e){var t=Ot[e];return void 0===t?Fe(e):t}var xt=[];function Mt(){return"object"==typeof globalThis?globalThis:Function("return this")()}var Bt,Lt=[];function Wt(t,r){if(Nt.mainLoop.timingMode=t,Nt.mainLoop.timingValue=r,!Nt.mainLoop.func)return 1;if(Nt.mainLoop.running||(Nt.mainLoop.running=!0),0==t)Nt.mainLoop.scheduler=function(){var e=0|Math.max(0,Nt.mainLoop.tickStartTime+r-Bt());setTimeout(Nt.mainLoop.runner,e)},Nt.mainLoop.method="timeout";else if(1==t)Nt.mainLoop.scheduler=function(){Nt.requestAnimationFrame(Nt.mainLoop.runner)},Nt.mainLoop.method="rAF";else if(2==t){if("undefined"==typeof setImmediate){var i=[],s="setimmediate";addEventListener("message",(function(e){e.data!==s&&e.data.target!==s||(e.stopPropagation(),i.shift()())}),!0),setImmediate=function(t){i.push(t),g?(void 0===e.setImmediates&&(e.setImmediates=[]),e.setImmediates.push(t),postMessage({target:s})):postMessage(s,"*")}}Nt.mainLoop.scheduler=function(){setImmediate(Nt.mainLoop.runner)},Nt.mainLoop.method="immediate"}return 0}function It(e,t){if(!b)if(t)e();else try{e()}catch(e){!function(e){if(e instanceof Sr||"unwind"==e)return T;f(1,e)}(e)}}function Vt(e,t){return setTimeout((function(){It(e)}),t)}Bt=m?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now();var Nt={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){Nt.mainLoop.scheduler=null,Nt.mainLoop.currentlyRunningMainloop++},resume:function(){Nt.mainLoop.currentlyRunningMainloop++;var e=Nt.mainLoop.timingMode,t=Nt.mainLoop.timingValue,r=Nt.mainLoop.func;Nt.mainLoop.func=null,function(e,t,r,i,s){C(!Nt.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),Nt.mainLoop.func=e,Nt.mainLoop.arg=i;var n=Nt.mainLoop.currentlyRunningMainloop;function o(){return!(n<Nt.mainLoop.currentlyRunningMainloop)}Nt.mainLoop.running=!1,Nt.mainLoop.runner=function(){if(!b)if(Nt.mainLoop.queue.length>0){var t=Date.now(),r=Nt.mainLoop.queue.shift();if(r.func(r.arg),Nt.mainLoop.remainingBlockers){var i=Nt.mainLoop.remainingBlockers,s=i%1==0?i-1:Math.floor(i);r.counted?Nt.mainLoop.remainingBlockers=s:(s+=.5,Nt.mainLoop.remainingBlockers=(8*i+s)/9)}if(E('main loop blocker "'+r.name+'" took '+(Date.now()-t)+" ms"),Nt.mainLoop.updateStatus(),!o())return;setTimeout(Nt.mainLoop.runner,0)}else o()&&(Nt.mainLoop.currentFrameNumber=Nt.mainLoop.currentFrameNumber+1|0,1==Nt.mainLoop.timingMode&&Nt.mainLoop.timingValue>1&&Nt.mainLoop.currentFrameNumber%Nt.mainLoop.timingValue!=0?Nt.mainLoop.scheduler():(0==Nt.mainLoop.timingMode&&(Nt.mainLoop.tickStartTime=Bt()),Nt.mainLoop.runIter(e),o()&&("object"==typeof SDL&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),Nt.mainLoop.scheduler())))}}(r,0,0,Nt.mainLoop.arg),Wt(e,t),Nt.mainLoop.scheduler()},updateStatus:function(){if(e.setStatus){var t=e.statusMessage||"Please wait...",r=Nt.mainLoop.remainingBlockers,i=Nt.mainLoop.expectedBlockers;r?r<i?e.setStatus(t+" ("+(i-r)+"/"+i+")"):e.setStatus(t):e.setStatus("")}},runIter:function(t){if(!b){if(e.preMainLoop&&!1===e.preMainLoop())return;It(t),e.postMainLoop&&e.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(e.preloadPlugins||(e.preloadPlugins=[]),!Nt.initted){Nt.initted=!0;try{new Blob,Nt.hasBlobConstructor=!0}catch(e){Nt.hasBlobConstructor=!1,E("warning: no blob constructor, cannot create blobs with mimetypes")}Nt.BlobBuilder="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Nt.hasBlobConstructor?null:E("warning: no BlobBuilder"),Nt.URLObject="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,e.noImageDecoding||void 0!==Nt.URLObject||(E("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),e.noImageDecoding=!0);var t={canHandle:function(t){return!e.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(t)},handle:function(e,t,r,i){var s=null;if(Nt.hasBlobConstructor)try{(s=new Blob([e],{type:Nt.getMimetype(t)})).size!==e.length&&(s=new Blob([new Uint8Array(e).buffer],{type:Nt.getMimetype(t)}))}catch(e){y("Blob constructor present but fails: "+e+"; falling back to blob builder")}if(!s){var n=new Nt.BlobBuilder;n.append(new Uint8Array(e).buffer),s=n.getBlob()}var o=Nt.URLObject.createObjectURL(s),a=new Image;a.onload=()=>{C(a.complete,"Image "+t+" could not be decoded");var i=document.createElement("canvas");i.width=a.width,i.height=a.height,i.getContext("2d").drawImage(a,0,0),ir[t]=i,Nt.URLObject.revokeObjectURL(o),r&&r(e)},a.onerror=e=>{E("Image "+o+" could not be decoded"),i&&i()},a.src=o}};e.preloadPlugins.push(t);var r={canHandle:function(t){return!e.noAudioDecoding&&t.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,t,r,i){var s=!1;function n(i){s||(s=!0,sr[t]=i,r&&r(e))}function o(){s||(s=!0,sr[t]=new Audio,i&&i())}if(!Nt.hasBlobConstructor)return o();try{var a=new Blob([e],{type:Nt.getMimetype(t)})}catch(e){return o()}var c=Nt.URLObject.createObjectURL(a),h=new Audio;h.addEventListener("canplaythrough",(function(){n(h)}),!1),h.onerror=function(r){s||(E("warning: browser could not fully decode audio "+t+", trying slower base64 approach"),h.src="data:audio/x-"+t.substr(-3)+";base64,"+function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",i=0,s=0,n=0;n<e.length;n++)for(i=i<<8|e[n],s+=8;s>=6;){var o=i>>s-6&63;s-=6,r+=t[o]}return 2==s?(r+=t[(3&i)<<4],r+="=="):4==s&&(r+=t[(15&i)<<2],r+="="),r}(e),n(h))},h.src=c,Vt((function(){n(h)}),1e4)}};e.preloadPlugins.push(r);var i=e.canvas;i&&(i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock||i.msRequestPointerLock||function(){},i.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},i.exitPointerLock=i.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",s,!1),document.addEventListener("mozpointerlockchange",s,!1),document.addEventListener("webkitpointerlockchange",s,!1),document.addEventListener("mspointerlockchange",s,!1),e.elementPointerLock&&i.addEventListener("click",(function(t){!Nt.pointerLock&&e.canvas.requestPointerLock&&(e.canvas.requestPointerLock(),t.preventDefault())}),!1))}function s(){Nt.pointerLock=document.pointerLockElement===e.canvas||document.mozPointerLockElement===e.canvas||document.webkitPointerLockElement===e.canvas||document.msPointerLockElement===e.canvas}},handledByPreloadPlugin:function(t,r,i,s){Nt.init();var n=!1;return e.preloadPlugins.forEach((function(e){n||e.canHandle(r)&&(e.handle(t,r,i,s),n=!0)})),n},createContext:function(t,r,i,s){if(r&&e.ctx&&t==e.canvas)return e.ctx;var n,o;if(r){var a={antialias:!1,alpha:!1,majorVersion:1};if(s)for(var c in s)a[c]=s[c];void 0!==Yt&&(o=Yt.createContext(t,a))&&(n=Yt.getContext(o).GLctx)}else n=t.getContext("2d");return n?(i&&(r||C(void 0===rr,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.ctx=n,r&&Yt.makeContextCurrent(o),e.useWebGL=r,Nt.moduleContextCreatedCallbacks.forEach((function(e){e()})),Nt.init()),n):null},destroyContext:function(e,t,r){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(t,r){Nt.lockPointer=t,Nt.resizeCanvas=r,void 0===Nt.lockPointer&&(Nt.lockPointer=!0),void 0===Nt.resizeCanvas&&(Nt.resizeCanvas=!1);var i=e.canvas;function s(){Nt.isFullscreen=!1;var t=i.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===t?(i.exitFullscreen=Nt.exitFullscreen,Nt.lockPointer&&i.requestPointerLock(),Nt.isFullscreen=!0,Nt.resizeCanvas?Nt.setFullscreenCanvasSize():Nt.updateCanvasDimensions(i)):(t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t),Nt.resizeCanvas?Nt.setWindowedCanvasSize():Nt.updateCanvasDimensions(i)),e.onFullScreen&&e.onFullScreen(Nt.isFullscreen),e.onFullscreen&&e.onFullscreen(Nt.isFullscreen)}Nt.fullscreenHandlersInstalled||(Nt.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",s,!1),document.addEventListener("mozfullscreenchange",s,!1),document.addEventListener("webkitfullscreenchange",s,!1),document.addEventListener("MSFullscreenChange",s,!1));var n=document.createElement("div");i.parentNode.insertBefore(n,i),n.appendChild(i),n.requestFullscreen=n.requestFullscreen||n.mozRequestFullScreen||n.msRequestFullscreen||(n.webkitRequestFullscreen?function(){n.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(n.webkitRequestFullScreen?function(){n.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),n.requestFullscreen()},exitFullscreen:function(){return!!Nt.isFullscreen&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(0===Nt.nextRAF)Nt.nextRAF=t+1e3/60;else for(;t+2>=Nt.nextRAF;)Nt.nextRAF+=1e3/60;var r=Math.max(Nt.nextRAF-t,0);setTimeout(e,r)},requestAnimationFrame:function(e){"function"!=typeof requestAnimationFrame?(0,Nt.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)},safeSetTimeout:function(e){return Vt(e)},safeRequestAnimationFrame:function(e){return Nt.requestAnimationFrame((function(){It(e)}))},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(t){if(Nt.pointerLock)"mousemove"!=t.type&&"mozMovementX"in t?Nt.mouseMovementX=Nt.mouseMovementY=0:(Nt.mouseMovementX=Nt.getMovementX(t),Nt.mouseMovementY=Nt.getMovementY(t)),"undefined"!=typeof SDL?(Nt.mouseX=SDL.mouseX+Nt.mouseMovementX,Nt.mouseY=SDL.mouseY+Nt.mouseMovementY):(Nt.mouseX+=Nt.mouseMovementX,Nt.mouseY+=Nt.mouseMovementY);else{var r=e.canvas.getBoundingClientRect(),i=e.canvas.width,s=e.canvas.height,n=void 0!==window.scrollX?window.scrollX:window.pageXOffset,o=void 0!==window.scrollY?window.scrollY:window.pageYOffset;if("touchstart"===t.type||"touchend"===t.type||"touchmove"===t.type){var a=t.touch;if(void 0===a)return;var c=a.pageX-(n+r.left),h=a.pageY-(o+r.top),d={x:c*=i/r.width,y:h*=s/r.height};if("touchstart"===t.type)Nt.lastTouches[a.identifier]=d,Nt.touches[a.identifier]=d;else if("touchend"===t.type||"touchmove"===t.type){var l=Nt.touches[a.identifier];l||(l=d),Nt.lastTouches[a.identifier]=l,Nt.touches[a.identifier]=d}return}var u=t.pageX-(n+r.left),p=t.pageY-(o+r.top);u*=i/r.width,p*=s/r.height,Nt.mouseMovementX=u-Nt.mouseX,Nt.mouseMovementY=p-Nt.mouseY,Nt.mouseX=u,Nt.mouseY=p}},resizeListeners:[],updateResizeListeners:function(){var t=e.canvas;Nt.resizeListeners.forEach((function(e){e(t.width,t.height)}))},setCanvasSize:function(t,r,i){var s=e.canvas;Nt.updateCanvasDimensions(s,t,r),i||Nt.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if("undefined"!=typeof SDL){var t=N[SDL.screen>>>2];t|=8388608,V[SDL.screen>>>2]=t}Nt.updateCanvasDimensions(e.canvas),Nt.updateResizeListeners()},setWindowedCanvasSize:function(){if("undefined"!=typeof SDL){var t=N[SDL.screen>>>2];t&=-8388609,V[SDL.screen>>>2]=t}Nt.updateCanvasDimensions(e.canvas),Nt.updateResizeListeners()},updateCanvasDimensions:function(t,r,i){r&&i?(t.widthNative=r,t.heightNative=i):(r=t.widthNative,i=t.heightNative);var s=r,n=i;if(e.forcedAspectRatio&&e.forcedAspectRatio>0&&(s/n<e.forcedAspectRatio?s=Math.round(n*e.forcedAspectRatio):n=Math.round(s/e.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===t.parentNode&&"undefined"!=typeof screen){var o=Math.min(screen.width/s,screen.height/n);s=Math.round(s*o),n=Math.round(n*o)}Nt.resizeCanvas?(t.width!=s&&(t.width=s),t.height!=n&&(t.height=n),void 0!==t.style&&(t.style.removeProperty("width"),t.style.removeProperty("height"))):(t.width!=r&&(t.width=r),t.height!=i&&(t.height=i),void 0!==t.style&&(s!=r||n!=i?(t.style.setProperty("width",s+"px","important"),t.style.setProperty("height",n+"px","important")):(t.style.removeProperty("width"),t.style.removeProperty("height"))))}};function Gt(e){try{return P.grow(e-M.byteLength+65535>>>16),J(P.buffer),1}catch(e){}}var jt={};function Ut(){if(!Ut.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(var t in jt)void 0===jt[t]?delete e[t]:e[t]=jt[t];var r=[];for(var t in e)r.push(t+"="+e[t]);Ut.strings=r}return Ut.strings}function Ht(e){for(var t=e.split("."),r=0;r<4;r++){var i=Number(t[r]);if(isNaN(i))return null;t[r]=i}return(t[0]|t[1]<<8|t[2]<<16|t[3]<<24)>>>0}function zt(e){return parseInt(e)}var $t={address_map:{id:1,addrs:{},names:{}},lookup_name:function(e){var t,r=Ht(e);if(null!==r)return e;if(null!==(r=function(e){var t,r,i,s,n=[];if(!/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i.test(e))return null;if("::"===e)return[0,0,0,0,0,0,0,0];for((e=e.startsWith("::")?e.replace("::","Z:"):e.replace("::",":Z:")).indexOf(".")>0?((t=(e=e.replace(new RegExp("[.]","g"),":")).split(":"))[t.length-4]=zt(t[t.length-4])+256*zt(t[t.length-3]),t[t.length-3]=zt(t[t.length-2])+256*zt(t[t.length-1]),t=t.slice(0,t.length-2)):t=e.split(":"),i=0,s=0,r=0;r<t.length;r++)if("string"==typeof t[r])if("Z"===t[r]){for(s=0;s<8-t.length+1;s++)n[r+s]=0;i=s-1}else n[r+i]=vr(parseInt(t[r],16));else n[r+i]=t[r];return[n[1]<<16|n[0],n[3]<<16|n[2],n[5]<<16|n[4],n[7]<<16|n[6]]}(e)))return e;if($t.address_map.addrs[e])t=$t.address_map.addrs[e];else{var i=$t.address_map.id++;C(i<65535,"exceeded max address mappings of 65535"),t="172.29."+(255&i)+"."+(65280&i),$t.address_map.names[t]=e,$t.address_map.addrs[e]=t}return t},lookup_addr:function(e){return $t.address_map.names[e]?$t.address_map.names[e]:null}},Yt={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],stringCache:{},unpackAlignment:4,recordError:function(e){Yt.lastError||(Yt.lastError=e)},getNewId:function(e){for(var t=Yt.counter++,r=e.length;r<t;r++)e[r]=null;return t},getSource:function(e,t,r,i){for(var s="",n=0;n<t;++n){var o=i?V[i+4*n>>>2]:-1;s+=F(V[r+4*n>>>2],o<0?void 0:o)}return s},createContext:function(e,t){if(!e.getContextSafariWebGL2Fixed){function i(t,r){var i=e.getContextSafariWebGL2Fixed(t,r);return"webgl"==t==i instanceof WebGLRenderingContext?i:null}e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=i}var r=e.getContext("webgl",t);return r?Yt.registerContext(r,t):0},registerContext:function(e,t){var r=Yt.getNewId(Yt.contexts),i={handle:r,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=i),Yt.contexts[r]=i,(void 0===t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&Yt.initExtensions(i),r},makeContextCurrent:function(t){return Yt.currentContext=Yt.contexts[t],e.ctx=rr=Yt.currentContext&&Yt.currentContext.GLctx,!(t&&!rr)},getContext:function(e){return Yt.contexts[e]},deleteContext:function(e){Yt.currentContext===Yt.contexts[e]&&(Yt.currentContext=null),"object"==typeof JSEvents&&JSEvents.removeAllHandlersOnTarget(Yt.contexts[e].GLctx.canvas),Yt.contexts[e]&&Yt.contexts[e].GLctx.canvas&&(Yt.contexts[e].GLctx.canvas.GLctxObject=void 0),Yt.contexts[e]=null},initExtensions:function(e){if(e||(e=Yt.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t,r=e.GLctx;!function(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(e,r){t.vertexAttribDivisorANGLE(e,r)},e.drawArraysInstanced=function(e,r,i,s){t.drawArraysInstancedANGLE(e,r,i,s)},e.drawElementsInstanced=function(e,r,i,s,n){t.drawElementsInstancedANGLE(e,r,i,s,n)})}(r),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(r),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,r){t.drawBuffersWEBGL(e,r)})}(r),r.disjointTimerQueryExt=r.getExtension("EXT_disjoint_timer_query"),(t=r).multiDrawWebgl=t.getExtension("WEBGL_multi_draw"),(r.getSupportedExtensions()||[]).forEach((function(e){e.includes("lose_context")||e.includes("debug")||r.getExtension(e)}))}}};function qt(e){return"]"==e.slice(-1)&&e.lastIndexOf("[")}function Xt(e){var t=rr.currentProgram;if(t){var r=t.uniformLocsById[e];return"number"==typeof r&&(t.uniformLocsById[e]=r=rr.getUniformLocation(t,t.uniformArrayNamesById[e]+(r>0?"["+r+"]":""))),r}Yt.recordError(1282)}var Zt=[],Jt=[];function Kt(e){return e%4==0&&(e%100!=0||e%400==0)}var Qt=[31,29,31,30,31,30,31,31,30,31,30,31],er=[31,28,31,30,31,30,31,31,30,31,30,31];var tr=function(e,t,r,i){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Te.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=i};Object.defineProperties(tr.prototype,{read:{get:function(){return!(365&~this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return!(146&~this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return Te.isDir(this.mode)}},isDevice:{get:function(){return Te.isChrdev(this.mode)}}}),Te.FSNode=tr,Te.staticInit(),function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ke=e}(),Ve=e.BindingError=Ie(Error,"BindingError"),Ge=e.InternalError=Ie(Error,"InternalError"),it.prototype.isAliasOf=function(e){if(!(this instanceof it))return!1;if(!(e instanceof it))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,i=e.$$.ptrType.registeredClass,s=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)s=i.upcast(s),i=i.baseClass;return t===i&&r===s},it.prototype.clone=function(){if(this.$$.ptr||ze(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,t=rt(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},it.prototype.delete=function(){this.$$.ptr||ze(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ne("Object already scheduled for deletion"),Ye(this),qe(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},it.prototype.isDeleted=function(){return!this.$$.ptr},it.prototype.deleteLater=function(){return this.$$.ptr||ze(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Ne("Object already scheduled for deletion"),Je.push(this),1===Je.length&&Qe&&Qe(Ke),this.$$.deleteScheduled=!0,this},e.getInheritedInstanceCount=function(){return Object.keys(et).length},e.getLiveInheritedInstances=function(){var e=[];for(var t in et)et.hasOwnProperty(t)&&e.push(et[t]);return e},e.flushPendingDeletes=Ke,e.setDelayFunction=function(e){Qe=e,Je.length&&Qe&&Qe(Ke)},ut.prototype.getPointee=function(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},ut.prototype.destructor=function(e){this.rawDestructor&&this.rawDestructor(e)},ut.prototype.argPackAdvance=8,ut.prototype.readValueFromPointer=lt,ut.prototype.deleteObject=function(e){null!==e&&e.delete()},ut.prototype.fromWireType=function(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=function(e,t){return t=function(e,t){for(void 0===t&&Ne("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}(e,t),et[t]}(this.registeredClass,t);if(void 0!==r){if(0===r.$$.count.value)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function s(){return this.isSmartPointer?tt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):tt(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var n,o=this.registeredClass.getActualType(t),a=Ze[o];if(!a)return s.call(this);n=this.isConst?a.constPointerType:a.pointerType;var c=Xe(t,this.registeredClass,n.registeredClass);return null===c?s.call(this):this.isSmartPointer?tt(n.registeredClass.instancePrototype,{ptrType:n,ptr:c,smartPtrType:this,smartPtr:e}):tt(n.registeredClass.instancePrototype,{ptrType:n,ptr:c})},ft=e.UnboundTypeError=Ie(Error,"UnboundTypeError"),e.count_emval_handles=function(){for(var e=0,t=5;t<Pt.length;++t)void 0!==Pt[t]&&++e;return e},e.get_first_emval=function(){for(var e=5;e<Pt.length;++e)if(void 0!==Pt[e])return Pt[e];return null},e.requestFullscreen=function(e,t){Nt.requestFullscreen(e,t)},e.requestAnimationFrame=function(e){Nt.requestAnimationFrame(e)},e.setCanvasSize=function(e,t,r){Nt.setCanvasSize(e,t,r)},e.pauseMainLoop=function(){Nt.mainLoop.pause()},e.resumeMainLoop=function(){Nt.mainLoop.resume()},e.getUserMedia=function(){Nt.getUserMedia()},e.createContext=function(e,t,r,i){return Nt.createContext(e,t,r,i)};for(var rr,ir={},sr={},nr=new Float32Array(288),or=0;or<288;++or)Zt[or]=nr.subarray(0,or+1);var ar=new Int32Array(288);for(or=0;or<288;++or)Jt[or]=ar.subarray(0,or+1);function cr(e,t,r){var i=r>0?r:x(e)+1,s=new Array(i),n=O(e,s,0,s.length);return t&&(s.length=n),s}var hr,dr={na:function(){return e.HEAP8.length},g:function(e,t,r,i){ce("Assertion failed: "+F(e)+", at: "+[t?F(t):"unknown filename",r,i?F(i):"unknown function"])},b:function(e){return lr(e+24)+24},c:function(e,t,r){throw new Ee(e).init(t,r),e},Z:function(e,t){try{return e=be.getStr(e),Te.chmod(e,t),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},_:function(e,t,r,i){try{if(t=be.getStr(t),t=be.calculateAt(e,t),-8&r)return-28;var s=Te.lookupPath(t,{follow:!0}).node;if(!s)return-44;var n="";return 4&r&&(n+="r"),2&r&&(n+="w"),1&r&&(n+="x"),n&&Te.nodePermissions(s,n)?-2:0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},r:function(e,t,r){be.varargs=r;try{var i=be.getStreamFromFD(e);switch(t){case 0:return(s=be.get())<0?-28:Te.createStream(i,s).fd;case 1:case 2:case 6:case 7:return 0;case 3:return i.flags;case 4:var s=be.get();return i.flags|=s,0;case 5:return s=be.get(),W[s+0>>>1]=2,0;case 16:case 8:default:return-28;case 9:return 28,V[pr()>>>2]=28,-1}}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},Q:function(e,t){try{var r=be.getStreamFromFD(e);return be.doStat(Te.stat,r.path,t)}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},I:function(e,t,r){try{var i=be.getStreamFromFD(e);i.getdents||(i.getdents=Te.readdir(i.path));for(var s=280,n=0,o=Te.llseek(i,0,1),a=Math.floor(o/s);a<i.getdents.length&&n+s<=r;){var c,h,d=i.getdents[a];if("."===d)c=i.node.id,h=4;else if(".."===d)c=Te.lookupPath(i.path,{parent:!0}).node.id,h=4;else{var l=Te.lookupNode(i.node,d);c=l.id,h=Te.isChrdev(l.mode)?2:Te.isDir(l.mode)?4:Te.isLink(l.mode)?10:8}ue=[c>>>0,(le=c,+Math.abs(le)>=1?le>0?(0|Math.min(+Math.floor(le/4294967296),4294967295))>>>0:~~+Math.ceil((le-+(~~le>>>0))/4294967296)>>>0:0)],V[t+n>>>2]=ue[0],V[t+n+4>>>2]=ue[1],ue=[(a+1)*s>>>0,(le=(a+1)*s,+Math.abs(le)>=1?le>0?(0|Math.min(+Math.floor(le/4294967296),4294967295))>>>0:~~+Math.ceil((le-+(~~le>>>0))/4294967296)>>>0:0)],V[t+n+8>>>2]=ue[0],V[t+n+12>>>2]=ue[1],W[t+n+16>>>1]=280,B[t+n+18>>>0]=h,R(d,t+n+19,256),n+=s,a+=1}return Te.llseek(i,a*s,0),n}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},$:function(e,t,r){be.varargs=r;try{var i=be.getStreamFromFD(e);switch(t){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:return i.tty?0:-59;case 21519:if(!i.tty)return-59;var s=be.get();return V[s>>>2]=0,0;case 21520:return i.tty?-28:-59;case 21531:return s=be.get(),Te.ioctl(i,t,s);default:ce("bad ioctl syscall "+t)}}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},N:function(e,t){try{return e=be.getStr(e),be.doStat(Te.lstat,e,t)}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},K:function(e,t,r){try{return t=be.getStr(t),t=be.calculateAt(e,t),"/"===(t=we.normalize(t))[t.length-1]&&(t=t.substr(0,t.length-1)),Te.mkdir(t,r,0),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},O:function(e,t,r,i){try{t=be.getStr(t);var s=256&i,n=4096&i;return i&=-4353,t=be.calculateAt(e,t,n),be.doStat(s?Te.lstat:Te.stat,t,r)}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},v:function(e,t,r,i){be.varargs=i;try{t=be.getStr(t),t=be.calculateAt(e,t);var s=i?be.get():0;return Te.open(t,r,s).fd}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},H:function(e){try{return e=be.getStr(e),Te.rmdir(e),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},P:function(e,t){try{return e=be.getStr(e),be.doStat(Te.stat,e,t)}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},F:function(e,t,r){try{return t=be.getStr(t),t=be.calculateAt(e,t),0===r?Te.unlink(t):512===r?Te.rmdir(t):ce("Invalid flags passed to unlinkat"),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},W:function(e){},Y:function(e,t){ce(Ce)},X:function(e,t){ce(Ce)},B:function(e,t,r,i,s){},ba:function(e,t,r,i,s){var n=De(r);He(e,{name:t=Fe(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?i:s},argPackAdvance:8,readValueFromPointer:function(e){var i;if(1===r)i=B;else if(2===r)i=W;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+t);i=V}return this.fromWireType(i[e>>>n])},destructorFunction:null})},d:function(t,r,i,s,n,o,a,c,h,d,l,u,p){l=Fe(l),o=pt(n,o),c&&(c=pt(a,c)),d&&(d=pt(h,d)),p=pt(u,p);var f=Le(l);nt(f,(function(){gt("Cannot construct "+l+" due to unbound types",[s])})),Ue([t,r,i],s?[s]:[],(function(r){var i,n;r=r[0],n=s?(i=r.registeredClass).instancePrototype:it.prototype;var a=We(f,(function(){if(Object.getPrototypeOf(this)!==h)throw new Ve("Use 'new' to construct "+l);if(void 0===u.constructor_body)throw new Ve(l+" has no accessible constructor");var e=u.constructor_body[arguments.length];if(void 0===e)throw new Ve("Tried to invoke ctor of "+l+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(u.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),h=Object.create(n,{constructor:{value:a}});a.prototype=h;var u=new ot(l,a,h,p,i,o,c,d),v=new ut(l,u,!0,!1,!1),g=new ut(l+"*",u,!1,!1,!1),m=new ut(l+" const*",u,!1,!0,!1);return Ze[t]={pointerType:g,constPointerType:m},function(t,r,i){e.hasOwnProperty(t)||je("Replacing nonexistant public symbol"),e[t].overloadTable,e[t]=r,e[t].argCount=i}(f,a),[v,g,m]}))},f:function(e,t,r,i,s,n,o){var a=wt(r,i);t=Fe(t),n=pt(s,n),Ue([],[e],(function(e){var i=(e=e[0]).name+"."+t;function s(){gt("Cannot call "+i+" due to unbound types",a)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var c=e.registeredClass.constructor;return void 0===c[t]?(s.argCount=r-1,c[t]=s):(st(c,t,i),c[t].overloadTable[r-1]=s),Ue([],a,(function(e){var s=[e[0],null].concat(e.slice(1)),a=Et(i,s,null,n,o);return void 0===c[t].overloadTable?(a.argCount=r-1,c[t]=a):c[t].overloadTable[r-1]=a,[]})),[]}))},e:function(e,t,r,i,s,n){C(t>0);var o=wt(t,r);s=pt(i,s),Ue([],[e],(function(e){var r="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new Ve("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=()=>{gt("Cannot construct "+e.name+" due to unbound types",o)},Ue([],o,(function(i){return i.splice(1,0,null),e.registeredClass.constructor_body[t-1]=Et(r,i,null,s,n),[]})),[]}))},a:function(e,t,r,i,s,n,o,a){var c=wt(r,i);t=Fe(t),n=pt(s,n),Ue([],[e],(function(e){var i=(e=e[0]).name+"."+t;function s(){gt("Cannot call "+i+" due to unbound types",c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),a&&e.registeredClass.pureVirtualFunctions.push(t);var h=e.registeredClass.instancePrototype,d=h[t];return void 0===d||void 0===d.overloadTable&&d.className!==e.name&&d.argCount===r-2?(s.argCount=r-2,s.className=e.name,h[t]=s):(st(h,t,i),h[t].overloadTable[r-2]=s),Ue([],c,(function(s){var a=Et(i,s,e,n,o);return void 0===h[t].overloadTable?(a.argCount=r-2,h[t]=a):h[t].overloadTable[r-2]=a,[]})),[]}))},k:function(e,t,r,i,s,n,o,a,c,h){t=Fe(t),s=pt(i,s),Ue([],[e],(function(e){var i=(e=e[0]).name+"."+t,d={get:function(){gt("Cannot access "+i+" due to unbound types",[r,o])},enumerable:!0,configurable:!0};return d.set=c?()=>{gt("Cannot access "+i+" due to unbound types",[r,o])}:e=>{Ne(i+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,d),Ue([],c?[r,o]:[r],(function(r){var o=r[0],d={get:function(){var t=_t(this,e,i+" getter");return o.fromWireType(s(n,t))},enumerable:!0};if(c){c=pt(a,c);var l=r[1];d.set=function(t){var r=_t(this,e,i+" setter"),s=[];c(h,r,l.toWireType(s,t)),St(s)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,d),[]})),[]}))},aa:function(e,t){He(e,{name:t=Fe(t),fromWireType:function(e){var t=Tt.toValue(e);return At(e),t},toWireType:function(e,t){return Tt.toHandle(t)},argPackAdvance:8,readValueFromPointer:lt,destructorFunction:null})},i:function(e,t,r,i){var s=De(r);function n(){}t=Fe(t),n.values={},He(e,{name:t,constructor:n,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:8,readValueFromPointer:bt(t,s,i),destructorFunction:null}),nt(t,n)},h:function(e,t,r){var i=Ct(e,"enum");t=Fe(t);var s=i.constructor,n=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:We(i.name+"_"+t,(function(){}))}});s.values[r]=n,s[t]=n},y:function(e,t,r){var i=De(r);He(e,{name:t=Fe(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:kt(t,i),destructorFunction:null})},l:function(e,t,r,i,s){t=Fe(t),-1===s&&(s=4294967295);var n=De(r),o=e=>e;if(0===i){var a=32-8*r;o=e=>e<<a>>>a}var c=t.includes("unsigned");He(e,{name:t,fromWireType:o,toWireType:c?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:Ft(t,n,0!==i),destructorFunction:null})},j:function(e,t,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function s(e){var t=N,r=t[(e>>=2)>>>0],s=t[e+1>>>0];return new i(M,s,r)}He(e,{name:r=Fe(r),fromWireType:s,argPackAdvance:8,readValueFromPointer:s},{ignoreDuplicateRegistrations:!0})},x:function(e,t){var r="std::string"===(t=Fe(t));He(e,{name:t,fromWireType:function(e){var t,i=N[e>>>2];if(r)for(var s=e+4,n=0;n<=i;++n){var o=e+4+n;if(n==i||0==L[o>>>0]){var a=F(s,o-s);void 0===t?t=a:(t+=String.fromCharCode(0),t+=a),s=o+1}}else{var c=new Array(i);for(n=0;n<i;++n)c[n]=String.fromCharCode(L[e+4+n>>>0]);t=c.join("")}return ur(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Ne("Cannot pass non-string to std::string");var s=(r&&i?()=>x(t):()=>t.length)(),n=lr(4+s+1);if(N[(n>>>=0)>>>2]=s,r&&i)R(t,n+4,s+1);else if(i)for(var o=0;o<s;++o){var a=t.charCodeAt(o);a>255&&(ur(n),Ne("String has UTF-16 code units that do not fit in 8 bits")),L[n+4+o>>>0]=a}else for(o=0;o<s;++o)L[n+4+o>>>0]=t[o];return null!==e&&e.push(ur,n),n},argPackAdvance:8,readValueFromPointer:lt,destructorFunction:function(e){ur(e)}})},s:function(e,t,r){var i,s,n,o,a;r=Fe(r),2===t?(i=H,s=z,o=$,n=()=>I,a=1):4===t&&(i=Y,s=q,o=X,n=()=>N,a=2),He(e,{name:r,fromWireType:function(e){for(var r,s=N[e>>>2],o=n(),c=e+4,h=0;h<=s;++h){var d=e+4+h*t;if(h==s||0==o[d>>>a]){var l=i(c,d-c);void 0===r?r=l:(r+=String.fromCharCode(0),r+=l),c=d+t}}return ur(e),r},toWireType:function(e,i){"string"!=typeof i&&Ne("Cannot pass non-string to C++ string type "+r);var n=o(i),c=lr(4+n+t);return N[(c>>>=0)>>>2]=n>>a,s(i,c+4,n+t),null!==e&&e.push(ur,c),c},argPackAdvance:8,readValueFromPointer:lt,destructorFunction:function(e){ur(e)}})},ca:function(e,t){He(e,{isVoid:!0,name:t=Fe(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},T:function(){return Date.now()},S:function(){return!0},n:function(e,t,r){e=Tt.toValue(e),t=Ct(t,"emval::as");var i=[],s=Tt.toHandle(i);return V[r>>>2]=s,t.toWireType(i,e)},sa:function(e,t,r,i,s){return(e=xt[e])(t=Tt.toValue(t),r=Rt(r),function(e){var t=[];return V[e>>>2]=Tt.toHandle(t),t}(i),s)},wa:At,ta:function(e){return 0===e?Tt.toHandle(Mt()):(e=Rt(e),Tt.toHandle(Mt()[e]))},ra:function(e,t){var r=function(e,t){for(var r=new Array(e),i=0;i<e;++i)r[i]=Ct(N[t+4*i>>>2],"parameter "+i);return r}(e,t),i=r[0],s=i.name+"_$"+r.slice(1).map((function(e){return e.name})).join("_")+"$",n=Lt[s];if(void 0!==n)return n;for(var o=["retType"],a=[i],c="",h=0;h<e-1;++h)c+=(0!==h?", ":"")+"arg"+h,o.push("argType"+h),a.push(r[1+h]);var d,l,u="return function "+Le("methodCaller_"+s)+"(handle, name, destructors, args) {\n",p=0;for(h=0;h<e-1;++h)u+="    var arg"+h+" = argType"+h+".readValueFromPointer(args"+(p?"+"+p:"")+");\n",p+=r[h+1].argPackAdvance;for(u+="    var rv = handle[name]("+c+");\n",h=0;h<e-1;++h)r[h+1].deleteObject&&(u+="    argType"+h+".deleteObject(arg"+h+");\n");return i.isVoid||(u+="    return retType.toWireType(destructors, rv);\n"),u+="};\n",o.push(u),d=mt(Function,o).apply(null,a),l=xt.length,xt.push(d),n=l,Lt[s]=n,n},t:function(e,t){return e=Tt.toValue(e),t=Tt.toValue(t),Tt.toHandle(e[t])},z:function(e){e>4&&(Pt[e].refcount+=1)},qa:function(e){return Tt.toHandle(Rt(e))},ua:function(e){St(Tt.toValue(e)),At(e)},o:function(e,t,r){e=Tt.toValue(e),t=Tt.toValue(t),r=Tt.toValue(r),e[t]=r},m:function(e,t){var r=(e=Ct(e,"_emval_take_value")).readValueFromPointer(t);return Tt.toHandle(r)},va:function(e){return e=Tt.toValue(e),Tt.toHandle(typeof e)},U:function(e,t){var r=new Date(1e3*V[e>>>2]);V[t>>>2]=r.getSeconds(),V[t+4>>>2]=r.getMinutes(),V[t+8>>>2]=r.getHours(),V[t+12>>>2]=r.getDate(),V[t+16>>>2]=r.getMonth(),V[t+20>>>2]=r.getFullYear()-1900,V[t+24>>>2]=r.getDay();var i=new Date(r.getFullYear(),0,1),s=(r.getTime()-i.getTime())/864e5|0;V[t+28>>>2]=s,V[t+36>>>2]=-60*r.getTimezoneOffset();var n=new Date(r.getFullYear(),6,1).getTimezoneOffset(),o=i.getTimezoneOffset(),a=0|(n!=o&&r.getTimezoneOffset()==Math.min(o,n));V[t+32>>>2]=a},J:function(e,t,r,i,s,n){try{e>>>=0;var o=Te.getStream(s);o&&(2&r&&be.doMsync(e,o,t,i,n),Te.munmap(o))}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return-e.errno}},V:function e(t,r,i){e.called||(e.called=!0,function(e,t,r){var i=(new Date).getFullYear(),s=new Date(i,0,1),n=new Date(i,6,1),o=s.getTimezoneOffset(),a=n.getTimezoneOffset(),c=Math.max(o,a);function h(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}V[e>>>2]=60*c,V[t>>>2]=Number(o!=a);var d=h(s),l=h(n),u=Z(d),p=Z(l);a<o?(N[r>>>2]=u,N[r+4>>>2]=p):(N[r>>>2]=p,N[r+4>>>2]=u)}(t,r,i))},u:function(){ce("")},G:function(){return 4294901760},da:function(e,t,r){(0|e)===e&&(e=F(e)),e=_e.resolve(e);var i=ir[e];if(i){var s=i.getContext("2d").getImageData(0,0,i.width,i.height),n=lr(i.width*i.height*4);return L.set(s.data,n>>>0),V[t>>>2]=i.width,V[r>>>2]=i.height,n}return 0},R:function(e,t,r){L.copyWithin(e>>>0,t>>>0,t+r>>>0)},E:function(e){var t,r=L.length,i=4294901760;if((e>>>=0)>i)return!1;for(var s=1;s<=4;s*=2){var n=r*(1+.2/s);if(n=Math.min(n,e+100663296),Gt(Math.min(i,(t=Math.max(e,n))+(65536-t%65536)%65536)))return!0}return!1},L:function(e,t){var r=0;return Ut().forEach((function(i,s){var n=t+r;N[e+4*s>>>2]=n,function(e,t,r){for(var i=0;i<e.length;++i)B[t++>>>0]=e.charCodeAt(i);B[t>>>0]=0}(i,n),r+=i.length+1})),0},M:function(e,t){var r=Ut();N[e>>>2]=r.length;var i=0;return r.forEach((function(e){i+=e.length+1})),N[t>>>2]=i,0},oa:function(t){!function(t,r){var i;T=t,T=i=t,re()||(e.onExit&&e.onExit(i),b=!0),f(i,new Sr(i))}(t)},p:function(e){try{var t=be.getStreamFromFD(e);return Te.close(t),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return e.errno}},w:function(e,t,r,i){try{var s=function(e,t,r,i){for(var s=0,n=0;n<r;n++){var o=N[t>>>2],a=N[t+4>>>2];t+=8;var c=Te.read(e,B,o,a,undefined);if(c<0)return-1;if(s+=c,c<a)break}return s}(be.getStreamFromFD(e),t,r);return V[i>>>2]=s,0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return e.errno}},A:function(e,t,r,i,s){try{var n=(c=r)+2097152>>>0<4194305-!!(a=t)?(a>>>0)+4294967296*c:NaN;if(isNaN(n))return 61;var o=be.getStreamFromFD(e);return Te.llseek(o,n,i),ue=[o.position>>>0,(le=o.position,+Math.abs(le)>=1?le>0?(0|Math.min(+Math.floor(le/4294967296),4294967295))>>>0:~~+Math.ceil((le-+(~~le>>>0))/4294967296)>>>0:0)],V[s>>>2]=ue[0],V[s+4>>>2]=ue[1],o.getdents&&0===n&&0===i&&(o.getdents=null),0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return e.errno}var a,c},q:function(e,t,r,i){try{var s=function(e,t,r,i){for(var s=0,n=0;n<r;n++){var o=N[t>>>2],a=N[t+4>>>2];t+=8;var c=Te.write(e,B,o,a,undefined);if(c<0)return-1;s+=c}return s}(be.getStreamFromFD(e),t,r);return N[i>>>2]=s,0}catch(e){if(void 0===Te||!(e instanceof Te.ErrnoError))throw e;return e.errno}},pa:function(e){return function(e){var t=lr(20),r=lr(e.length+1);R(e,r,e.length+1),N[t>>>2]=r;var i=lr(4);N[i>>>2]=0,N[t+4>>>2]=i,V[t+8>>>2]=2,V[t+12>>>2]=4;var s=lr(12);return N[s>>>2]=s+8,N[s+4>>>2]=0,V[s+8>>>2]=Ht($t.lookup_name(e)),N[t+16>>>2]=s,t}(F(e))},ma:function(e,t){if(t=F(t),e=Yt.programs[e]){!function(e){var t,r,i=e.uniformLocsById,s=e.uniformSizeAndIdsByName;if(!i)for(e.uniformLocsById=i={},e.uniformArrayNamesById={},t=0;t<rr.getProgramParameter(e,35718);++t){var n=rr.getActiveUniform(e,t),o=n.name,a=n.size,c=qt(o),h=c>0?o.slice(0,c):o,d=e.uniformIdCounter;for(e.uniformIdCounter+=a,s[h]=[a,d],r=0;r<a;++r)i[d]=r,e.uniformArrayNamesById[d++]=h}}(e);var r=e.uniformLocsById,i=0,s=t,n=qt(t);n>0&&(i=zt(t.slice(n+1))>>>0,s=t.slice(0,n));var o=e.uniformSizeAndIdsByName[s];if(o&&i<o[0]&&(r[i+=o[1]]=r[i]||rr.getUniformLocation(e,t)))return i}else Yt.recordError(1281);return-1},ka:function(e,t){rr.uniform1f(Xt(e),t)},la:function(e,t){rr.uniform1i(Xt(e),t)},ga:function(e,t,r){if(t<=144)for(var i=Zt[2*t-1],s=0;s<2*t;s+=2)i[s]=G[r+4*s>>>2],i[s+1]=G[r+(4*s+4)>>>2];else i=G.subarray(r>>>2,r+8*t>>>2);rr.uniform2fv(Xt(e),i)},ja:function(e,t,r){if(t<=144)for(var i=Jt[2*t-1],s=0;s<2*t;s+=2)i[s]=V[r+4*s>>>2],i[s+1]=V[r+(4*s+4)>>>2];else i=V.subarray(r>>>2,r+8*t>>>2);rr.uniform2iv(Xt(e),i)},fa:function(e,t,r){if(t<=96)for(var i=Zt[3*t-1],s=0;s<3*t;s+=3)i[s]=G[r+4*s>>>2],i[s+1]=G[r+(4*s+4)>>>2],i[s+2]=G[r+(4*s+8)>>>2];else i=G.subarray(r>>>2,r+12*t>>>2);rr.uniform3fv(Xt(e),i)},ia:function(e,t,r){if(t<=96)for(var i=Jt[3*t-1],s=0;s<3*t;s+=3)i[s]=V[r+4*s>>>2],i[s+1]=V[r+(4*s+4)>>>2],i[s+2]=V[r+(4*s+8)>>>2];else i=V.subarray(r>>>2,r+12*t>>>2);rr.uniform3iv(Xt(e),i)},ea:function(e,t,r){if(t<=72){var i=Zt[4*t-1],s=G;r>>=2;for(var n=0;n<4*t;n+=4){var o=r+n;i[n]=s[o>>>0],i[n+1]=s[o+1>>>0],i[n+2]=s[o+2>>>0],i[n+3]=s[o+3>>>0]}}else i=G.subarray(r>>>2,r+16*t>>>2);rr.uniform4fv(Xt(e),i)},ha:function(e,t,r){if(t<=72)for(var i=Jt[4*t-1],s=0;s<4*t;s+=4)i[s]=V[r+4*s>>>2],i[s+1]=V[r+(4*s+4)>>>2],i[s+2]=V[r+(4*s+8)>>>2],i[s+3]=V[r+(4*s+12)>>>2];else i=V.subarray(r>>>2,r+16*t>>>2);rr.uniform4iv(Xt(e),i)},C:function(e){},D:function(e,t,r,i){return function(e,t,r,i){var s=V[i+40>>>2],n={tm_sec:V[i>>>2],tm_min:V[i+4>>>2],tm_hour:V[i+8>>>2],tm_mday:V[i+12>>>2],tm_mon:V[i+16>>>2],tm_year:V[i+20>>>2],tm_wday:V[i+24>>>2],tm_yday:V[i+28>>>2],tm_isdst:V[i+32>>>2],tm_gmtoff:V[i+36>>>2],tm_zone:s?F(s):""},o=F(r),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var c in a)o=o.replace(new RegExp(c,"g"),a[c]);var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function l(e,t,r){for(var i="number"==typeof e?e.toString():e||"";i.length<t;)i=r[0]+i;return i}function u(e,t){return l(e,t,"0")}function p(e,t){function r(e){return e<0?-1:e>0?1:0}var i;return 0===(i=r(e.getFullYear()-t.getFullYear()))&&0===(i=r(e.getMonth()-t.getMonth()))&&(i=r(e.getDate()-t.getDate())),i}function f(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function v(e){var t=function(e,t){for(var r=new Date(e.getTime());t>0;){var i=Kt(r.getFullYear()),s=r.getMonth(),n=(i?Qt:er)[s];if(!(t>n-r.getDate()))return r.setDate(r.getDate()+t),r;t-=n-r.getDate()+1,r.setDate(1),s<11?r.setMonth(s+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r}(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),i=new Date(t.getFullYear()+1,0,4),s=f(r),n=f(i);return p(s,t)<=0?p(n,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var g={"%a":function(e){return h[e.tm_wday].substring(0,3)},"%A":function(e){return h[e.tm_wday]},"%b":function(e){return d[e.tm_mon].substring(0,3)},"%B":function(e){return d[e.tm_mon]},"%C":function(e){return u((e.tm_year+1900)/100|0,2)},"%d":function(e){return u(e.tm_mday,2)},"%e":function(e){return l(e.tm_mday,2," ")},"%g":function(e){return v(e).toString().substring(2)},"%G":function(e){return v(e)},"%H":function(e){return u(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),u(t,2)},"%j":function(e){return u(e.tm_mday+function(e,t){for(var r=0,i=0;i<=t;r+=e[i++]);return r}(Kt(e.tm_year+1900)?Qt:er,e.tm_mon-1),3)},"%m":function(e){return u(e.tm_mon+1,2)},"%M":function(e){return u(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return u(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=e.tm_yday+7-e.tm_wday;return u(Math.floor(t/7),2)},"%V":function(e){var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var r=(e.tm_wday+371-e.tm_yday)%7;4==r||3==r&&Kt(e.tm_year)||(t=1)}}else{t=52;var i=(e.tm_wday+7-e.tm_yday-1)%7;(4==i||5==i&&Kt(e.tm_year%400-1))&&t++}return u(t,2)},"%w":function(e){return e.tm_wday},"%W":function(e){var t=e.tm_yday+7-(e.tm_wday+6)%7;return u(Math.floor(t/7),2)},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var c in o=o.replace(/%%/g,"\0\0"),g)o.includes(c)&&(o=o.replace(new RegExp(c,"g"),g[c](n)));var m=cr(o=o.replace(/\0\0/g,"%"),!1);return m.length>t?0:(function(e,t){B.set(e,t>>>0)}(m,e),m.length-1)}(e,t,r,i)}},lr=(function(){var t={a:dr};function r(t,r){var i,s=t.exports;e.asm=s,J((P=e.asm.xa).buffer),K=e.asm.Ea,i=e.asm.ya,ee.unshift(i),ae()}function s(e){r(e.instance)}function n(e){return function(){if(!_&&(v||g)){if("function"==typeof fetch&&!fe(he))return fetch(he,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+he+"'";return e.arrayBuffer()})).catch((function(){return ve(he)}));if(o)return new Promise((function(e,t){o(he,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ve(he)}))}().then((function(e){return WebAssembly.instantiate(e,t)})).then((function(e){return e})).then(e,(function(e){w("failed to asynchronously prepare wasm: "+e),ce(e)}))}if(oe(),e.instantiateWasm)try{return e.instantiateWasm(t,r)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}(_||"function"!=typeof WebAssembly.instantiateStreaming||pe(he)||fe(he)||m||"function"!=typeof fetch?n(s):fetch(he,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(s,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),n(s)}))}))).catch(i)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.ya).apply(null,arguments)},e._malloc=function(){return(lr=e._malloc=e.asm.za).apply(null,arguments)}),ur=e._free=function(){return(ur=e._free=e.asm.Aa).apply(null,arguments)},pr=e.___errno_location=function(){return(pr=e.___errno_location=e.asm.Ba).apply(null,arguments)},fr=e.___getTypeName=function(){return(fr=e.___getTypeName=e.asm.Ca).apply(null,arguments)},vr=(e.___embind_register_native_and_builtin_types=function(){return(e.___embind_register_native_and_builtin_types=e.asm.Da).apply(null,arguments)},e._htons=function(){return(vr=e._htons=e.asm.Fa).apply(null,arguments)}),gr=e._emscripten_builtin_memalign=function(){return(gr=e._emscripten_builtin_memalign=e.asm.Ga).apply(null,arguments)},mr=e.___cxa_is_pointer_type=function(){return(mr=e.___cxa_is_pointer_type=e.asm.Ha).apply(null,arguments)};function Sr(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Er(r){function i(){hr||(hr=!0,e.calledRun=!0,b||(e.noFSInit||Te.init.initialized||Te.init(),Te.ignorePermissions=!1,ye.init(),ge(ee),t(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),te.unshift(t);var t;ge(te)}()))}r=r||u,ie>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),Q.unshift(t);var t;ge(Q)}(),ie>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),i()}),1)):i()))}if(e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.Ia).apply(null,arguments)},e.dynCall_viijii=function(){return(e.dynCall_viijii=e.asm.Ja).apply(null,arguments)},e.dynCall_iiiiij=function(){return(e.dynCall_iiiiij=e.asm.Ka).apply(null,arguments)},e.dynCall_iiiiijj=function(){return(e.dynCall_iiiiijj=e.asm.La).apply(null,arguments)},e.dynCall_iiiiiijj=function(){return(e.dynCall_iiiiiijj=e.asm.Ma).apply(null,arguments)},e.dynCall_viiiiji=function(){return(e.dynCall_viiiiji=e.asm.Na).apply(null,arguments)},e.dynCall_viiijj=function(){return(e.dynCall_viiijj=e.asm.Oa).apply(null,arguments)},e.FS=Te,ne=function e(){hr||Er(),hr||(ne=e)},e.run=Er,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Er(),e.ready});class ${constructor(e){this.occ=e,this.hashesFromPreviousRun={},this.usedHashes={},this.argCache={}}cleanAllCache(){Object.keys(this.usedHashes).forEach((e=>{if(this.argCache[e])try{const t=this.argCache[e];this.occ.BRepTools.Clean(t,!0),this.occ.BRepTools.CleanGeometry(t),t.delete()}catch(e){}})),this.argCache={},this.usedHashes={},this.hashesFromPreviousRun={}}cleanCacheForHash(e){if(this.argCache[e])try{const t=this.argCache[e];this.occ.BRepTools.Clean(t,!0),this.occ.BRepTools.CleanGeometry(t),t.delete()}catch(e){}delete this.argCache[e],delete this.usedHashes[e],delete this.hashesFromPreviousRun[e]}cleanUpCache(){}isOCCTObject(e){return null!=e&&!Array.isArray(e)&&void 0!==e.$$||Array.isArray(e)&&e.length>0&&void 0!==e[0].$$}cacheOp(e,t){let r=null;const i=this.computeHash(e);this.usedHashes[i]=i,this.hashesFromPreviousRun[i]=i;const s=this.checkCache(i);if(s)this.isOCCTObject(s)?(r=s,r.hash=s.hash):s.value&&(r=s.value);else if(r=t(),Array.isArray(r)&&this.isOCCTObject(r))r.forEach(((t,r)=>{const i=this.computeHash(Object.assign(Object.assign({},e),{index:r}));t.hash=i,this.addToCache(i,t)}));else if(this.isOCCTObject(r))r.hash=i,this.addToCache(i,r);else if(r.compound&&r.data&&r.shapes&&r.shapes.length>0){const t=r,s=this.computeHash(Object.assign(Object.assign({},e),{index:"compound"}));t.compound.hash=s,this.addToCache(s,t.compound),t.shapes.forEach(((t,r)=>{const i=this.computeHash(Object.assign(Object.assign({},e),{index:r}));t.shape.hash=i,this.addToCache(i,t.shape)})),this.addToCache(i,{value:t})}else this.addToCache(i,{value:r});return r}checkCache(e){return this.argCache[e]||null}addToCache(e,t){const r=t;return r.hash=e,this.argCache[e]=r,e}computeHash(e,t){let r=JSON.stringify(e);r=r.replace(/(\"ptr\"\:(-?[0-9]*?)\,)/g,""),r=r.replace(/(\"ptr\"\:(-?[0-9]*))/g,""),r.includes("ptr")&&console.error("YOU DONE MESSED UP YOUR REGEX.");const i=Math.random.toString()+r;return t?i:this.stringToHash(i)}stringToHash(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}remove(e,t){return e.filter((e=>e.hash!==t.hash||e.ptr!==t.ptr))}dupShape(e){return e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_WIRE?this.occ.TopoDS.Wire_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_SHELL?this.occ.TopoDS.Shell_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_EDGE?this.occ.TopoDS.Edge_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_SOLID?this.occ.TopoDS.Solid_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_FACE?this.occ.TopoDS.Face_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_COMPOUND?this.occ.TopoDS.Compound_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_COMPSOLID?this.occ.TopoDS.CompSolid_1(e):e.ShapeType()===this.occ.TopAbs_ShapeEnum.TopAbs_VERTEX?this.occ.TopoDS.Vertex_1(e):void 0}}let Y,q,X;var Z,J,K,Q,ee,te,re,ie,se,ne,oe,ae=function(){return ae=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},ae.apply(this,arguments)},ce=function(e,t,r,i){return new(r||(r=Promise))((function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},he=function(e,t){var r,i,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,a[0]&&(o=0)),o;)try{if(r=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};(Z={},J=Z.mainJS,K=void 0===J?z:J,Q=Z.mainWasm,ee=void 0===Q?"https://cdn.jsdelivr.net/gh/bitbybit-dev/bitbybit-assets@0.14.7.3/wasm/bitbybit-dev-occt.06080bd9.wasm":Q,te=Z.worker,re=void 0===te?void 0:te,ie=Z.libs,se=void 0===ie?[]:ie,ne=Z.module,oe=void 0===ne?{}:ne,new Promise((function(e,t){new K(ae({locateFile:function(e){return e.endsWith(".wasm")?ee:e.endsWith(".worker.js")&&re?re:e}},oe)).then((function(t){return ce(void 0,void 0,void 0,(function(){var r,i,s;return he(this,(function(n){switch(n.label){case 0:r=0,i=se,n.label=1;case 1:return r<i.length?(s=i[r],[4,t.loadDynamicLibrary(s,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!1})]):[3,4];case 2:n.sent(),n.label=3;case 3:return r++,[3,1];case 4:return e(t),[2]}}))}))}))}))).then((function(e){return ce(void 0,void 0,void 0,(function(){return he(this,(function(t){return postMessage("occ-initialised"),((e,t,r)=>{q=new $(e);const i=new a,s=new o;Y=new H(e,new W(i,s,e)),t&&(Y.plugins=t,X&&Object.keys(X).forEach((e=>{Y.plugins.dependencies[e]=X[e]}))),postMessage("occ-initialised")})(e,{}),[2]}))}))})),addEventListener("message",(function(e){((e,t)=>{let r;t("busy");try{if("shapeToMesh"!==e.action.functionName&&"shapesToMeshes"!==e.action.functionName&&"deleteShape"!==e.action.functionName&&"deleteShapes"!==e.action.functionName&&"startedTheRun"!==e.action.functionName&&"cleanAllCache"!==e.action.functionName&&"addOc"!==e.action.functionName&&"saveShapeSTEP"!==e.action.functionName){Object.keys(e.action.inputs).forEach((t=>{const r=e.action.inputs[t];r&&r.type&&"occ-shape"===r.type&&r.hash&&(e.action.inputs[t]=q.checkCache(e.action.inputs[t].hash)),r&&Array.isArray(r)&&r.length>0&&(r[0].type&&"occ-shape"===r[0].type&&r[0].hash?e.action.inputs[t]=e.action.inputs[t].map((e=>q.checkCache(e.hash))):Array.isArray(r[0])&&r[0][0].type&&"occ-shape"===r[0][0].type&&r[0][0].hash&&(e.action.inputs[t]=e.action.inputs[t].map((e=>e.map((e=>q.checkCache(e.hash)))))))}));const t=e.action.functionName.split(".");let i;if(i=3===t.length?q.cacheOp(e.action,(()=>Y[t[0]][t[1]][t[2]](e.action.inputs))):2===t.length?q.cacheOp(e.action,(()=>Y[t[0]][t[1]](e.action.inputs))):q.cacheOp(e.action,(()=>Y[e.action.functionName](e.action.inputs))),q.isOCCTObject(i))r=Array.isArray(i)?i.map((e=>({hash:e.hash,type:"occ-shape"}))):{hash:i.hash,type:"occ-shape"};else if(i.compound&&i.data&&i.shapes&&i.shapes.length>0){const e=i;e.shapes=e.shapes.map((e=>({id:e.id,shape:{hash:e.shape.hash,type:"occ-shape"}}))),e.compound={hash:e.compound.hash,type:"occ-shape"},r=e}else r=i}if("saveShapeSTEP"===e.action.functionName&&(e.action.inputs.shape=q.checkCache(e.action.inputs.shape.hash),r=Y.io.saveShapeSTEP(e.action.inputs)),"addOc"===e.action.functionName&&(Y&&Y.plugins?Object.keys(e.action.inputs).forEach((t=>{Y.plugins.dependencies[t]=e.action.inputs[t]})):X=e.action.inputs),"shapeToMesh"===e.action.functionName&&(e.action.inputs.shape=q.checkCache(e.action.inputs.shape.hash),r=Y.shapeToMesh(e.action.inputs)),"shapesToMeshes"===e.action.functionName){if(!(e.action.inputs.shapes&&e.action.inputs.shapes.length>0))throw new Error("No shapes detected");e.action.inputs.shapes=e.action.inputs.shapes.map((e=>q.checkCache(e.hash))),r=Y.shapesToMeshes(e.action.inputs)}"deleteShape"===e.action.functionName&&(q.cleanCacheForHash(e.action.inputs.shape.hash),r={}),"deleteShapes"===e.action.functionName&&(e.action.inputs.shapes.forEach((e=>q.cleanCacheForHash(e.hash))),r={}),"startedTheRun"===e.action.functionName&&(q&&Object.keys(q.usedHashes).length>1e4&&q.cleanAllCache(),r={}),"cleanAllCache"===e.action.functionName&&(q.cleanAllCache(),r={}),t({uid:e.uid,result:r})}catch(r){let i,s;e&&e.action&&e.action.inputs&&(i=`Input values were: {${Object.keys(e.action.inputs).map((t=>`${t}: ${JSON.stringify(e.action.inputs[t])}`)).join(",")}}. `),e&&e.action&&e.action.functionName&&(s=`- ${e.action.functionName}`),t({uid:e.uid,result:void 0,error:`OCCT computation failed. ${r} While executing function ${s}. ${i}`})}})(e.data,postMessage)}))})()})();